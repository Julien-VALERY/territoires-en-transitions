(()=>{"use strict";const e=e=>null!=e.id&&null!=e.pathname;class t{constructor({epci_id:e,indicateur_id:t,year:n,value:i}){this.epci_id=e,this.indicateur_id=t,this.year=n,this.value=i}get pathname(){return t.pathname}}t.pathname="indicateur_value";class n extends t{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return n.buildId(this.epci_id,this.indicateur_id,this.year)}}class i{constructor({host:e,endpoint:t,serializer:n,deserializer:i}){this.host=e,this.pathname=t,this.serializer=n,this.deserializer=i}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await fetch(`${this.host}/${this.pathname}/`,{method:"POST",mode:"cors",body:JSON.stringify(this.serializer(t))});return this.deserializer(await n.json())}async retrieveAll(){return this.retrieveAtPath("all")}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"});return 404==t.status?null:this.deserializer(await t.json())}async retrieveAtPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"}),n=await t.json(),i=[];for(let e=0;e<n.length;e++)i.push(this.deserializer(n[e]));return i}async deleteById(e){return 200==(await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"DELETE"})).status}}const r=()=>{const e=new URLSearchParams(window.location.search).get("epci_id");if(!e)throw new Error("Parameter epci_id is empty.");return e};class s{constructor({action_id:e,epci_id:t,avancement:n}){this.action_id=e,this.epci_id=t,this.avancement=n}get pathname(){return s.pathname}}s.pathname="action_status";class a extends s{static buildId(e,t){return`${e}/${t}`}get id(){return a.buildId(this.epci_id,this.action_id)}}class o{constructor({uid:e,epci_id:t,mesure_id:n,name:i,description:r}){this.uid=e,this.epci_id=t,this.mesure_id=n,this.name=i,this.description=r}get pathname(){return o.pathname}}o.pathname="action_custom";class c extends o{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return c.buildId(this.epci_id,this.mesure_id,this.uid)}}const l=()=>{const e=window.location.hostname;if("localhost"===e.substring(0,10))return"http://localhost:8000";if("sandbox.territoiresentransitions.fr"===e)return"https://sandboxterritoires.osc-fr1.scalingo.io";if("staging.territoiresentransitions.fr"===e)return"https://territoiresentransitions.osc-fr1.scalingo.io";throw`no API host for ${e}`};class u{constructor({uid:e,epci_id:t,climat_pratic_thematic_id:n,name:i}){this.uid=e,this.epci_id=t,this.climat_pratic_thematic_id=n,this.name=i}get pathname(){return u.pathname}}u.pathname="mesure_custom";class d extends u{static buildId(e,t){return`${e}/${t}`}get id(){return d.buildId(this.epci_id,this.uid)}}class h{constructor({host:e,endpoint:t,serializer:n,deserializer:r}){this.cache=null,this.retrieving=null,this.host=e,this.pathname=t,this.serializer=n,this.deserializer=r,this.api=new i({host:this.host,endpoint:this.pathname,serializer:this.serializer,deserializer:this.deserializer})}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await this.api.store(t);return this.writeInCache(n)}retrieveAll(){return this.getCache()}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await this.getCache();for(let n of t)if(n.id.startsWith(e))return n;return null}async retrieveAtPath(e){const t=await this.getCache(),n=[];for(let i of t)i.id.startsWith(e)&&n.push(i);return n}async deleteById(e){const t=await this.api.deleteById(this.stripId(e)),n=await this.getCache();return this.cache=n.filter((t=>t.id!==e)),t}stripId(e){const t=this.pathname.split("/");let n=e.split("/"),i=!1;for(let e=0;e<t.length;e++)if(t[e]==n[0])i=!0,n=n.slice(1);else if(i)break;return n.join("/")}async writeInCache(e){await this.removeFromCache(e.id);const t=await this.getCache();return t.push(e),this.cache=t,e}async removeFromCache(e){const t=await this.getCache(),n=t.filter((t=>t.id!==e)),i=n.length!=t.length;return this.cache=n,i}async getCache(){return null!==this.cache?this.cache:(null===this.retrieving&&(this.retrieving=this.api.retrieveAll(),this.retrieving.then((e=>{this.cache=e}))),this.retrieving)}}const m=new h({host:l(),endpoint:`v1/${t.pathname}/${r()}`,serializer:e=>e,deserializer:e=>new n(e)}),f=new h({host:l(),endpoint:`v1/${s.pathname}/${r()}`,serializer:e=>e,deserializer:e=>new a(e)}),p=(new h({host:l(),endpoint:`v1/${o.pathname}/${r()}`,serializer:e=>e,deserializer:e=>new c(e)}),new h({host:l(),endpoint:`v1/${u.pathname}/${r()}`,serializer:e=>e,deserializer:e=>new d(e)})),$=r();document.querySelectorAll(".status").forEach((e=>(e=>{let t=e.dataset.actionId||"",n=e.querySelectorAll('input[type="radio"]');((e,t)=>{let n=t=>{const n=t.target.value,i=new a({epci_id:$,action_id:e,avancement:n});f.store(i)};t.forEach((e=>{e.addEventListener("change",n)}))})(t,n),(async(e,t)=>{let n="pas_faite";try{const i=await f.retrieveById(`${$}/${e}`);i&&(n=i.avancement)}catch(e){}finally{const i=`action-${e}_${n}`;t.forEach((e=>{e.id===i&&(e.checked=!0)}))}})(t,n)})(e)));const g=e=>{e.preventDefault()},_=e=>{const t=e.target,{id:i,year:s}=w(t),a=r(),o=new n({epci_id:a,indicateur_id:i,year:s,value:t.value});m.store(o)},b=e=>{"Enter"===e.key&&e.target.blur()},y=async e=>{e.value="",e.addEventListener("blur",_),e.addEventListener("keypress",b)},w=e=>({id:e.dataset.indicatorId,year:+e.dataset.indicatorYear});function v(){}function E(e){return e()}function x(){return Object.create(null)}function z(e){e.forEach(E)}function k(e){return"function"==typeof e}function I(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function C(e){return 0===Object.keys(e).length}function A(e,t){e.appendChild(t)}function q(e,t,n){e.insertBefore(t,n||null)}function P(e){e.parentNode.removeChild(e)}function S(e){return document.createElement(e)}function L(e){return document.createTextNode(e)}function B(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function N(e,t,n){e.classList[n?"add":"remove"](t)}let j;function O(e){j=e}document.querySelectorAll('[data-component="indicatorForm"]').forEach((e=>{(async e=>{e.addEventListener("submit",g);const t=e.querySelectorAll("input");for(let e of t)y(e);const{id:n,year:i}=w(t[0]),s=r(),a=await m.retrieveAtPath(`${s}/${n}`);for(let e of t){const{id:t,year:n}=w(e);let i="";for(let e of a)e.year==n&&e.indicateur_id==t&&(i=e.value);e.value=i}})(e)})),new Set,new Set;const F=[],V=[],D=[],M=[],G=Promise.resolve();let H=!1;function U(e){D.push(e)}let W=!1;const J=new Set;function R(){if(!W){W=!0;do{for(let e=0;e<F.length;e+=1){const t=F[e];O(t),Y(t.$$)}for(O(null),F.length=0;V.length;)V.pop()();for(let e=0;e<D.length;e+=1){const t=D[e];J.has(t)||(J.add(t),t())}D.length=0}while(F.length);for(;M.length;)M.pop()();H=!1,W=!1,J.clear()}}function Y(e){if(null!==e.fragment){e.update(),z(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(U)}}const K=new Set;let Q,X;function Z(e,t){e&&e.i&&(K.delete(e),e.i(t))}function ee(e,t,n,i){if(e&&e.o){if(K.has(e))return;K.add(e),Q.c.push((()=>{K.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}}function te(e){e&&e.c()}function ne(e,t,n){const{fragment:i,on_mount:r,on_destroy:s,after_update:a}=e.$$;i&&i.m(t,n),U((()=>{const t=r.map(E).filter(k);s?s.push(...t):z(t),e.$$.on_mount=[]})),a.forEach(U)}function ie(e,t){const n=e.$$;null!==n.fragment&&(z(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function re(e,t,n,i,r,s,a=[-1]){const o=j;O(e);const c=e.$$={fragment:null,ctx:null,props:s,update:v,not_equal:r,bound:x(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(o?o.$$.context:[]),callbacks:x(),dirty:a,skip_bound:!1};let l=!1;if(c.ctx=n?n(e,t.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return c.ctx&&r(c.ctx[t],c.ctx[t]=s)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](s),l&&function(e,t){-1===e.$$.dirty[0]&&(F.push(e),H||(H=!0,G.then(R)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],c.update(),l=!0,z(c.before_update),c.fragment=!!i&&i(c.ctx),t.target){if(t.hydrate){const e=(u=t.target,Array.from(u.childNodes));c.fragment&&c.fragment.l(e),e.forEach(P)}else c.fragment&&c.fragment.c();t.intro&&Z(e.$$.fragment),ne(e,t.target,t.anchor),R()}var u;O(o)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(X=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){ie(this,1),this.$destroy=v}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!C(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class se{$destroy(){ie(this,1),this.$destroy=v}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!C(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ae(e){let t,n,i,r,s;return{c(){t=S("button"),n=L(e[0]),B(t,"class",i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),N(t,"w-full",e[1])},m(i,a){var o,c,l,u;q(i,t,a),A(t,n),r||(o=t,c="click",l=e[8],o.addEventListener(c,l,u),s=()=>o.removeEventListener(c,l,u),r=!0)},p(e,r){1&r&&T(n,e[0]),36&r&&i!==(i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&B(t,"class",i),38&r&&N(t,"w-full",e[1])},d(e){e&&P(t),r=!1,s()}}}function oe(e){let t,n,i;return{c(){t=S("a"),n=L(e[0]),B(t,"href",e[4]),B(t,"class",i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),N(t,"w-full",e[1])},m(e,i){q(e,t,i),A(t,n)},p(e,r){1&r&&T(n,e[0]),16&r&&B(t,"href",e[4]),36&r&&i!==(i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&B(t,"class",i),38&r&&N(t,"w-full",e[1])},d(e){e&&P(t)}}}function ce(e){let t;function n(e,t){return e[3]?oe:ae}let i=n(e),r=i(e);return{c(){r.c(),t=L("")},m(e,n){r.m(e,n),q(e,t,n)},p(e,[s]){i===(i=n(e))&&r?r.p(e,s):(r.d(1),r=i(e),r&&(r.c(),r.m(t.parentNode,t)))},i:v,o:v,d(e){r.d(e),e&&P(t)}}}function le(e,t,n){var i,r;!function(e){e[e.nettle=0]="nettle",e[e.bramble=1]="bramble"}(i||(i={})),function(e){e[e.normal=0]="normal",e[e.small=1]="small"}(r||(r={}));let{label:s=""}=t,{full:a=!1}=t,{classNames:o=""}=t,{colorVariant:c="nettle"}=t,{size:l="normal"}=t,{asLink:u=!1}=t,{href:d=""}=t,h="";return"nettle"==c&&(h+=" border-green-700 border-2 hover:bg-green-100 active:bg-green-600"),"bramble"==c&&(h+=" border-gray-800 border hover:bg-green-100 active:bg-green-600"),"normal"==l&&(h+=" px-6 py-3"),"small"==l&&(h+=" text-base px-3 py-3"),e.$$set=e=>{"label"in e&&n(0,s=e.label),"full"in e&&n(1,a=e.full),"classNames"in e&&n(2,o=e.classNames),"colorVariant"in e&&n(6,c=e.colorVariant),"size"in e&&n(7,l=e.size),"asLink"in e&&n(3,u=e.asLink),"href"in e&&n(4,d=e.href)},[s,a,o,u,d,h,c,l,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}const ue=class extends se{constructor(e){super(),re(this,e,le,ce,I,{label:0,full:1,classNames:2,colorVariant:6,size:7,asLink:3,href:4})}};function de(e){let t,n,i,r,s,a,o,c,l=e[0].name+"";return a=new ue({props:{label:"Supprimer",colorVariant:"bramble",size:"small",classNames:"ml-6"}}),a.$on("click",e[1]),{c(){t=S("main"),n=S("a"),i=S("h3"),r=L(l),s=L(" "),te(a.$$.fragment),B(i,"class","lg:col-span-8 text-xl font-semibold mb-6 pr-28"),B(n,"class","bg-white p-4 rounded my-4 grid grid-cols-1 lg:grid-cols-12 lg:gap-1"),B(n,"href",o="mesure_personnalisee.html?epci_id="+e[0].epci_id+"&mesure_uid="+e[0].uid)},m(e,o){q(e,t,o),A(t,n),A(n,i),A(i,r),A(i,s),ne(a,i,null),c=!0},p(e,[t]){(!c||1&t)&&l!==(l=e[0].name+"")&&T(r,l),(!c||1&t&&o!==(o="mesure_personnalisee.html?epci_id="+e[0].epci_id+"&mesure_uid="+e[0].uid))&&B(n,"href",o)},i(e){c||(Z(a.$$.fragment,e),c=!0)},o(e){ee(a.$$.fragment,e),c=!1},d(e){e&&P(t),ie(a)}}}function he(e,t,n){let{mesure:i}=t;const r=function(){const e=function(){if(!j)throw new Error("Function called outside component initialization");return j}();return(t,n)=>{const i=e.$$.callbacks[t];if(i){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);i.slice().forEach((t=>{t.call(e,r)}))}}}();return e.$$set=e=>{"mesure"in e&&n(0,i=e.mesure)},[i,e=>{e.preventDefault(),confirm("Êtes-vous sûr•e de vouloir supprimer une de vos mesures personnalisées ?")&&(p.deleteById(i.id),r("delete",i.id))}]}const me=class extends se{constructor(e){super(),re(this,e,he,de,I,{mesure:0})}};function fe(e,t,n){const i=e.slice();return i[4]=t[n],i}function pe(e){let t,n;return t=new me({props:{mesure:e[4]}}),t.$on("delete",e[1]),{c(){te(t.$$.fragment)},m(e,i){ne(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.mesure=e[4]),t.$set(i)},i(e){n||(Z(t.$$.fragment,e),n=!0)},o(e){ee(t.$$.fragment,e),n=!1},d(e){ie(t,e)}}}function $e(e){let t,n,i=e[0],r=[];for(let t=0;t<i.length;t+=1)r[t]=pe(fe(e,i,t));const s=e=>ee(r[e],1,1,(()=>{r[e]=null}));return{c(){t=S("ul");for(let e=0;e<r.length;e+=1)r[e].c()},m(e,i){q(e,t,i);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,[n]){if(3&n){let a;for(i=e[0],a=0;a<i.length;a+=1){const s=fe(e,i,a);r[a]?(r[a].p(s,n),Z(r[a],1)):(r[a]=pe(s),r[a].c(),Z(r[a],1),r[a].m(t,null))}for(Q={r:0,c:[],p:Q},a=i.length;a<r.length;a+=1)s(a);Q.r||z(Q.c),Q=Q.p}},i(e){if(!n){for(let e=0;e<i.length;e+=1)Z(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)ee(r[e]);n=!1},d(e){e&&P(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(r,e)}}}function ge(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};let{climat_pratic_thematique_id:r}=t,s=[];const a=()=>i(void 0,void 0,void 0,(function*(){const e=yield p.retrieveAll();n(0,s=e.filter((e=>e.climat_pratic_thematic_id==r)))}));return a(),e.$$set=e=>{"climat_pratic_thematique_id"in e&&n(2,r=e.climat_pratic_thematique_id)},[s,a,r]}const _e=class extends se{constructor(e){super(),re(this,e,ge,$e,I,{climat_pratic_thematique_id:2})}};class be{constructor(e,t){this.id=e,this.name=t}}const ye={strategie:new be("strategie","Stratégie"),urbanisme:new be("urbanisme","Urbanisme et aménagement"),batiments:new be("batiments","Bâtiments et patrimoine"),energie:new be("energie","Gestion, production et distribution de l'énergie"),mobilites:new be("mobilites","Mobilités"),agri_alim:new be("agri_alim","Agriculture et alimentation"),foret_biodiv:new be("foret_biodiv","Forêts, espaces verts et biodiversité"),conso_resp:new be("conso_resp","Consommation écoresponsable"),dechets:new be("dechets","Déchets"),eau:new be("eau","Eau et assainissement"),preca_energie:new be("preca_energie","Précarité énergétique"),dev_eco:new be("dev_eco","Activités économiques"),tourisme:new be("tourisme","Tourisme"),orga_interne:new be("orga_interne","Organisation interne"),forma_sensib:new be("forma_sensib","Formation, sensibilisation, communication"),parten_coop:new be("parten_coop","Partenariat et coopération"),eci:new be("eci","Économie circulaire")};Object.values(ye).forEach((e=>{new _e({target:document.body.querySelector(`[data-custom-mesure-thematique="${e.id}"]`),props:{climat_pratic_thematique_id:e.id}})}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL3N0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3ZlbmRvcnMvaW5kaWNhdGV1cl92YWx1ZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvc3RvcmFibGVzL0luZGljYXRldXJWYWx1ZVN0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9hcGkvYXBpU3RvcmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9jdXJyZW50RXBjaS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXMudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9jdXN0b20udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25DdXN0b21TdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL2N1cnJlbnRBUEkudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9oeWJyaWRTdG9yZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvY29tcG9uZW50cy9sZWdhY3kvc3RhdHVzUGlja2VyLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL2xlZ2FjeS9tZXN1cmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvckZvcm0udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvcnNMaXN0LnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL3NoYXJlZC9CdXR0b24uc3ZlbHRlIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL21lc3VyZXMvTWVzdXJlTGluay5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbWVzdXJlcy9NZXN1cmVMaW5rcy5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vdmVuZG9ycy90aGVtYXRpcXVlcy50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvbWVzdXJlcy50cyJdLCJuYW1lcyI6WyJpc1N0b3JhYmxlIiwic3RvcmFibGUiLCJ1bmRlZmluZWQiLCJpZCIsInBhdGhuYW1lIiwiSW5kaWNhdGV1clZhbHVlIiwiZXBjaV9pZCIsImluZGljYXRldXJfaWQiLCJ5ZWFyIiwidmFsdWUiLCJ0aGlzIiwiSW5kaWNhdGV1clZhbHVlU3RvcmFibGUiLCJidWlsZElkIiwiQVBJU3RvcmUiLCJob3N0IiwiZW5kcG9pbnQiLCJzZXJpYWxpemVyIiwiZGVzZXJpYWxpemVyIiwiRXJyb3IiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwibW9kZSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwianNvbiIsInJldHJpZXZlQXRQYXRoIiwicmV0cmlldmVCeVBhdGgiLCJwYXRoIiwic3RhdHVzIiwiZGF0YSIsInJlc3VsdHMiLCJpIiwibGVuZ3RoIiwicHVzaCIsImdldEN1cnJlbnRFcGNpSWQiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImdldCIsIkFjdGlvblN0YXR1cyIsImFjdGlvbl9pZCIsImF2YW5jZW1lbnQiLCJBY3Rpb25TdGF0dXNTdG9yYWJsZSIsIkFjdGlvbkN1c3RvbSIsInVpZCIsIm1lc3VyZV9pZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsIkFjdGlvbkN1c3RvbVN0b3JhYmxlIiwiZ2V0Q3VycmVudEFQSSIsImhvc3RuYW1lIiwic3Vic3RyaW5nIiwiTWVzdXJlQ3VzdG9tIiwiY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZCIsIk1lc3VyZUN1c3RvbVN0b3JhYmxlIiwiSHlicmlkU3RvcmUiLCJjYWNoZSIsInJldHJpZXZpbmciLCJhcGkiLCJzdG9yZWQiLCJzdG9yZSIsIndyaXRlSW5DYWNoZSIsImdldENhY2hlIiwic3RhcnRzV2l0aCIsImRlbGV0ZWQiLCJkZWxldGVCeUlkIiwic3RyaXBJZCIsImZpbHRlciIsImNhY2hlZCIsInNwbGl0IiwibWF0Y2giLCJzbGljZSIsImpvaW4iLCJyZW1vdmVGcm9tQ2FjaGUiLCJmaWx0ZXJlZCIsInJldHJpZXZlQWxsIiwidGhlbiIsInJldHJpZXZlZCIsImluZGljYXRldXJWYWx1ZVN0b3JlIiwic2VyaWFsaXplZCIsImFjdGlvblN0YXR1c1N0b3JlIiwibWVzdXJlQ3VzdG9tU3RvcmUiLCJlY3BpSWQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWxlbWVudCIsImFjdGlvbklkIiwiZGF0YXNldCIsImlucHV0cyIsIm9uQ2hhbmdlIiwiZXZlbnQiLCJhY3Rpb25BdmFuY2VtZW50S2V5IiwidGFyZ2V0IiwiaW5wdXQiLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkTGlzdGVuZXJzIiwiYXN5bmMiLCJyZXRyaWV2ZUJ5SWQiLCJlIiwic2VsZWN0ZWRJbnB1dElkIiwiY2hlY2tlZCIsImNoZWNrSW5wdXQiLCJpbml0IiwicHJldmVudERlZmF1bHQiLCJvbkJsdXIiLCJpbnB1dFByb3BlcnRpZXMiLCJjdXJyZW50RXBjaUlkIiwib25LZXlQcmVzcyIsImtleSIsImJsdXIiLCJpbml0WWVhcmx5SW5wdXQiLCJpbmRpY2F0b3JJZCIsImluZGljYXRvclllYXIiLCJub29wIiwicnVuIiwiZm4iLCJibGFua19vYmplY3QiLCJPYmplY3QiLCJjcmVhdGUiLCJydW5fYWxsIiwiZm5zIiwiaXNfZnVuY3Rpb24iLCJ0aGluZyIsInNhZmVfbm90X2VxdWFsIiwiYSIsImIiLCJpc19lbXB0eSIsIm9iaiIsImtleXMiLCJhcHBlbmQiLCJub2RlIiwiYXBwZW5kQ2hpbGQiLCJpbnNlcnQiLCJhbmNob3IiLCJpbnNlcnRCZWZvcmUiLCJkZXRhY2giLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJjcmVhdGVFbGVtZW50IiwiY3JlYXRlVGV4dE5vZGUiLCJhdHRyIiwiYXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwic2V0X2RhdGEiLCJ0ZXh0Iiwid2hvbGVUZXh0IiwidG9nZ2xlX2NsYXNzIiwidG9nZ2xlIiwiY2xhc3NMaXN0IiwiY3VycmVudF9jb21wb25lbnQiLCJzZXRfY3VycmVudF9jb21wb25lbnQiLCJjb21wb25lbnQiLCJmb3JtIiwiZXBjaUlkIiwiaW5kaWNhdGV1clZhbHVlcyIsImluZGljYXRldXJWYWx1ZSIsIlNldCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ1cGRhdGVfc2NoZWR1bGVkIiwiYWRkX3JlbmRlcl9jYWxsYmFjayIsImZsdXNoaW5nIiwic2Vlbl9jYWxsYmFja3MiLCJmbHVzaCIsInVwZGF0ZSIsIiQkIiwicG9wIiwiY2FsbGJhY2siLCJoYXMiLCJhZGQiLCJjbGVhciIsImZyYWdtZW50IiwiYmVmb3JlX3VwZGF0ZSIsImRpcnR5IiwicCIsImN0eCIsImFmdGVyX3VwZGF0ZSIsIm91dHJvaW5nIiwib3V0cm9zIiwiU3ZlbHRlRWxlbWVudCIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwiZGVsZXRlIiwidHJhbnNpdGlvbl9vdXQiLCJvIiwiYyIsImQiLCJjcmVhdGVfY29tcG9uZW50IiwibW91bnRfY29tcG9uZW50Iiwib25fbW91bnQiLCJvbl9kZXN0cm95IiwibSIsIm5ld19vbl9kZXN0cm95IiwibWFwIiwiZGVzdHJveV9jb21wb25lbnQiLCJkZXRhY2hpbmciLCJvcHRpb25zIiwiaW5zdGFuY2UiLCJjcmVhdGVfZnJhZ21lbnQiLCJub3RfZXF1YWwiLCJwcm9wcyIsInBhcmVudF9jb21wb25lbnQiLCJib3VuZCIsImNvbnRleHQiLCJNYXAiLCJjYWxsYmFja3MiLCJza2lwX2JvdW5kIiwicmVhZHkiLCJyZXQiLCJyZXN0IiwiZmlsbCIsIm1ha2VfZGlydHkiLCJoeWRyYXRlIiwibm9kZXMiLCJBcnJheSIsImZyb20iLCJjaGlsZE5vZGVzIiwibCIsImludHJvIiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJhdHRhY2hTaGFkb3ciLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkJHByb3BzIiwiJCRzZXQiLCJTdmVsdGVDb21wb25lbnQiLCJoYW5kbGVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbG9yVmFyaWFudHMiLCJzaXplcyIsImxhYmVsIiwiZnVsbCIsImNsYXNzTmFtZXMiLCJjb2xvclZhcmlhbnQiLCJzaXplIiwiYXNMaW5rIiwiaHJlZiIsImJ1dHRvbkNsYXNzTmFtZXMiLCJtZXN1cmUiLCJkaXNwYXRjaCIsImdldF9jdXJyZW50X2NvbXBvbmVudCIsImRldGFpbCIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiY3VzdG9tX2V2ZW50IiwiY2FsbCIsImNyZWF0ZUV2ZW50RGlzcGF0Y2hlciIsImNvbmZpcm0iLCJyIiwiaXRlcmF0aW9ucyIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwiYXBwbHkiLCJjbGltYXRfcHJhdGljX3RoZW1hdGlxdWVfaWQiLCJjdXN0b21NZXN1cmVzIiwidXBkYXRlTWVzdXJlcyIsImFsbCIsIlRoZW1hdGlxdWUiLCJ0aGVtYXRpcXVlcyIsInZhbHVlcyIsInRoZW1hdGlxdWUiLCJxdWVyeVNlbGVjdG9yIl0sIm1hcHBpbmdzIjoibUJBV08sTUFBTUEsRUFBY0MsR0FDYUMsTUFBNUJELEVBQXNCRSxJQUFzREQsTUFBbENELEVBQXNCRyxTQ0xyRSxNQUFNQyxFQWFULGFBQVksUUFDUkMsRUFBTyxjQUNQQyxFQUFhLEtBQ2JDLEVBQUksTUFDSkMsSUFPQUMsS0FBS0osUUFBVUEsRUFDZkksS0FBS0gsY0FBZ0JBLEVBQ3JCRyxLQUFLRixLQUFPQSxFQUNaRSxLQUFLRCxNQUFRQSxFQXpCakIsZUFDSSxPQUFPSixFQUFnQkQsVUFGYixFQUFBQSxTQUFtQixtQkNOOUIsTUFBTU8sVUFBZ0NOLEVBQ3pDLGVBQWVDLEVBQWlCQyxFQUF1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TUFBTUUsR0FHVCxZQUFZN1IsRUFBWThDLEdBQ3BCdkMsS0FBS1AsR0FBS0EsRUFDVk8sS0FBS3VDLEtBQU9BLEdBSWIsTUFBTWdQLEdBQWMsQ0FFdkIsVUFBYSxJQUFJRCxHQUFXLFlBQWEsYUFFekMsVUFBYSxJQUFJQSxHQUFXLFlBQWEsNEJBRXpDLFVBQWEsSUFBSUEsR0FBVyxZQUFhLDJCQUV6QyxRQUFXLElBQUlBLEdBQVcsVUFBVyxvREFFckMsVUFBYSxJQUFJQSxHQUFXLFlBQWEsYUFFekMsVUFBYSxJQUFJQSxHQUFXLFlBQWEsK0JBRXpDLGFBQWdCLElBQUlBLEdBQVcsZUFBZ0IseUNBRS9DLFdBQWMsSUFBSUEsR0FBVyxhQUFjLCtCQUUzQyxRQUFXLElBQUlBLEdBQVcsVUFBVyxXQUVyQyxJQUFPLElBQUlBLEdBQVcsTUFBTyx5QkFFN0IsY0FBaUIsSUFBSUEsR0FBVyxnQkFBaUIseUJBRWpELFFBQVcsSUFBSUEsR0FBVyxVQUFXLHlCQUVyQyxTQUFZLElBQUlBLEdBQVcsV0FBWSxZQUV2QyxhQUFnQixJQUFJQSxHQUFXLGVBQWdCLHdCQUUvQyxhQUFnQixJQUFJQSxHQUFXLGVBQWdCLDZDQUUvQyxZQUFlLElBQUlBLEdBQVcsY0FBZSw4QkFFN0MsSUFBTyxJQUFJQSxHQUFXLE1BQU8sd0JDM0JqQ3ZLLE9BQU95SyxPQUFPRCxJQUFhek0sU0FWYzJNLElBQ3ZDLElBQUksR0FBWSxDQUVkbk0sT0FBUVYsU0FBUy9ELEtBQUs2USxjQUFjLG1DQUFtQ0QsRUFBV2hTLFFBQ2xGaU4sTUFBTyxDQUNMd0UsNEJBQTZCTyxFQUFXaFMsVSIsImZpbGUiOiJtZXN1cmVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIERhdGEgdGhhdCBjYW4gYmUgc3RvcmVkIGF0IHBhdGgvaWQuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFN0b3JhYmxlIHtcclxuICAgIGlkOiBzdHJpbmcsXHJcbiAgICBwYXRobmFtZTogc3RyaW5nLFxyXG59XHJcblxyXG4vKipcclxuICogU3RvcmFibGUgdHlwZSBndWFyZC5cclxuICovXHJcbmV4cG9ydCBjb25zdCBpc1N0b3JhYmxlID0gKHN0b3JhYmxlOiBhbnkpOiBzdG9yYWJsZSBpcyBTdG9yYWJsZSA9PiB7XHJcbiAgICByZXR1cm4gKHN0b3JhYmxlIGFzIFN0b3JhYmxlKS5pZCAhPSB1bmRlZmluZWQgJiYgKHN0b3JhYmxlIGFzIFN0b3JhYmxlKS5wYXRobmFtZSAhPSB1bmRlZmluZWRcclxufVxyXG4iLCJleHBvcnQgaW50ZXJmYWNlIEluZGljYXRldXJWYWx1ZUludGVyZmFjZSB7XHJcbiAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZDogc3RyaW5nLFxyXG4gICAgICAgIHllYXI6IG51bWJlcixcclxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSW5kaWNhdGV1clZhbHVlIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcGF0aG5hbWU6IHN0cmluZyA9ICdpbmRpY2F0ZXVyX3ZhbHVlJztcclxuICAgIGdldCBwYXRobmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBJbmRpY2F0ZXVyVmFsdWUucGF0aG5hbWU7XHJcbiAgICB9XHJcbiAgICBlcGNpX2lkOiBzdHJpbmc7XHJcbiAgICBpbmRpY2F0ZXVyX2lkOiBzdHJpbmc7XHJcbiAgICB5ZWFyOiBudW1iZXI7XHJcbiAgICB2YWx1ZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIEluZGljYXRldXJWYWx1ZSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioe1xyXG4gICAgICAgIGVwY2lfaWQsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZCxcclxuICAgICAgICB5ZWFyLFxyXG4gICAgICAgIHZhbHVlLFxyXG4gICAgfToge1xyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBpbmRpY2F0ZXVyX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgeWVhcjogbnVtYmVyLFxyXG4gICAgICAgIHZhbHVlOiBzdHJpbmcsXHJcbiAgICB9KSB7XHJcbiAgICAgICAgdGhpcy5lcGNpX2lkID0gZXBjaV9pZDtcclxuICAgICAgICB0aGlzLmluZGljYXRldXJfaWQgPSBpbmRpY2F0ZXVyX2lkO1xyXG4gICAgICAgIHRoaXMueWVhciA9IHllYXI7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWV9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2luZGljYXRldXJfdmFsdWVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZSBleHRlbmRzIEluZGljYXRldXJWYWx1ZSB7XHJcbiAgICBzdGF0aWMgYnVpbGRJZChlcGNpX2lkOiBzdHJpbmcsIGluZGljYXRldXJfaWQ6IHN0cmluZywgeWVhcjogbnVtYmVyKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7aW5kaWNhdGV1cl9pZH0vJHt5ZWFyfWBcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gSW5kaWNhdGV1clZhbHVlU3RvcmFibGUuYnVpbGRJZCh0aGlzLmVwY2lfaWQsIHRoaXMuaW5kaWNhdGV1cl9pZCwgdGhpcy55ZWFyKVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtpc1N0b3JhYmxlfSBmcm9tIFwiLi9zdG9yYWJsZVwiO1xyXG5cclxuLyoqXHJcbiAqIEEgU3RvcmUgZm9yIFN0b3JhYmxlIG9iamVjdCB1c2luZyBhIHJlbW90ZSBhcGlcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBUElTdG9yZTxUPiB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhvc3QsXHJcbiAgICAgICAgICAgIGVuZHBvaW50LFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXIsXHJcbiAgICAgICAgfToge1xyXG4gICAgICAgICAgICBob3N0OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIGVuZHBvaW50OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZTogVCkgPT4gb2JqZWN0LFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkOiBvYmplY3QpID0+IFQsXHJcbiAgICAgICAgfSkge1xyXG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XHJcbiAgICAgICAgdGhpcy5wYXRobmFtZSA9IGVuZHBvaW50O1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5kZXNlcmlhbGl6ZXIgPSBkZXNlcmlhbGl6ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgaG9zdDogc3RyaW5nO1xyXG4gICAgcGF0aG5hbWU6IHN0cmluZztcclxuICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZTogVCkgPT4gb2JqZWN0O1xyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZDogb2JqZWN0KSA9PiBUO1xyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFN0b3JlIGEgU3RvcmFibGUgYXQgcGF0aG5hbWUvaWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHN0b3JhYmxlIHRoZSBvYmplY3QgdG8gc2F2ZVxyXG4gICAgICovXHJcbiAgICBhc3luYyBzdG9yZShzdG9yYWJsZTogVCk6IFByb21pc2U8VD4ge1xyXG4gICAgICAgIGlmICghaXNTdG9yYWJsZShzdG9yYWJsZSkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke3R5cGVvZiBzdG9yYWJsZX0gaXMgbm90IHN0b3JhYmxlLmApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuaG9zdH0vJHt0aGlzLnBhdGhuYW1lfS9gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRoaXMuc2VyaWFsaXplcihzdG9yYWJsZSkpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmRlc2VyaWFsaXplcihhd2FpdCByZXNwb25zZS5qc29uKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGFsbCBzdG9yYWJsZSBvZiB0eXBlIFQgZXhpc3RpbmcgYXQgcGF0aG5hbWUuXHJcbiAgICAgKiBJZiBub3RoaW5nIGlzIGZvdW5kIHJldHVybnMgYW4gZW1wdHkgcmVjb3JkLlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUFsbCgpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVBdFBhdGgoJ2FsbCcpXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYSBzdG9yYWJsZSB3aXRoIG1hdGNoaW5nIHBhdGggYW5kIHBhdGguXHJcbiAgICAgKiBUaHJvdyBpZiBubyBzdG9yYWJsZSBpcyBmb3VuZCBvciBwYXRoIGRvZXMgbm90IGV4aXN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZCBTdG9yYWJsZSBpZFxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZUJ5UGF0aChpZCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcmV0cmlldmVCeVBhdGgocGF0aDogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5ob3N0fS8ke3RoaXMucGF0aG5hbWV9LyR7cGF0aH1gLCB7XHJcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJyxcclxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDQpIHJldHVybiBudWxsO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRlc2VyaWFsaXplcihhd2FpdCByZXNwb25zZS5qc29uKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJldHJpZXZlQXRQYXRoKHBhdGg6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8VD4+IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuaG9zdH0vJHt0aGlzLnBhdGhuYW1lfS8ke3BhdGh9YCwge1xyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHRoaXMuZGVzZXJpYWxpemVyKGRhdGFbaV0pKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVsZXRlIGEgU3RvcmFibGUgc3RvcmVkIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICogUmV0dXJuIHRydWUgaWYgc29tZXRoaW5nIHdhcyBkZWxldGVkLCBmYWxzZSBpZiBub3RoaW5nIGV4aXN0cyBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgU3RvcmFibGUgaWRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgZGVsZXRlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmhvc3R9LyR7dGhpcy5wYXRobmFtZX0vJHtpZH1gLCB7XHJcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJyxcclxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyA9PSAyMDA7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNvbnN0IGdldEN1cnJlbnRFcGNpSWQgPSAoKTogc3RyaW5nID0+IHtcclxuICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaClcclxuICAgIGNvbnN0IGlkID0gdXJsUGFyYW1zLmdldCgnZXBjaV9pZCcpXHJcblxyXG4gICAgaWYgKCFpZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUGFyYW1ldGVyIGVwY2lfaWQgaXMgZW1wdHkuJylcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaWRcclxufSIsImV4cG9ydCBpbnRlcmZhY2UgQWN0aW9uU3RhdHVzSW50ZXJmYWNlIHtcclxuICAgIGFjdGlvbl9pZDogc3RyaW5nLFxyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBhdmFuY2VtZW50OiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25TdGF0dXMge1xyXG4gICAgcHVibGljIHN0YXRpYyBwYXRobmFtZTogc3RyaW5nID0gJ2FjdGlvbl9zdGF0dXMnO1xyXG4gICAgZ2V0IHBhdGhuYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEFjdGlvblN0YXR1cy5wYXRobmFtZTtcclxuICAgIH1cclxuICAgIGFjdGlvbl9pZDogc3RyaW5nO1xyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgYXZhbmNlbWVudDogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIEFjdGlvblN0YXR1cyBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioe1xyXG4gICAgICAgIGFjdGlvbl9pZCxcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIGF2YW5jZW1lbnQsXHJcbiAgICB9OiB7XHJcbiAgICAgICAgYWN0aW9uX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIGF2YW5jZW1lbnQ6IHN0cmluZyxcclxuICAgIH0pIHtcclxuICAgICAgICB0aGlzLmFjdGlvbl9pZCA9IGFjdGlvbl9pZDtcclxuICAgICAgICB0aGlzLmVwY2lfaWQgPSBlcGNpX2lkO1xyXG4gICAgICAgIHRoaXMuYXZhbmNlbWVudCA9IGF2YW5jZW1lbnQ7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge0FjdGlvblN0YXR1c30gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvYWN0aW9uX3N0YXR1c1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEFjdGlvblN0YXR1c1N0b3JhYmxlIGV4dGVuZHMgQWN0aW9uU3RhdHVzIHtcclxuICAgIHN0YXRpYyBidWlsZElkKGVwY2lfaWQ6IHN0cmluZywgYWN0aW9uX2lkOiBzdHJpbmcpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7ZXBjaV9pZH0vJHthY3Rpb25faWR9YDtcclxuICAgIH1cclxuICAgIGdldCBpZCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBBY3Rpb25TdGF0dXNTdG9yYWJsZS5idWlsZElkKHRoaXMuZXBjaV9pZCwgdGhpcy5hY3Rpb25faWQpXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIEFjdGlvbkN1c3RvbUludGVyZmFjZSB7XHJcbiAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbWVzdXJlX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25DdXN0b20ge1xyXG4gICAgcHVibGljIHN0YXRpYyBwYXRobmFtZTogc3RyaW5nID0gJ2FjdGlvbl9jdXN0b20nO1xyXG4gICAgZ2V0IHBhdGhuYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEFjdGlvbkN1c3RvbS5wYXRobmFtZTtcclxuICAgIH1cclxuICAgIHVpZDogc3RyaW5nO1xyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgbWVzdXJlX2lkOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIEFjdGlvbkN1c3RvbSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioe1xyXG4gICAgICAgIHVpZCxcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIG1lc3VyZV9pZCxcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgfToge1xyXG4gICAgICAgIHVpZDogc3RyaW5nLFxyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBtZXN1cmVfaWQ6IHN0cmluZyxcclxuICAgICAgICBuYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICAgIH0pIHtcclxuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcclxuICAgICAgICB0aGlzLmVwY2lfaWQgPSBlcGNpX2lkO1xyXG4gICAgICAgIHRoaXMubWVzdXJlX2lkID0gbWVzdXJlX2lkO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtBY3Rpb25DdXN0b219IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9jdXN0b21cIjtcclxuXHJcbmV4cG9ydCAgY2xhc3MgQWN0aW9uQ3VzdG9tU3RvcmFibGUgZXh0ZW5kcyBBY3Rpb25DdXN0b20ge1xyXG4gICAgc3RhdGljIGJ1aWxkSWQoZXBjaV9pZDogc3RyaW5nLCBtZXN1cmVfaWQ6IHN0cmluZywgdWlkOiBzdHJpbmcpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gYCR7ZXBjaV9pZH0vJHttZXN1cmVfaWR9LyR7dWlkfWBcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQWN0aW9uQ3VzdG9tU3RvcmFibGUuYnVpbGRJZCh0aGlzLmVwY2lfaWQsIHRoaXMubWVzdXJlX2lkLCB0aGlzLnVpZClcclxuICAgIH1cclxufSIsImV4cG9ydCBjb25zdCBnZXRDdXJyZW50QVBJID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCBob3N0bmFtZSA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZTtcclxuICAgIGlmIChob3N0bmFtZS5zdWJzdHJpbmcoMCwgMTApID09PSAnbG9jYWxob3N0JykgcmV0dXJuICdodHRwOi8vbG9jYWxob3N0OjgwMDAnO1xyXG4gICAgaWYgKGhvc3RuYW1lID09PSAnc2FuZGJveC50ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnInKSByZXR1cm4gJ2h0dHBzOi8vc2FuZGJveHRlcnJpdG9pcmVzLm9zYy1mcjEuc2NhbGluZ28uaW8nXHJcbiAgICBpZiAoaG9zdG5hbWUgPT09ICdzdGFnaW5nLnRlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mcicpIHJldHVybiAnaHR0cHM6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMub3NjLWZyMS5zY2FsaW5nby5pbydcclxuICAgIHRocm93IGBubyBBUEkgaG9zdCBmb3IgJHtob3N0bmFtZX1gXHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIE1lc3VyZUN1c3RvbUludGVyZmFjZSB7XHJcbiAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDogc3RyaW5nLFxyXG4gICAgICAgIG5hbWU6IHN0cmluZyxcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1lc3VyZUN1c3RvbSB7XHJcbiAgICBwdWJsaWMgc3RhdGljIHBhdGhuYW1lOiBzdHJpbmcgPSAnbWVzdXJlX2N1c3RvbSc7XHJcbiAgICBnZXQgcGF0aG5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gTWVzdXJlQ3VzdG9tLnBhdGhuYW1lO1xyXG4gICAgfVxyXG4gICAgdWlkOiBzdHJpbmc7XHJcbiAgICBlcGNpX2lkOiBzdHJpbmc7XHJcbiAgICBjbGltYXRfcHJhdGljX3RoZW1hdGljX2lkOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgTWVzdXJlQ3VzdG9tIGluc3RhbmNlLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcih7XHJcbiAgICAgICAgdWlkLFxyXG4gICAgICAgIGVwY2lfaWQsXHJcbiAgICAgICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZCxcclxuICAgICAgICBuYW1lLFxyXG4gICAgfToge1xyXG4gICAgICAgIHVpZDogc3RyaW5nLFxyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBjbGltYXRfcHJhdGljX3RoZW1hdGljX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbmFtZTogc3RyaW5nLFxyXG4gICAgfSkge1xyXG4gICAgICAgIHRoaXMudWlkID0gdWlkO1xyXG4gICAgICAgIHRoaXMuZXBjaV9pZCA9IGVwY2lfaWQ7XHJcbiAgICAgICAgdGhpcy5jbGltYXRfcHJhdGljX3RoZW1hdGljX2lkID0gY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtNZXN1cmVDdXN0b219IGZyb20gXCIuLi8uLi92ZW5kb3JzL21lc3VyZV9jdXN0b21cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNZXN1cmVDdXN0b21TdG9yYWJsZSBleHRlbmRzIE1lc3VyZUN1c3RvbSB7XHJcbiAgICBzdGF0aWMgYnVpbGRJZChlcGNpX2lkOiBzdHJpbmcsIHVpZDogc3RyaW5nKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7dWlkfWA7XHJcbiAgICB9XHJcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gTWVzdXJlQ3VzdG9tU3RvcmFibGUuYnVpbGRJZCh0aGlzLmVwY2lfaWQsIHRoaXMudWlkKVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtpc1N0b3JhYmxlLCBTdG9yYWJsZX0gZnJvbSBcIi4vc3RvcmFibGVcIjtcclxuaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZX0gZnJvbSBcIi4uL3N0b3JhYmxlcy9JbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZVwiO1xyXG5pbXBvcnQge0luZGljYXRldXJWYWx1ZSwgSW5kaWNhdGV1clZhbHVlSW50ZXJmYWNlfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9pbmRpY2F0ZXVyX3ZhbHVlXCI7XHJcbmltcG9ydCB7QVBJU3RvcmV9IGZyb20gXCIuL2FwaVN0b3JlXCI7XHJcbmltcG9ydCB7Z2V0Q3VycmVudEVwY2lJZH0gZnJvbSBcIi4vY3VycmVudEVwY2lcIjtcclxuaW1wb3J0IHtBY3Rpb25TdGF0dXMsIEFjdGlvblN0YXR1c0ludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvYWN0aW9uX3N0YXR1c1wiO1xyXG5pbXBvcnQge0FjdGlvblN0YXR1c1N0b3JhYmxlfSBmcm9tIFwiLi4vc3RvcmFibGVzL0FjdGlvblN0YXR1c1N0b3JhYmxlXCI7XHJcbmltcG9ydCB7QWN0aW9uQ3VzdG9tU3RvcmFibGV9IGZyb20gXCIuLi9zdG9yYWJsZXMvQWN0aW9uQ3VzdG9tU3RvcmFibGVcIjtcclxuaW1wb3J0IHtBY3Rpb25DdXN0b20sIEFjdGlvbkN1c3RvbUludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvYWN0aW9uX2N1c3RvbVwiO1xyXG5pbXBvcnQge2dldEN1cnJlbnRBUEl9IGZyb20gXCIuL2N1cnJlbnRBUElcIjtcclxuaW1wb3J0IHtNZXN1cmVDdXN0b21TdG9yYWJsZX0gZnJvbSBcIi4uL3N0b3JhYmxlcy9NZXN1cmVDdXN0b21TdG9yYWJsZVwiO1xyXG5pbXBvcnQge01lc3VyZUN1c3RvbSwgTWVzdXJlQ3VzdG9tSW50ZXJmYWNlfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tXCI7XHJcblxyXG4vKipcclxuICogQSBTdG9yZSBmb3IgU3RvcmFibGUgb2JqZWN0IHVzaW5nIGEgcmVtb3RlIGFwaSBhbmQgYSBsb2NhbCBjYWNoZS5cclxuICpcclxuICogVGhlIGxvY2FsIGNhY2hlIGlzIGtlcHQgaW4gbWVtb3J5IGZvciBub3cuXHJcbiAqL1xyXG5jbGFzcyBIeWJyaWRTdG9yZTxUIGV4dGVuZHMgU3RvcmFibGU+IHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaG9zdCxcclxuICAgICAgICAgICAgZW5kcG9pbnQsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXIsXHJcbiAgICAgICAgICAgIGRlc2VyaWFsaXplcixcclxuICAgICAgICB9OiB7XHJcbiAgICAgICAgICAgIGhvc3Q6IHN0cmluZyxcclxuICAgICAgICAgICAgZW5kcG9pbnQ6IHN0cmluZyxcclxuICAgICAgICAgICAgc2VyaWFsaXplcjogKHN0b3JhYmxlOiBUKSA9PiBvYmplY3QsXHJcbiAgICAgICAgICAgIGRlc2VyaWFsaXplcjogKHNlcmlhbGl6ZWQ6IG9iamVjdCkgPT4gVCxcclxuICAgICAgICB9KSB7XHJcbiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDtcclxuICAgICAgICB0aGlzLnBhdGhuYW1lID0gZW5kcG9pbnQ7XHJcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gc2VyaWFsaXplcjtcclxuICAgICAgICB0aGlzLmRlc2VyaWFsaXplciA9IGRlc2VyaWFsaXplcjtcclxuXHJcbiAgICAgICAgdGhpcy5hcGkgPSBuZXcgQVBJU3RvcmU8VD4oe1xyXG4gICAgICAgICAgICBob3N0OiB0aGlzLmhvc3QsXHJcbiAgICAgICAgICAgIGVuZHBvaW50OiB0aGlzLnBhdGhuYW1lLFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyOiB0aGlzLnNlcmlhbGl6ZXIsXHJcbiAgICAgICAgICAgIGRlc2VyaWFsaXplcjogdGhpcy5kZXNlcmlhbGl6ZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICB0b2RvIHVzZSBsb2NhbCBzdG9yZSBmb3IgY2FjaGluZ1xyXG4gICAgICAgIHRoaXMubG9jYWwgPSBuZXcgTG9jYWxTdG9yZTxUPih7XHJcbiAgICAgICAgICAgIHBhdGhuYW1lOiB0aGlzLnBhdGhuYW1lLFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyOiB0aGlzLnNlcmlhbGl6ZXIsXHJcbiAgICAgICAgICAgIGRlc2VyaWFsaXplcjogdGhpcy5kZXNlcmlhbGl6ZXJcclxuICAgICAgICB9KTtcclxuICAgICAgICAqL1xyXG4gICAgfVxyXG5cclxuICAgIGhvc3Q6IHN0cmluZztcclxuICAgIHBhdGhuYW1lOiBzdHJpbmc7XHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGU6IFQpID0+IG9iamVjdDtcclxuICAgIGRlc2VyaWFsaXplcjogKHNlcmlhbGl6ZWQ6IG9iamVjdCkgPT4gVDtcclxuICAgIGFwaTogQVBJU3RvcmU8VD47XHJcbiAgICBwcml2YXRlIGNhY2hlOiBUW10gfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICAvLyBsb2NhbDogTG9jYWxTdG9yZTxUPjtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9yZSBhIFN0b3JhYmxlIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdG9yYWJsZSB0aGUgb2JqZWN0IHRvIHNhdmVcclxuICAgICAqL1xyXG4gICAgYXN5bmMgc3RvcmUoc3RvcmFibGU6IFQpOiBQcm9taXNlPFQ+IHtcclxuICAgICAgICBpZiAoIWlzU3RvcmFibGUoc3RvcmFibGUpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0eXBlb2Ygc3RvcmFibGV9IGlzIG5vdCBzdG9yYWJsZS5gKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc3RvcmVkID0gYXdhaXQgdGhpcy5hcGkuc3RvcmUoc3RvcmFibGUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLndyaXRlSW5DYWNoZShzdG9yZWQpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhbGwgc3RvcmFibGUgb2YgdHlwZSBUIGV4aXN0aW5nIGF0IHBhdGhuYW1lLlxyXG4gICAgICogSWYgbm90aGluZyBpcyBmb3VuZCByZXR1cm5zIGFuIGVtcHR5IHJlY29yZC5cclxuICAgICAqL1xyXG4gICAgcmV0cmlldmVBbGwoKTogUHJvbWlzZTxBcnJheTxUPj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldENhY2hlKCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGEgc3RvcmFibGUgd2l0aCBtYXRjaGluZyBpZC5cclxuICAgICAqIFRocm93IGlmIG5vIHN0b3JhYmxlIGlzIGZvdW5kIG9yIHBhdGggZG9lcyBub3QgZXhpc3QuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkIFN0b3JhYmxlIGlkXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHJldHJpZXZlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlQnlQYXRoKGlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhIHN0b3JhYmxlIHdpdGggbWF0Y2hpbmcgcGF0aC5cclxuICAgICAqIFRocm93IGlmIG5vIHN0b3JhYmxlIGlzIGZvdW5kIG9yIHBhdGggZG9lcyBub3QgZXhpc3QuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhdGggU3RvcmFibGUgcGF0aFxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUJ5UGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgZm9yIChsZXQgc3RvcmFibGUgb2YgY2FjaGUpIHtcclxuICAgICAgICAgICAgaWYgKHN0b3JhYmxlLmlkLnN0YXJ0c1dpdGgocGF0aCkpIHJldHVybiBzdG9yYWJsZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYWxsIHN0b3JhYmxlIG9mIHR5cGUgVCBleGlzdGluZyBhdCBwYXRoIHVuZGVyIHBhdGhuYW1lLlxyXG4gICAgICogSWYgbm90aGluZyBpcyBmb3VuZCByZXR1cm5zIGFuIGVtcHR5IGxpc3QuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHJldHJpZXZlQXRQYXRoKHBhdGg6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8VD4+IHtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IGF3YWl0IHRoaXMuZ2V0Q2FjaGUoKTtcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gW107XHJcblxyXG4gICAgICAgIGZvciAobGV0IHN0b3JhYmxlIG9mIGNhY2hlKSB7XHJcbiAgICAgICAgICAgIGlmIChzdG9yYWJsZS5pZC5zdGFydHNXaXRoKHBhdGgpKSByZXN1bHRzLnB1c2goc3RvcmFibGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZWxldGUgYSBTdG9yYWJsZSBzdG9yZWQgYXQgcGF0aG5hbWUvaWQuXHJcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBzb21ldGhpbmcgd2FzIGRlbGV0ZWQsIGZhbHNlIGlmIG5vdGhpbmcgZXhpc3RzIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZCBTdG9yYWJsZSBpZFxyXG4gICAgICovXHJcbiAgICBhc3luYyBkZWxldGVCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgICAgICBjb25zdCBkZWxldGVkID0gYXdhaXQgdGhpcy5hcGkuZGVsZXRlQnlJZCh0aGlzLnN0cmlwSWQoaWQpKTtcclxuICAgICAgICBjb25zdCBjYWNoZSA9IGF3YWl0IHRoaXMuZ2V0Q2FjaGUoKTtcclxuICAgICAgICB0aGlzLmNhY2hlID0gY2FjaGUuZmlsdGVyKGNhY2hlZCA9PiBjYWNoZWQuaWQgIT09IGlkKTtcclxuICAgICAgICByZXR1cm4gZGVsZXRlZDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdHJpcCBpZCByZW1vdmVzIHJlZHVuZGFudCBwYXJ0cyBzaGFyZWQgYnkgdGhlIGlkIGFuZCB0aGUgZW5kcG9pbnQuXHJcbiAgICAgKlxyXG4gICAgICogRXg6IGlmIHRoZSBlbmRwb2ludCBwYXRoIGlzIGB2MS9lbmRwb2ludC9lcGNpX2lkL2BcclxuICAgICAqIGFuZCB0aGUgaWQgaXMgYGVwY2lfaWQvcGFydF9hL3BhcnRfYmBcclxuICAgICAqIHRoZSByZXN1bHRpbmcgc3RyaXBwZWQgaWQgd291bGQgYmUgYHBhcnRfYS9wYXJ0X2JgLFxyXG4gICAgICogYSBwYXRoIHJlbW92ZWQgZnJvbSB0aGUgcmVkdW5kYW50IHBhcnQgYGVwY2lfaWRgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc3RyaXBJZChpZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMucGF0aG5hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICBsZXQgcGF0aCA9IGlkLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IG1hdGNoID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZW5kcG9pbnQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHBhcnQgPSBlbmRwb2ludFtpXTtcclxuICAgICAgICAgICAgaWYgKHBhcnQgPT0gcGF0aFswXSkge1xyXG4gICAgICAgICAgICAgICAgbWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcGF0aCA9IHBhdGguc2xpY2UoMSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGF0aC5qb2luKCcvJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyB3cml0ZUluQ2FjaGUoc3RvcmFibGU6IFQpOiBQcm9taXNlPFQ+IHtcclxuICAgICAgICBhd2FpdCB0aGlzLnJlbW92ZUZyb21DYWNoZShzdG9yYWJsZS5pZCk7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgY2FjaGUucHVzaChzdG9yYWJsZSk7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlO1xyXG4gICAgICAgIHJldHVybiBzdG9yYWJsZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIHJlbW92ZUZyb21DYWNoZShpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBjYWNoZS5maWx0ZXIoY2FjaGVkID0+IGNhY2hlZC5pZCAhPT0gaWQpO1xyXG4gICAgICAgIGNvbnN0IGRlbGV0ZWQgPSBmaWx0ZXJlZC5sZW5ndGggIT0gY2FjaGUubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSBmaWx0ZXJlZDtcclxuICAgICAgICByZXR1cm4gZGVsZXRlZDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGdldENhY2hlKCk6IFByb21pc2U8QXJyYXk8VD4+IHtcclxuICAgICAgICBpZiAodGhpcy5jYWNoZSAhPT0gbnVsbCkgcmV0dXJuIHRoaXMuY2FjaGU7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJldHJpZXZpbmcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXRyaWV2aW5nID0gdGhpcy5hcGkucmV0cmlldmVBbGwoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmV0cmlldmluZy50aGVuKChyZXRyaWV2ZWQpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGUgPSByZXRyaWV2ZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2aW5nO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmV0cmlldmluZzogUHJvbWlzZTxBcnJheTxUPj4gfCBudWxsID0gbnVsbDtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBpbmRpY2F0ZXVyVmFsdWVTdG9yZSA9IG5ldyBIeWJyaWRTdG9yZTxJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZT4oe1xyXG4gICAgaG9zdDogZ2V0Q3VycmVudEFQSSgpLFxyXG4gICAgZW5kcG9pbnQ6IGB2MS8ke0luZGljYXRldXJWYWx1ZS5wYXRobmFtZX0vJHtnZXRDdXJyZW50RXBjaUlkKCl9YCxcclxuICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZSkgPT4gc3RvcmFibGUsXHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkKSA9PiBuZXcgSW5kaWNhdGV1clZhbHVlU3RvcmFibGUoc2VyaWFsaXplZCBhcyBJbmRpY2F0ZXVyVmFsdWVJbnRlcmZhY2UpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBhY3Rpb25TdGF0dXNTdG9yZSA9IG5ldyBIeWJyaWRTdG9yZTxBY3Rpb25TdGF0dXNTdG9yYWJsZT4oe1xyXG4gICAgaG9zdDogZ2V0Q3VycmVudEFQSSgpLFxyXG4gICAgZW5kcG9pbnQ6IGB2MS8ke0FjdGlvblN0YXR1cy5wYXRobmFtZX0vJHtnZXRDdXJyZW50RXBjaUlkKCl9YCxcclxuICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZSkgPT4gc3RvcmFibGUsXHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkKSA9PiBuZXcgQWN0aW9uU3RhdHVzU3RvcmFibGUoc2VyaWFsaXplZCBhcyBBY3Rpb25TdGF0dXNJbnRlcmZhY2UpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBhY3Rpb25DdXN0b21TdG9yZSA9IG5ldyBIeWJyaWRTdG9yZTxBY3Rpb25DdXN0b21TdG9yYWJsZT4oe1xyXG4gICAgaG9zdDogZ2V0Q3VycmVudEFQSSgpLFxyXG4gICAgZW5kcG9pbnQ6IGB2MS8ke0FjdGlvbkN1c3RvbS5wYXRobmFtZX0vJHtnZXRDdXJyZW50RXBjaUlkKCl9YCxcclxuICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZSkgPT4gc3RvcmFibGUsXHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkKSA9PiBuZXcgQWN0aW9uQ3VzdG9tU3RvcmFibGUoc2VyaWFsaXplZCBhcyBBY3Rpb25DdXN0b21JbnRlcmZhY2UpLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBtZXN1cmVDdXN0b21TdG9yZSA9IG5ldyBIeWJyaWRTdG9yZTxNZXN1cmVDdXN0b21TdG9yYWJsZT4oe1xyXG4gICAgaG9zdDogZ2V0Q3VycmVudEFQSSgpLFxyXG4gICAgZW5kcG9pbnQ6IGB2MS8ke01lc3VyZUN1c3RvbS5wYXRobmFtZX0vJHtnZXRDdXJyZW50RXBjaUlkKCl9YCxcclxuICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZSkgPT4gc3RvcmFibGUsXHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkKSA9PiBuZXcgTWVzdXJlQ3VzdG9tU3RvcmFibGUoc2VyaWFsaXplZCBhcyBNZXN1cmVDdXN0b21JbnRlcmZhY2UpLFxyXG59KTsiLCJpbXBvcnQge2FjdGlvblN0YXR1c1N0b3JlfSBmcm9tIFwiLi4vLi4vYXBpL2h5YnJpZFN0b3JlXCI7XHJcbmltcG9ydCB7Z2V0Q3VycmVudEVwY2lJZH0gZnJvbSBcIi4uLy4uL2FwaS9jdXJyZW50RXBjaVwiO1xyXG5pbXBvcnQge0FjdGlvblN0YXR1c1N0b3JhYmxlfSBmcm9tIFwiLi4vLi4vc3RvcmFibGVzL0FjdGlvblN0YXR1c1N0b3JhYmxlXCI7XHJcblxyXG5jb25zdCBlY3BpSWQgPSBnZXRDdXJyZW50RXBjaUlkKClcclxuXHJcbmNvbnN0IGFkZExpc3RlbmVycyA9IChhY3Rpb25JZDogc3RyaW5nLCBpbnB1dHM6IE5vZGVMaXN0T2Y8SFRNTElucHV0RWxlbWVudD4pOiB2b2lkID0+IHtcclxuICAgIGxldCBvbkNoYW5nZSA9IChldmVudDogRXZlbnQpOiB2b2lkID0+IHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIGNvbnN0IGFjdGlvbkF2YW5jZW1lbnRLZXkgPSB0YXJnZXQudmFsdWVcclxuICAgICAgICBjb25zdCBhdmFuY2VtZW50ID0gbmV3IEFjdGlvblN0YXR1c1N0b3JhYmxlKHtcclxuICAgICAgICAgICAgZXBjaV9pZDogZWNwaUlkLFxyXG4gICAgICAgICAgICBhY3Rpb25faWQ6IGFjdGlvbklkLFxyXG4gICAgICAgICAgICBhdmFuY2VtZW50OiBhY3Rpb25BdmFuY2VtZW50S2V5XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgYWN0aW9uU3RhdHVzU3RvcmUuc3RvcmUoYXZhbmNlbWVudClcclxuICAgIH1cclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpOiB2b2lkID0+IHtcclxuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoYW5nZSlcclxuICAgIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayB0aGUgdmFsdWUgb2YgdGhlIHN0YXR1cyBwaWNrZXIgd2l0aCBhIGRlZmF1bHQgdmFsdWUgb3IgdGhlIHZhbHVlIHJldHJpZXZlZCBmcm9tIHN0b3JlLlxyXG4gKi9cclxuY29uc3QgY2hlY2tJbnB1dCA9IGFzeW5jIChhY3Rpb25JZDogc3RyaW5nLCBpbnB1dHM6IE5vZGVMaXN0T2Y8SFRNTElucHV0RWxlbWVudD4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuICAgIGxldCBhY3Rpb25BdmFuY2VtZW50S2V5ID0gJ3Bhc19mYWl0ZSc7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IGF3YWl0IGFjdGlvblN0YXR1c1N0b3JlLnJldHJpZXZlQnlJZChgJHtlY3BpSWR9LyR7YWN0aW9uSWR9YClcclxuICAgICAgICBpZiAoc3RhdHVzKSBhY3Rpb25BdmFuY2VtZW50S2V5ID0gc3RhdHVzLmF2YW5jZW1lbnQ7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgLy8gIHNob3VsZCBkbyBzb21ldGhpbmcgbWVhbmluZ2Z1bC5cclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRJbnB1dElkID0gYGFjdGlvbi0ke2FjdGlvbklkfV8ke2FjdGlvbkF2YW5jZW1lbnRLZXl9YFxyXG4gICAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dDogSFRNTElucHV0RWxlbWVudCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaW5wdXQuaWQgPT09IHNlbGVjdGVkSW5wdXRJZCkgaW5wdXQuY2hlY2tlZCA9IHRydWVcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgdGhlIHN0YXR1cyBwaWNrZXIgb2YgYW4gYWN0aW9uIHdpdGggYWxsIGl0cyBldmVudCBsaXN0ZW5lcnNcclxuICovXHJcbmV4cG9ydCBjb25zdCBpbml0ID0gKGVsZW1lbnQ6IEhUTUxGaWVsZFNldEVsZW1lbnQpOiB2b2lkID0+IHtcclxuICAgIGxldCBhY3Rpb25JZCA9IGVsZW1lbnQuZGF0YXNldC5hY3Rpb25JZCB8fCAnJ1xyXG4gICAgbGV0IGlucHV0cyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MSW5wdXRFbGVtZW50PignaW5wdXRbdHlwZT1cInJhZGlvXCJdJylcclxuXHJcbiAgICBhZGRMaXN0ZW5lcnMoYWN0aW9uSWQsIGlucHV0cylcclxuICAgIGNoZWNrSW5wdXQoYWN0aW9uSWQsIGlucHV0cylcclxufSIsImltcG9ydCB7IGluaXQgfSBmcm9tICcuL3N0YXR1c1BpY2tlcidcclxuXHJcbmxldCBzdGF0dXNQaWNrZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MRmllbGRTZXRFbGVtZW50PignLnN0YXR1cycpXHJcblxyXG5zdGF0dXNQaWNrZXJzLmZvckVhY2goKGVsZW1lbnQpOiB2b2lkID0+IGluaXQoZWxlbWVudCkpXHJcblxyXG5cclxuIiwiaW1wb3J0IHtpbmRpY2F0ZXVyVmFsdWVTdG9yZX0gZnJvbSBcIi4uLy4uL2FwaS9oeWJyaWRTdG9yZVwiO1xyXG5pbXBvcnQge0luZGljYXRldXJWYWx1ZVN0b3JhYmxlfSBmcm9tICcuLi8uLi9zdG9yYWJsZXMvSW5kaWNhdGV1clZhbHVlU3RvcmFibGUnXHJcbmltcG9ydCB7Z2V0Q3VycmVudEVwY2lJZH0gZnJvbSBcIi4uLy4uL2FwaS9jdXJyZW50RXBjaVwiO1xyXG5cclxuLyoqXHJcbiAqIFByZXZlbnQgZGVmYXVsdCBmb3JtIGJlaGF2aW9yLlxyXG4gKi9cclxuY29uc3QgcHJldmVudERlZmF1bHQgPSAoZXZlbnQ6IEV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTYXZlIHZhbHVlIGZvciBhIHNpbmdsZSB5ZWFybHkgaW5wdXQgb24gYmx1ci5cclxuICovXHJcbmNvbnN0IG9uQmx1ciA9IChldmVudDogRm9jdXNFdmVudCk6IHZvaWQgPT4ge1xyXG4gICAgY29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgIGNvbnN0IHtpZCwgeWVhcn0gPSBpbnB1dFByb3BlcnRpZXMoaW5wdXQpXHJcbiAgICBjb25zdCBjdXJyZW50RXBjaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpXHJcbiAgICBjb25zdCB2YWx1ZSA9IG5ldyBJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZSh7XHJcbiAgICAgICAgZXBjaV9pZDogY3VycmVudEVwY2lJZCxcclxuICAgICAgICBpbmRpY2F0ZXVyX2lkOiBpZCxcclxuICAgICAgICB5ZWFyOiB5ZWFyLFxyXG4gICAgICAgIHZhbHVlOiBpbnB1dC52YWx1ZVxyXG4gICAgfSlcclxuXHJcbiAgICBpbmRpY2F0ZXVyVmFsdWVTdG9yZS5zdG9yZSh2YWx1ZSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENhbGwgYmx1ciBvbiBlbnRlci5cclxuICovXHJcbmNvbnN0IG9uS2V5UHJlc3MgPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkID0+IHtcclxuICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcclxuICAgICAgICBjb25zdCBpbnB1dCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50XHJcbiAgICAgICAgaW5wdXQuYmx1cigpXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGEgc2luZ2xlIHllYXJseSBpbnB1dCB3aXRoIGEgcmV0cmlldmVkIHZhbHVlIG9yIGFuIGVtcHR5IHZhbHVlIGlmIG5vbmUgZm91bmQuXHJcbiAqL1xyXG5jb25zdCBpbml0WWVhcmx5SW5wdXQgPSBhc3luYyAoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuXHJcbiAgICBpbnB1dC52YWx1ZSA9ICAnJ1xyXG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIG9uQmx1cilcclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgb25LZXlQcmVzcylcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgaW5kaWNhdGV1ciBpZCBhbmQgeWVhciBmcm9tIGlucHV0LlxyXG4gKi9cclxuY29uc3QgaW5wdXRQcm9wZXJ0aWVzID0gKGlucHV0OiBIVE1MSW5wdXRFbGVtZW50KTogeyBpZDogc3RyaW5nLCB5ZWFyOiBudW1iZXIgfSA9PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkOiBpbnB1dC5kYXRhc2V0LmluZGljYXRvcklkISxcclxuICAgICAgICB5ZWFyOiAraW5wdXQuZGF0YXNldC5pbmRpY2F0b3JZZWFyISxcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgZWFjaCB5ZWFybHkgaW5wdXQgbGlua2VkIHRvIGFuIGluZGljYXRvciB3aXRoIGFsbCBpdHMgZXZlbnQgbGlzdGVuZXJzLlxyXG4gKi9cclxuZXhwb3J0IGNvbnN0IGluaXQgPSBhc3luYyAgKGZvcm06IEhUTUxGb3JtRWxlbWVudCk6IFByb21pc2U8dm9pZD4gPT4ge1xyXG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBwcmV2ZW50RGVmYXVsdClcclxuICAgIGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKVxyXG4gICAgZm9yIChsZXQgaW5wdXQgb2YgaW5wdXRzKSB7XHJcbiAgICAgICAgaW5pdFllYXJseUlucHV0KGlucHV0KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHtpZCwgeWVhcn0gPSBpbnB1dFByb3BlcnRpZXMoaW5wdXRzWzBdKVxyXG4gICAgY29uc3QgZXBjaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpXHJcblxyXG4gICAgY29uc3QgaW5kaWNhdGV1clZhbHVlcyA9IGF3YWl0IGluZGljYXRldXJWYWx1ZVN0b3JlLnJldHJpZXZlQXRQYXRoKFxyXG4gICAgICAgIGAke2VwY2lJZH0vJHtpZH1gXHJcbiAgICApXHJcblxyXG4gICAgZm9yIChsZXQgaW5wdXQgb2YgaW5wdXRzKSB7XHJcbiAgICAgICAgY29uc3Qge2lkLCB5ZWFyfSA9IGlucHV0UHJvcGVydGllcyhpbnB1dClcclxuICAgICAgICBsZXQgdmFsdWUgPSAnJ1xyXG4gICAgICAgIGZvciAobGV0IGluZGljYXRldXJWYWx1ZSBvZiBpbmRpY2F0ZXVyVmFsdWVzKSB7XHJcbiAgICAgICAgICAgIGlmIChpbmRpY2F0ZXVyVmFsdWUueWVhciA9PSB5ZWFyICYmIGluZGljYXRldXJWYWx1ZS5pbmRpY2F0ZXVyX2lkID09IGlkKVxyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSBpbmRpY2F0ZXVyVmFsdWUudmFsdWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlucHV0LnZhbHVlID0gdmFsdWVcclxuICAgIH1cclxufVxyXG5cclxuXHJcbiIsImZ1bmN0aW9uIG5vb3AoKSB7IH1cbmNvbnN0IGlkZW50aXR5ID0geCA9PiB4O1xuZnVuY3Rpb24gYXNzaWduKHRhciwgc3JjKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgayBpbiBzcmMpXG4gICAgICAgIHRhcltrXSA9IHNyY1trXTtcbiAgICByZXR1cm4gdGFyO1xufVxuZnVuY3Rpb24gaXNfcHJvbWlzZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gYWRkX2xvY2F0aW9uKGVsZW1lbnQsIGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhcikge1xuICAgIGVsZW1lbnQuX19zdmVsdGVfbWV0YSA9IHtcbiAgICAgICAgbG9jOiB7IGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhciB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHJ1bihmbikge1xuICAgIHJldHVybiBmbigpO1xufVxuZnVuY3Rpb24gYmxhbmtfb2JqZWN0KCkge1xuICAgIHJldHVybiBPYmplY3QuY3JlYXRlKG51bGwpO1xufVxuZnVuY3Rpb24gcnVuX2FsbChmbnMpIHtcbiAgICBmbnMuZm9yRWFjaChydW4pO1xufVxuZnVuY3Rpb24gaXNfZnVuY3Rpb24odGhpbmcpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gc2FmZV9ub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiIHx8ICgoYSAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHx8IHR5cGVvZiBhID09PSAnZnVuY3Rpb24nKTtcbn1cbmZ1bmN0aW9uIG5vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGI7XG59XG5mdW5jdGlvbiBpc19lbXB0eShvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zdG9yZShzdG9yZSwgbmFtZSkge1xuICAgIGlmIChzdG9yZSAhPSBudWxsICYmIHR5cGVvZiBzdG9yZS5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnJHtuYW1lfScgaXMgbm90IGEgc3RvcmUgd2l0aCBhICdzdWJzY3JpYmUnIG1ldGhvZGApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN1YnNjcmliZShzdG9yZSwgLi4uY2FsbGJhY2tzKSB7XG4gICAgaWYgKHN0b3JlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICAgIGNvbnN0IHVuc3ViID0gc3RvcmUuc3Vic2NyaWJlKC4uLmNhbGxiYWNrcyk7XG4gICAgcmV0dXJuIHVuc3ViLnVuc3Vic2NyaWJlID8gKCkgPT4gdW5zdWIudW5zdWJzY3JpYmUoKSA6IHVuc3ViO1xufVxuZnVuY3Rpb24gZ2V0X3N0b3JlX3ZhbHVlKHN0b3JlKSB7XG4gICAgbGV0IHZhbHVlO1xuICAgIHN1YnNjcmliZShzdG9yZSwgXyA9PiB2YWx1ZSA9IF8pKCk7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gY29tcG9uZW50X3N1YnNjcmliZShjb21wb25lbnQsIHN0b3JlLCBjYWxsYmFjaykge1xuICAgIGNvbXBvbmVudC4kJC5vbl9kZXN0cm95LnB1c2goc3Vic2NyaWJlKHN0b3JlLCBjYWxsYmFjaykpO1xufVxuZnVuY3Rpb24gY3JlYXRlX3Nsb3QoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY3R4ID0gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKTtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25bMF0oc2xvdF9jdHgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIHJldHVybiBkZWZpbml0aW9uWzFdICYmIGZuXG4gICAgICAgID8gYXNzaWduKCQkc2NvcGUuY3R4LnNsaWNlKCksIGRlZmluaXRpb25bMV0oZm4oY3R4KSkpXG4gICAgICAgIDogJCRzY29wZS5jdHg7XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jaGFuZ2VzKGRlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uWzJdICYmIGZuKSB7XG4gICAgICAgIGNvbnN0IGxldHMgPSBkZWZpbml0aW9uWzJdKGZuKGRpcnR5KSk7XG4gICAgICAgIGlmICgkJHNjb3BlLmRpcnR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBsZXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgbGV0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlZCA9IFtdO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gTWF0aC5tYXgoJCRzY29wZS5kaXJ0eS5sZW5ndGgsIGxldHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRbaV0gPSAkJHNjb3BlLmRpcnR5W2ldIHwgbGV0c1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtZXJnZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICQkc2NvcGUuZGlydHkgfCBsZXRzO1xuICAgIH1cbiAgICByZXR1cm4gJCRzY29wZS5kaXJ0eTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90KHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGNvbnN0IHNsb3RfY2hhbmdlcyA9IGdldF9zbG90X2NoYW5nZXMoc2xvdF9kZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbik7XG4gICAgaWYgKHNsb3RfY2hhbmdlcykge1xuICAgICAgICBjb25zdCBzbG90X2NvbnRleHQgPSBnZXRfc2xvdF9jb250ZXh0KHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbiAgICAgICAgc2xvdC5wKHNsb3RfY29udGV4dCwgc2xvdF9jaGFuZ2VzKTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdF9zcHJlYWQoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGRpcnR5LCBnZXRfc2xvdF9jaGFuZ2VzX2ZuLCBnZXRfc2xvdF9zcHJlYWRfY2hhbmdlc19mbiwgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGNvbnN0IHNsb3RfY2hhbmdlcyA9IGdldF9zbG90X3NwcmVhZF9jaGFuZ2VzX2ZuKGRpcnR5KSB8IGdldF9zbG90X2NoYW5nZXMoc2xvdF9kZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbik7XG4gICAgaWYgKHNsb3RfY2hhbmdlcykge1xuICAgICAgICBjb25zdCBzbG90X2NvbnRleHQgPSBnZXRfc2xvdF9jb250ZXh0KHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbiAgICAgICAgc2xvdC5wKHNsb3RfY29udGV4dCwgc2xvdF9jaGFuZ2VzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBleGNsdWRlX2ludGVybmFsX3Byb3BzKHByb3BzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoa1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdWx0W2tdID0gcHJvcHNba107XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfcmVzdF9wcm9wcyhwcm9wcywga2V5cykge1xuICAgIGNvbnN0IHJlc3QgPSB7fTtcbiAgICBrZXlzID0gbmV3IFNldChrZXlzKTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmICgha2V5cy5oYXMoaykgJiYga1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN0O1xufVxuZnVuY3Rpb24gY29tcHV0ZV9zbG90cyhzbG90cykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICBsZXQgcmFuID0gZmFsc2U7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgIGlmIChyYW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHJhbiA9IHRydWU7XG4gICAgICAgIGZuLmNhbGwodGhpcywgLi4uYXJncyk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIG51bGxfdG9fZW1wdHkodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRfc3RvcmVfdmFsdWUoc3RvcmUsIHJldCwgdmFsdWUgPSByZXQpIHtcbiAgICBzdG9yZS5zZXQodmFsdWUpO1xuICAgIHJldHVybiByZXQ7XG59XG5jb25zdCBoYXNfcHJvcCA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xuZnVuY3Rpb24gYWN0aW9uX2Rlc3Ryb3llcihhY3Rpb25fcmVzdWx0KSB7XG4gICAgcmV0dXJuIGFjdGlvbl9yZXN1bHQgJiYgaXNfZnVuY3Rpb24oYWN0aW9uX3Jlc3VsdC5kZXN0cm95KSA/IGFjdGlvbl9yZXN1bHQuZGVzdHJveSA6IG5vb3A7XG59XG5cbmNvbnN0IGlzX2NsaWVudCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xubGV0IG5vdyA9IGlzX2NsaWVudFxuICAgID8gKCkgPT4gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXG4gICAgOiAoKSA9PiBEYXRlLm5vdygpO1xubGV0IHJhZiA9IGlzX2NsaWVudCA/IGNiID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShjYikgOiBub29wO1xuLy8gdXNlZCBpbnRlcm5hbGx5IGZvciB0ZXN0aW5nXG5mdW5jdGlvbiBzZXRfbm93KGZuKSB7XG4gICAgbm93ID0gZm47XG59XG5mdW5jdGlvbiBzZXRfcmFmKGZuKSB7XG4gICAgcmFmID0gZm47XG59XG5cbmNvbnN0IHRhc2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gcnVuX3Rhc2tzKG5vdykge1xuICAgIHRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGlmICghdGFzay5jKG5vdykpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgICAgIHRhc2suZigpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHRhc2tzLnNpemUgIT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xufVxuLyoqXG4gKiBGb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5IVxuICovXG5mdW5jdGlvbiBjbGVhcl9sb29wcygpIHtcbiAgICB0YXNrcy5jbGVhcigpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHRhc2sgdGhhdCBydW5zIG9uIGVhY2ggcmFmIGZyYW1lXG4gKiB1bnRpbCBpdCByZXR1cm5zIGEgZmFsc3kgdmFsdWUgb3IgaXMgYWJvcnRlZFxuICovXG5mdW5jdGlvbiBsb29wKGNhbGxiYWNrKSB7XG4gICAgbGV0IHRhc2s7XG4gICAgaWYgKHRhc2tzLnNpemUgPT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IG5ldyBQcm9taXNlKGZ1bGZpbGwgPT4ge1xuICAgICAgICAgICAgdGFza3MuYWRkKHRhc2sgPSB7IGM6IGNhbGxiYWNrLCBmOiBmdWxmaWxsIH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgYWJvcnQoKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBhcHBlbmQodGFyZ2V0LCBub2RlKSB7XG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG59XG5mdW5jdGlvbiBkZXRhY2gobm9kZSkge1xuICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfZWFjaChpdGVyYXRpb25zLCBkZXRhY2hpbmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGl0ZXJhdGlvbnNbaV0pXG4gICAgICAgICAgICBpdGVyYXRpb25zW2ldLmQoZGV0YWNoaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTtcbn1cbmZ1bmN0aW9uIGVsZW1lbnRfaXMobmFtZSwgaXMpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lLCB7IGlzIH0pO1xufVxuZnVuY3Rpb24gb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcyhvYmosIGV4Y2x1ZGUpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgICAgIGlmIChoYXNfcHJvcChvYmosIGspXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAmJiBleGNsdWRlLmluZGV4T2YoaykgPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICB0YXJnZXRba10gPSBvYmpba107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIHN2Z19lbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIG5hbWUpO1xufVxuZnVuY3Rpb24gdGV4dChkYXRhKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRhdGEpO1xufVxuZnVuY3Rpb24gc3BhY2UoKSB7XG4gICAgcmV0dXJuIHRleHQoJyAnKTtcbn1cbmZ1bmN0aW9uIGVtcHR5KCkge1xuICAgIHJldHVybiB0ZXh0KCcnKTtcbn1cbmZ1bmN0aW9uIGxpc3Rlbihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgcmV0dXJuICgpID0+IG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG59XG5mdW5jdGlvbiBwcmV2ZW50X2RlZmF1bHQoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzdG9wX3Byb3BhZ2F0aW9uKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNlbGYoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcylcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICBlbHNlIGlmIChub2RlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpICE9PSB2YWx1ZSlcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBzZXRfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNvbnN0IGRlc2NyaXB0b3JzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMobm9kZS5fX3Byb3RvX18pO1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXNba2V5XSA9PSBudWxsKSB7XG4gICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ3N0eWxlJykge1xuICAgICAgICAgICAgbm9kZS5zdHlsZS5jc3NUZXh0ID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGtleSA9PT0gJ19fdmFsdWUnKSB7XG4gICAgICAgICAgICBub2RlLnZhbHVlID0gbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlc2NyaXB0b3JzW2tleV0gJiYgZGVzY3JpcHRvcnNba2V5XS5zZXQpIHtcbiAgICAgICAgICAgIG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X3N2Z19hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGF0dHIobm9kZSwga2V5LCBhdHRyaWJ1dGVzW2tleV0pO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9jdXN0b21fZWxlbWVudF9kYXRhKG5vZGUsIHByb3AsIHZhbHVlKSB7XG4gICAgaWYgKHByb3AgaW4gbm9kZSkge1xuICAgICAgICBub2RlW3Byb3BdID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhdHRyKG5vZGUsIHByb3AsIHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB4bGlua19hdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBub2RlLnNldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgYXR0cmlidXRlLCB2YWx1ZSk7XG59XG5mdW5jdGlvbiBnZXRfYmluZGluZ19ncm91cF92YWx1ZShncm91cCwgX192YWx1ZSwgY2hlY2tlZCkge1xuICAgIGNvbnN0IHZhbHVlID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGdyb3VwW2ldLmNoZWNrZWQpXG4gICAgICAgICAgICB2YWx1ZS5hZGQoZ3JvdXBbaV0uX192YWx1ZSk7XG4gICAgfVxuICAgIGlmICghY2hlY2tlZCkge1xuICAgICAgICB2YWx1ZS5kZWxldGUoX192YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBBcnJheS5mcm9tKHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHRvX251bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gJycgPyBudWxsIDogK3ZhbHVlO1xufVxuZnVuY3Rpb24gdGltZV9yYW5nZXNfdG9fYXJyYXkocmFuZ2VzKSB7XG4gICAgY29uc3QgYXJyYXkgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhbmdlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBhcnJheS5wdXNoKHsgc3RhcnQ6IHJhbmdlcy5zdGFydChpKSwgZW5kOiByYW5nZXMuZW5kKGkpIH0pO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG59XG5mdW5jdGlvbiBjaGlsZHJlbihlbGVtZW50KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5jaGlsZE5vZGVzKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnQobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIHN2Zykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgbGV0IGogPSAwO1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlID0gW107XG4gICAgICAgICAgICB3aGlsZSAoaiA8IG5vZGUuYXR0cmlidXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBub2RlLmF0dHJpYnV0ZXNbaisrXTtcbiAgICAgICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZXNbYXR0cmlidXRlLm5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZS5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHJlbW92ZS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKHJlbW92ZVtrXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm9kZXMuc3BsaWNlKGksIDEpWzBdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdmcgPyBzdmdfZWxlbWVudChuYW1lKSA6IGVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBjbGFpbV90ZXh0KG5vZGVzLCBkYXRhKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSAzKSB7XG4gICAgICAgICAgICBub2RlLmRhdGEgPSAnJyArIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gbm9kZXMuc3BsaWNlKGksIDEpWzBdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0ZXh0KGRhdGEpO1xufVxuZnVuY3Rpb24gY2xhaW1fc3BhY2Uobm9kZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fdGV4dChub2RlcywgJyAnKTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhKHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCAhPT0gZGF0YSlcbiAgICAgICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF92YWx1ZShpbnB1dCwgdmFsdWUpIHtcbiAgICBpbnB1dC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3R5cGUoaW5wdXQsIHR5cGUpIHtcbiAgICB0cnkge1xuICAgICAgICBpbnB1dC50eXBlID0gdHlwZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdHlsZShub2RlLCBrZXksIHZhbHVlLCBpbXBvcnRhbnQpIHtcbiAgICBub2RlLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsdWUsIGltcG9ydGFudCA/ICdpbXBvcnRhbnQnIDogJycpO1xufVxuZnVuY3Rpb24gc2VsZWN0X29wdGlvbihzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgaWYgKG9wdGlvbi5fX3ZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb25zKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB+dmFsdWUuaW5kZXhPZihvcHRpb24uX192YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X3ZhbHVlKHNlbGVjdCkge1xuICAgIGNvbnN0IHNlbGVjdGVkX29wdGlvbiA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKCc6Y2hlY2tlZCcpIHx8IHNlbGVjdC5vcHRpb25zWzBdO1xuICAgIHJldHVybiBzZWxlY3RlZF9vcHRpb24gJiYgc2VsZWN0ZWRfb3B0aW9uLl9fdmFsdWU7XG59XG5mdW5jdGlvbiBzZWxlY3RfbXVsdGlwbGVfdmFsdWUoc2VsZWN0KSB7XG4gICAgcmV0dXJuIFtdLm1hcC5jYWxsKHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCc6Y2hlY2tlZCcpLCBvcHRpb24gPT4gb3B0aW9uLl9fdmFsdWUpO1xufVxuLy8gdW5mb3J0dW5hdGVseSB0aGlzIGNhbid0IGJlIGEgY29uc3RhbnQgYXMgdGhhdCB3b3VsZG4ndCBiZSB0cmVlLXNoYWtlYWJsZVxuLy8gc28gd2UgY2FjaGUgdGhlIHJlc3VsdCBpbnN0ZWFkXG5sZXQgY3Jvc3NvcmlnaW47XG5mdW5jdGlvbiBpc19jcm9zc29yaWdpbigpIHtcbiAgICBpZiAoY3Jvc3NvcmlnaW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjcm9zc29yaWdpbiA9IGZhbHNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICB2b2lkIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjcm9zc29yaWdpbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNyb3Nzb3JpZ2luO1xufVxuZnVuY3Rpb24gYWRkX3Jlc2l6ZV9saXN0ZW5lcihub2RlLCBmbikge1xuICAgIGNvbnN0IGNvbXB1dGVkX3N0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoY29tcHV0ZWRfc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgIH1cbiAgICBjb25zdCBpZnJhbWUgPSBlbGVtZW50KCdpZnJhbWUnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7ICcgK1xuICAgICAgICAnb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyOiAwOyBvcGFjaXR5OiAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgei1pbmRleDogLTE7Jyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgIGlmcmFtZS50YWJJbmRleCA9IC0xO1xuICAgIGNvbnN0IGNyb3Nzb3JpZ2luID0gaXNfY3Jvc3NvcmlnaW4oKTtcbiAgICBsZXQgdW5zdWJzY3JpYmU7XG4gICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSBcImRhdGE6dGV4dC9odG1sLDxzY3JpcHQ+b25yZXNpemU9ZnVuY3Rpb24oKXtwYXJlbnQucG9zdE1lc3NhZ2UoMCwnKicpfTwvc2NyaXB0PlwiO1xuICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3Rlbih3aW5kb3csICdtZXNzYWdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBpZnJhbWUuY29udGVudFdpbmRvdylcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnO1xuICAgICAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4oaWZyYW1lLmNvbnRlbnRXaW5kb3csICdyZXNpemUnLCBmbik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFwcGVuZChub2RlLCBpZnJhbWUpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bnN1YnNjcmliZSAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXRhY2goaWZyYW1lKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdG9nZ2xlX2NsYXNzKGVsZW1lbnQsIG5hbWUsIHRvZ2dsZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0W3RvZ2dsZSA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xufVxuZnVuY3Rpb24gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCkge1xuICAgIGNvbnN0IGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBmYWxzZSwgZmFsc2UsIGRldGFpbCk7XG4gICAgcmV0dXJuIGU7XG59XG5mdW5jdGlvbiBxdWVyeV9zZWxlY3Rvcl9hbGwoc2VsZWN0b3IsIHBhcmVudCA9IGRvY3VtZW50LmJvZHkpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShwYXJlbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xufVxuY2xhc3MgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoYW5jaG9yID0gbnVsbCkge1xuICAgICAgICB0aGlzLmEgPSBhbmNob3I7XG4gICAgICAgIHRoaXMuZSA9IHRoaXMubiA9IG51bGw7XG4gICAgfVxuICAgIG0oaHRtbCwgdGFyZ2V0LCBhbmNob3IgPSBudWxsKSB7XG4gICAgICAgIGlmICghdGhpcy5lKSB7XG4gICAgICAgICAgICB0aGlzLmUgPSBlbGVtZW50KHRhcmdldC5ub2RlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnQgPSB0YXJnZXQ7XG4gICAgICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pKGFuY2hvcik7XG4gICAgfVxuICAgIGgoaHRtbCkge1xuICAgICAgICB0aGlzLmUuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgdGhpcy5uID0gQXJyYXkuZnJvbSh0aGlzLmUuY2hpbGROb2Rlcyk7XG4gICAgfVxuICAgIGkoYW5jaG9yKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpbnNlcnQodGhpcy50LCB0aGlzLm5baV0sIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcChodG1sKSB7XG4gICAgICAgIHRoaXMuZCgpO1xuICAgICAgICB0aGlzLmgoaHRtbCk7XG4gICAgICAgIHRoaXMuaSh0aGlzLmEpO1xuICAgIH1cbiAgICBkKCkge1xuICAgICAgICB0aGlzLm4uZm9yRWFjaChkZXRhY2gpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGF0dHJpYnV0ZV90b19vYmplY3QoYXR0cmlidXRlcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgcmVzdWx0W2F0dHJpYnV0ZS5uYW1lXSA9IGF0dHJpYnV0ZS52YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMoZWxlbWVudCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgIHJlc3VsdFtub2RlLnNsb3QgfHwgJ2RlZmF1bHQnXSA9IHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuY29uc3QgYWN0aXZlX2RvY3MgPSBuZXcgU2V0KCk7XG5sZXQgYWN0aXZlID0gMDtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrc2t5YXBwL3N0cmluZy1oYXNoL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5mdW5jdGlvbiBoYXNoKHN0cikge1xuICAgIGxldCBoYXNoID0gNTM4MTtcbiAgICBsZXQgaSA9IHN0ci5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGhhc2ggPj4+IDA7XG59XG5mdW5jdGlvbiBjcmVhdGVfcnVsZShub2RlLCBhLCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2UsIGZuLCB1aWQgPSAwKSB7XG4gICAgY29uc3Qgc3RlcCA9IDE2LjY2NiAvIGR1cmF0aW9uO1xuICAgIGxldCBrZXlmcmFtZXMgPSAne1xcbic7XG4gICAgZm9yIChsZXQgcCA9IDA7IHAgPD0gMTsgcCArPSBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhICsgKGIgLSBhKSAqIGVhc2UocCk7XG4gICAgICAgIGtleWZyYW1lcyArPSBwICogMTAwICsgYCV7JHtmbih0LCAxIC0gdCl9fVxcbmA7XG4gICAgfVxuICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXMgKyBgMTAwJSB7JHtmbihiLCAxIC0gYil9fVxcbn1gO1xuICAgIGNvbnN0IG5hbWUgPSBgX19zdmVsdGVfJHtoYXNoKHJ1bGUpfV8ke3VpZH1gO1xuICAgIGNvbnN0IGRvYyA9IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICBhY3RpdmVfZG9jcy5hZGQoZG9jKTtcbiAgICBjb25zdCBzdHlsZXNoZWV0ID0gZG9jLl9fc3ZlbHRlX3N0eWxlc2hlZXQgfHwgKGRvYy5fX3N2ZWx0ZV9zdHlsZXNoZWV0ID0gZG9jLmhlYWQuYXBwZW5kQ2hpbGQoZWxlbWVudCgnc3R5bGUnKSkuc2hlZXQpO1xuICAgIGNvbnN0IGN1cnJlbnRfcnVsZXMgPSBkb2MuX19zdmVsdGVfcnVsZXMgfHwgKGRvYy5fX3N2ZWx0ZV9ydWxlcyA9IHt9KTtcbiAgICBpZiAoIWN1cnJlbnRfcnVsZXNbbmFtZV0pIHtcbiAgICAgICAgY3VycmVudF9ydWxlc1tuYW1lXSA9IHRydWU7XG4gICAgICAgIHN0eWxlc2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke25hbWV9ICR7cnVsZX1gLCBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgfVxuICAgIGNvbnN0IGFuaW1hdGlvbiA9IG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnO1xuICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gYCR7YW5pbWF0aW9uID8gYCR7YW5pbWF0aW9ufSwgYCA6ICcnfSR7bmFtZX0gJHtkdXJhdGlvbn1tcyBsaW5lYXIgJHtkZWxheX1tcyAxIGJvdGhgO1xuICAgIGFjdGl2ZSArPSAxO1xuICAgIHJldHVybiBuYW1lO1xufVxuZnVuY3Rpb24gZGVsZXRlX3J1bGUobm9kZSwgbmFtZSkge1xuICAgIGNvbnN0IHByZXZpb3VzID0gKG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnKS5zcGxpdCgnLCAnKTtcbiAgICBjb25zdCBuZXh0ID0gcHJldmlvdXMuZmlsdGVyKG5hbWVcbiAgICAgICAgPyBhbmltID0+IGFuaW0uaW5kZXhPZihuYW1lKSA8IDAgLy8gcmVtb3ZlIHNwZWNpZmljIGFuaW1hdGlvblxuICAgICAgICA6IGFuaW0gPT4gYW5pbS5pbmRleE9mKCdfX3N2ZWx0ZScpID09PSAtMSAvLyByZW1vdmUgYWxsIFN2ZWx0ZSBhbmltYXRpb25zXG4gICAgKTtcbiAgICBjb25zdCBkZWxldGVkID0gcHJldmlvdXMubGVuZ3RoIC0gbmV4dC5sZW5ndGg7XG4gICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBuZXh0LmpvaW4oJywgJyk7XG4gICAgICAgIGFjdGl2ZSAtPSBkZWxldGVkO1xuICAgICAgICBpZiAoIWFjdGl2ZSlcbiAgICAgICAgICAgIGNsZWFyX3J1bGVzKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2xlYXJfcnVsZXMoKSB7XG4gICAgcmFmKCgpID0+IHtcbiAgICAgICAgaWYgKGFjdGl2ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgYWN0aXZlX2RvY3MuZm9yRWFjaChkb2MgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3R5bGVzaGVldCA9IGRvYy5fX3N2ZWx0ZV9zdHlsZXNoZWV0O1xuICAgICAgICAgICAgbGV0IGkgPSBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICAgICAgc3R5bGVzaGVldC5kZWxldGVSdWxlKGkpO1xuICAgICAgICAgICAgZG9jLl9fc3ZlbHRlX3J1bGVzID0ge307XG4gICAgICAgIH0pO1xuICAgICAgICBhY3RpdmVfZG9jcy5jbGVhcigpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVfYW5pbWF0aW9uKG5vZGUsIGZyb20sIGZuLCBwYXJhbXMpIHtcbiAgICBpZiAoIWZyb20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHRvID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoZnJvbS5sZWZ0ID09PSB0by5sZWZ0ICYmIGZyb20ucmlnaHQgPT09IHRvLnJpZ2h0ICYmIGZyb20udG9wID09PSB0by50b3AgJiYgZnJvbS5ib3R0b20gPT09IHRvLmJvdHRvbSlcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgXG4gICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBzaG91bGQgdGhpcyBiZSBzZXBhcmF0ZWQgZnJvbSBkZXN0cnVjdHVyaW5nPyBPciBzdGFydC9lbmQgYWRkZWQgdG8gcHVibGljIGFwaSBhbmQgZG9jdW1lbnRhdGlvbj9cbiAgICBzdGFydDogc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzpcbiAgICBlbmQgPSBzdGFydF90aW1lICsgZHVyYXRpb24sIHRpY2sgPSBub29wLCBjc3MgfSA9IGZuKG5vZGUsIHsgZnJvbSwgdG8gfSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICBsZXQgbmFtZTtcbiAgICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVsYXkpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBuYW1lKTtcbiAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgIGlmICghc3RhcnRlZCAmJiBub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQgJiYgbm93ID49IGVuZCkge1xuICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgIHN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnRlZCkge1xuICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHN0YXJ0X3RpbWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gMCArIDEgKiBlYXNpbmcocCAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIHN0YXJ0KCk7XG4gICAgdGljaygwLCAxKTtcbiAgICByZXR1cm4gc3RvcDtcbn1cbmZ1bmN0aW9uIGZpeF9wb3NpdGlvbihub2RlKSB7XG4gICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgIGlmIChzdHlsZS5wb3NpdGlvbiAhPT0gJ2Fic29sdXRlJyAmJiBzdHlsZS5wb3NpdGlvbiAhPT0gJ2ZpeGVkJykge1xuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHN0eWxlO1xuICAgICAgICBjb25zdCBhID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIG5vZGUuc3R5bGUud2lkdGggPSB3aWR0aDtcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIGFkZF90cmFuc2Zvcm0obm9kZSwgYSk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkX3RyYW5zZm9ybShub2RlLCBhKSB7XG4gICAgY29uc3QgYiA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGEubGVmdCAhPT0gYi5sZWZ0IHx8IGEudG9wICE9PSBiLnRvcCkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IHN0eWxlLnRyYW5zZm9ybSA9PT0gJ25vbmUnID8gJycgOiBzdHlsZS50cmFuc2Zvcm07XG4gICAgICAgIG5vZGUuc3R5bGUudHJhbnNmb3JtID0gYCR7dHJhbnNmb3JtfSB0cmFuc2xhdGUoJHthLmxlZnQgLSBiLmxlZnR9cHgsICR7YS50b3AgLSBiLnRvcH1weClgO1xuICAgIH1cbn1cblxubGV0IGN1cnJlbnRfY29tcG9uZW50O1xuZnVuY3Rpb24gc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCkge1xuICAgIGN1cnJlbnRfY29tcG9uZW50ID0gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkge1xuICAgIGlmICghY3VycmVudF9jb21wb25lbnQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRnVuY3Rpb24gY2FsbGVkIG91dHNpZGUgY29tcG9uZW50IGluaXRpYWxpemF0aW9uJyk7XG4gICAgcmV0dXJuIGN1cnJlbnRfY29tcG9uZW50O1xufVxuZnVuY3Rpb24gYmVmb3JlVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYmVmb3JlX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uTW91bnQoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5vbl9tb3VudC5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFmdGVyVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYWZ0ZXJfdXBkYXRlLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gb25EZXN0cm95KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fZGVzdHJveS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpIHtcbiAgICBjb25zdCBjb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICByZXR1cm4gKHR5cGUsIGRldGFpbCkgPT4ge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSBjb21wb25lbnQuJCQuY2FsbGJhY2tzW3R5cGVdO1xuICAgICAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgICAgICAvLyBUT0RPIGFyZSB0aGVyZSBzaXR1YXRpb25zIHdoZXJlIGV2ZW50cyBjb3VsZCBiZSBkaXNwYXRjaGVkXG4gICAgICAgICAgICAvLyBpbiBhIHNlcnZlciAobm9uLURPTSkgZW52aXJvbm1lbnQ/XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwpO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbChjb21wb25lbnQsIGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNldENvbnRleHQoa2V5LCBjb250ZXh0KSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5zZXQoa2V5LCBjb250ZXh0KTtcbn1cbmZ1bmN0aW9uIGdldENvbnRleHQoa2V5KSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuZ2V0KGtleSk7XG59XG5mdW5jdGlvbiBoYXNDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmhhcyhrZXkpO1xufVxuLy8gVE9ETyBmaWd1cmUgb3V0IGlmIHdlIHN0aWxsIHdhbnQgdG8gc3VwcG9ydFxuLy8gc2hvcnRoYW5kIGV2ZW50cywgb3IgaWYgd2Ugd2FudCB0byBpbXBsZW1lbnRcbi8vIGEgcmVhbCBidWJibGluZyBtZWNoYW5pc21cbmZ1bmN0aW9uIGJ1YmJsZShjb21wb25lbnQsIGV2ZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4gZm4oZXZlbnQpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRpcnR5X2NvbXBvbmVudHMgPSBbXTtcbmNvbnN0IGludHJvcyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcbmNvbnN0IGJpbmRpbmdfY2FsbGJhY2tzID0gW107XG5jb25zdCByZW5kZXJfY2FsbGJhY2tzID0gW107XG5jb25zdCBmbHVzaF9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlc29sdmVkX3Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbmxldCB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzY2hlZHVsZV91cGRhdGUoKSB7XG4gICAgaWYgKCF1cGRhdGVfc2NoZWR1bGVkKSB7XG4gICAgICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlZF9wcm9taXNlLnRoZW4oZmx1c2gpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRpY2soKSB7XG4gICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgcmV0dXJuIHJlc29sdmVkX3Byb21pc2U7XG59XG5mdW5jdGlvbiBhZGRfcmVuZGVyX2NhbGxiYWNrKGZuKSB7XG4gICAgcmVuZGVyX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFkZF9mbHVzaF9jYWxsYmFjayhmbikge1xuICAgIGZsdXNoX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmxldCBmbHVzaGluZyA9IGZhbHNlO1xuY29uc3Qgc2Vlbl9jYWxsYmFja3MgPSBuZXcgU2V0KCk7XG5mdW5jdGlvbiBmbHVzaCgpIHtcbiAgICBpZiAoZmx1c2hpbmcpXG4gICAgICAgIHJldHVybjtcbiAgICBmbHVzaGluZyA9IHRydWU7XG4gICAgZG8ge1xuICAgICAgICAvLyBmaXJzdCwgY2FsbCBiZWZvcmVVcGRhdGUgZnVuY3Rpb25zXG4gICAgICAgIC8vIGFuZCB1cGRhdGUgY29tcG9uZW50c1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGRpcnR5X2NvbXBvbmVudHNbaV07XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShjb21wb25lbnQuJCQpO1xuICAgICAgICB9XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5sZW5ndGggPSAwO1xuICAgICAgICB3aGlsZSAoYmluZGluZ19jYWxsYmFja3MubGVuZ3RoKVxuICAgICAgICAgICAgYmluZGluZ19jYWxsYmFja3MucG9wKCkoKTtcbiAgICAgICAgLy8gdGhlbiwgb25jZSBjb21wb25lbnRzIGFyZSB1cGRhdGVkLCBjYWxsXG4gICAgICAgIC8vIGFmdGVyVXBkYXRlIGZ1bmN0aW9ucy4gVGhpcyBtYXkgY2F1c2VcbiAgICAgICAgLy8gc3Vic2VxdWVudCB1cGRhdGVzLi4uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSByZW5kZXJfY2FsbGJhY2tzW2ldO1xuICAgICAgICAgICAgaWYgKCFzZWVuX2NhbGxiYWNrcy5oYXMoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgICAgLy8gLi4uc28gZ3VhcmQgYWdhaW5zdCBpbmZpbml0ZSBsb29wc1xuICAgICAgICAgICAgICAgIHNlZW5fY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aCA9IDA7XG4gICAgfSB3aGlsZSAoZGlydHlfY29tcG9uZW50cy5sZW5ndGgpO1xuICAgIHdoaWxlIChmbHVzaF9jYWxsYmFja3MubGVuZ3RoKSB7XG4gICAgICAgIGZsdXNoX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgIH1cbiAgICB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG4gICAgZmx1c2hpbmcgPSBmYWxzZTtcbiAgICBzZWVuX2NhbGxiYWNrcy5jbGVhcigpO1xufVxuZnVuY3Rpb24gdXBkYXRlKCQkKSB7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgICQkLnVwZGF0ZSgpO1xuICAgICAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgICAgICBjb25zdCBkaXJ0eSA9ICQkLmRpcnR5O1xuICAgICAgICAkJC5kaXJ0eSA9IFstMV07XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LnAoJCQuY3R4LCBkaXJ0eSk7XG4gICAgICAgICQkLmFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xuICAgIH1cbn1cblxubGV0IHByb21pc2U7XG5mdW5jdGlvbiB3YWl0KCkge1xuICAgIGlmICghcHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gZGlzcGF0Y2gobm9kZSwgZGlyZWN0aW9uLCBraW5kKSB7XG4gICAgbm9kZS5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudChgJHtkaXJlY3Rpb24gPyAnaW50cm8nIDogJ291dHJvJ30ke2tpbmR9YCkpO1xufVxuY29uc3Qgb3V0cm9pbmcgPSBuZXcgU2V0KCk7XG5sZXQgb3V0cm9zO1xuZnVuY3Rpb24gZ3JvdXBfb3V0cm9zKCkge1xuICAgIG91dHJvcyA9IHtcbiAgICAgICAgcjogMCxcbiAgICAgICAgYzogW10sXG4gICAgICAgIHA6IG91dHJvcyAvLyBwYXJlbnQgZ3JvdXBcbiAgICB9O1xufVxuZnVuY3Rpb24gY2hlY2tfb3V0cm9zKCkge1xuICAgIGlmICghb3V0cm9zLnIpIHtcbiAgICAgICAgcnVuX2FsbChvdXRyb3MuYyk7XG4gICAgfVxuICAgIG91dHJvcyA9IG91dHJvcy5wO1xufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9pbihibG9jaywgbG9jYWwpIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2suaSkge1xuICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICBibG9jay5pKGxvY2FsKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX291dChibG9jaywgbG9jYWwsIGRldGFjaCwgY2FsbGJhY2spIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2subykge1xuICAgICAgICBpZiAob3V0cm9pbmcuaGFzKGJsb2NrKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb3V0cm9pbmcuYWRkKGJsb2NrKTtcbiAgICAgICAgb3V0cm9zLmMucHVzaCgoKSA9PiB7XG4gICAgICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRldGFjaClcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suZCgxKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2subyhsb2NhbCk7XG4gICAgfVxufVxuY29uc3QgbnVsbF90cmFuc2l0aW9uID0geyBkdXJhdGlvbjogMCB9O1xuZnVuY3Rpb24gY3JlYXRlX2luX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gZmFsc2U7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCB1aWQgPSAwO1xuICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MsIHVpZCsrKTtcbiAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBpZiAodGFzaylcbiAgICAgICAgICAgIHRhc2suYWJvcnQoKTtcbiAgICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ3N0YXJ0JykpO1xuICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHRydWUsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGFydCgpIHtcbiAgICAgICAgICAgIGlmIChzdGFydGVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbihnbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbnZhbGlkYXRlKCkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX291dF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGNvbnN0IGdyb3VwID0gb3V0cm9zO1xuICAgIGdyb3VwLnIgKz0gMTtcbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMSwgMCwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ3N0YXJ0JykpO1xuICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEtLWdyb3VwLnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCByZXN1bHQgaW4gYGVuZCgpYCBiZWluZyBjYWxsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkb24ndCBuZWVkIHRvIGNsZWFuIHVwIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwoZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSAtIHQsIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICBnbygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGdvKCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGVuZChyZXNldCkge1xuICAgICAgICAgICAgaWYgKHJlc2V0ICYmIGNvbmZpZy50aWNrKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnRpY2soMSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMsIGludHJvKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHQgPSBpbnRybyA/IDAgOiAxO1xuICAgIGxldCBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBhbmltYXRpb25fbmFtZSA9IG51bGw7XG4gICAgZnVuY3Rpb24gY2xlYXJfYW5pbWF0aW9uKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluaXQocHJvZ3JhbSwgZHVyYXRpb24pIHtcbiAgICAgICAgY29uc3QgZCA9IHByb2dyYW0uYiAtIHQ7XG4gICAgICAgIGR1cmF0aW9uICo9IE1hdGguYWJzKGQpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYTogdCxcbiAgICAgICAgICAgIGI6IHByb2dyYW0uYixcbiAgICAgICAgICAgIGQsXG4gICAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICAgIHN0YXJ0OiBwcm9ncmFtLnN0YXJ0LFxuICAgICAgICAgICAgZW5kOiBwcm9ncmFtLnN0YXJ0ICsgZHVyYXRpb24sXG4gICAgICAgICAgICBncm91cDogcHJvZ3JhbS5ncm91cFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbyhiKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGNvbnN0IHByb2dyYW0gPSB7XG4gICAgICAgICAgICBzdGFydDogbm93KCkgKyBkZWxheSxcbiAgICAgICAgICAgIGJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCFiKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgcHJvZ3JhbS5ncm91cCA9IG91dHJvcztcbiAgICAgICAgICAgIG91dHJvcy5yICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IHByb2dyYW07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGludHJvLCBhbmQgdGhlcmUncyBhIGRlbGF5LCB3ZSBuZWVkIHRvIGRvXG4gICAgICAgICAgICAvLyBhbiBpbml0aWFsIHRpY2sgYW5kL29yIGFwcGx5IENTUyBhbmltYXRpb24gaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIGIsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGIpXG4gICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBiLCAnc3RhcnQnKSk7XG4gICAgICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdfcHJvZ3JhbSAmJiBub3cgPiBwZW5kaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwZW5kaW5nX3Byb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdzdGFydCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgcnVubmluZ19wcm9ncmFtLmIsIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbiwgMCwgZWFzaW5nLCBjb25maWcuY3NzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLmVuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0ID0gcnVubmluZ19wcm9ncmFtLmIsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtLmIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW50cm8g4oCUIHdlIGNhbiB0aWR5IHVwIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3V0cm8g4oCUIG5lZWRzIHRvIGJlIGNvb3JkaW5hdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghLS1ydW5uaW5nX3Byb2dyYW0uZ3JvdXAucilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwocnVubmluZ19wcm9ncmFtLmdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHJ1bm5pbmdfcHJvZ3JhbS5zdGFydDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBydW5uaW5nX3Byb2dyYW0uYSArIHJ1bm5pbmdfcHJvZ3JhbS5kICogZWFzaW5nKHAgLyBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKHJ1bm5pbmdfcHJvZ3JhbSB8fCBwZW5kaW5nX3Byb2dyYW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcnVuKGIpIHtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBoYW5kbGVfcHJvbWlzZShwcm9taXNlLCBpbmZvKSB7XG4gICAgY29uc3QgdG9rZW4gPSBpbmZvLnRva2VuID0ge307XG4gICAgZnVuY3Rpb24gdXBkYXRlKHR5cGUsIGluZGV4LCBrZXksIHZhbHVlKSB7XG4gICAgICAgIGlmIChpbmZvLnRva2VuICE9PSB0b2tlbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHZhbHVlO1xuICAgICAgICBsZXQgY2hpbGRfY3R4ID0gaW5mby5jdHg7XG4gICAgICAgIGlmIChrZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2hpbGRfY3R4ID0gY2hpbGRfY3R4LnNsaWNlKCk7XG4gICAgICAgICAgICBjaGlsZF9jdHhba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJsb2NrID0gdHlwZSAmJiAoaW5mby5jdXJyZW50ID0gdHlwZSkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IG5lZWRzX2ZsdXNoID0gZmFsc2U7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrKSB7XG4gICAgICAgICAgICBpZiAoaW5mby5ibG9ja3MpIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrcy5mb3JFYWNoKChibG9jaywgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaW5kZXggJiYgYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mby5ibG9ja3NbaV0gPT09IGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzW2ldID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrX291dHJvcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbmZvLmJsb2NrLmQoMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBibG9jay5jKCk7XG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGJsb2NrLCAxKTtcbiAgICAgICAgICAgIGJsb2NrLm0oaW5mby5tb3VudCgpLCBpbmZvLmFuY2hvcik7XG4gICAgICAgICAgICBuZWVkc19mbHVzaCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5ibG9jayA9IGJsb2NrO1xuICAgICAgICBpZiAoaW5mby5ibG9ja3MpXG4gICAgICAgICAgICBpbmZvLmJsb2Nrc1tpbmRleF0gPSBibG9jaztcbiAgICAgICAgaWYgKG5lZWRzX2ZsdXNoKSB7XG4gICAgICAgICAgICBmbHVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChpc19wcm9taXNlKHByb21pc2UpKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgICAgIHByb21pc2UudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY3VycmVudF9jb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGluZm8uY2F0Y2gsIDIsIGluZm8uZXJyb3IsIGVycm9yKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgICAgIGlmICghaW5mby5oYXNDYXRjaCkge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gaWYgd2UgcHJldmlvdXNseSBoYWQgYSB0aGVuL2NhdGNoIGJsb2NrLCBkZXN0cm95IGl0XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8ucGVuZGluZykge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8ucGVuZGluZywgMCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby50aGVuKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCBwcm9taXNlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSBwcm9taXNlO1xuICAgIH1cbn1cblxuY29uc3QgZ2xvYmFscyA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgID8gd2luZG93XG4gICAgOiB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBnbG9iYWxUaGlzXG4gICAgICAgIDogZ2xvYmFsKTtcblxuZnVuY3Rpb24gZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZCgxKTtcbiAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG59XG5mdW5jdGlvbiBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZml4X2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9rZXllZF9lYWNoKG9sZF9ibG9ja3MsIGRpcnR5LCBnZXRfa2V5LCBkeW5hbWljLCBjdHgsIGxpc3QsIGxvb2t1cCwgbm9kZSwgZGVzdHJveSwgY3JlYXRlX2VhY2hfYmxvY2ssIG5leHQsIGdldF9jb250ZXh0KSB7XG4gICAgbGV0IG8gPSBvbGRfYmxvY2tzLmxlbmd0aDtcbiAgICBsZXQgbiA9IGxpc3QubGVuZ3RoO1xuICAgIGxldCBpID0gbztcbiAgICBjb25zdCBvbGRfaW5kZXhlcyA9IHt9O1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIG9sZF9pbmRleGVzW29sZF9ibG9ja3NbaV0ua2V5XSA9IGk7XG4gICAgY29uc3QgbmV3X2Jsb2NrcyA9IFtdO1xuICAgIGNvbnN0IG5ld19sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgY29uc3QgZGVsdGFzID0gbmV3IE1hcCgpO1xuICAgIGkgPSBuO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRfY3R4ID0gZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKTtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgYmxvY2sgPSBsb29rdXAuZ2V0KGtleSk7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gY3JlYXRlX2VhY2hfYmxvY2soa2V5LCBjaGlsZF9jdHgpO1xuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5bmFtaWMpIHtcbiAgICAgICAgICAgIGJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2xvb2t1cC5zZXQoa2V5LCBuZXdfYmxvY2tzW2ldID0gYmxvY2spO1xuICAgICAgICBpZiAoa2V5IGluIG9sZF9pbmRleGVzKVxuICAgICAgICAgICAgZGVsdGFzLnNldChrZXksIE1hdGguYWJzKGkgLSBvbGRfaW5kZXhlc1trZXldKSk7XG4gICAgfVxuICAgIGNvbnN0IHdpbGxfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBjb25zdCBkaWRfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBpbnNlcnQoYmxvY2spIHtcbiAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgIGJsb2NrLm0obm9kZSwgbmV4dCk7XG4gICAgICAgIGxvb2t1cC5zZXQoYmxvY2sua2V5LCBibG9jayk7XG4gICAgICAgIG5leHQgPSBibG9jay5maXJzdDtcbiAgICAgICAgbi0tO1xuICAgIH1cbiAgICB3aGlsZSAobyAmJiBuKSB7XG4gICAgICAgIGNvbnN0IG5ld19ibG9jayA9IG5ld19ibG9ja3NbbiAtIDFdO1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW28gLSAxXTtcbiAgICAgICAgY29uc3QgbmV3X2tleSA9IG5ld19ibG9jay5rZXk7XG4gICAgICAgIGNvbnN0IG9sZF9rZXkgPSBvbGRfYmxvY2sua2V5O1xuICAgICAgICBpZiAobmV3X2Jsb2NrID09PSBvbGRfYmxvY2spIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIG5leHQgPSBuZXdfYmxvY2suZmlyc3Q7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgICAgICBuLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJsb2NrXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbG9va3VwLmhhcyhuZXdfa2V5KSB8fCB3aWxsX21vdmUuaGFzKG5ld19rZXkpKSB7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaWRfbW92ZS5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZWx0YXMuZ2V0KG5ld19rZXkpID4gZGVsdGFzLmdldChvbGRfa2V5KSkge1xuICAgICAgICAgICAgZGlkX21vdmUuYWRkKG5ld19rZXkpO1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsX21vdmUuYWRkKG9sZF9rZXkpO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChvLS0pIHtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvXTtcbiAgICAgICAgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfYmxvY2sua2V5KSlcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgIH1cbiAgICB3aGlsZSAobilcbiAgICAgICAgaW5zZXJ0KG5ld19ibG9ja3NbbiAtIDFdKTtcbiAgICByZXR1cm4gbmV3X2Jsb2Nrcztcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfa2V5cyhjdHgsIGxpc3QsIGdldF9jb250ZXh0LCBnZXRfa2V5KSB7XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpKTtcbiAgICAgICAgaWYgKGtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGhhdmUgZHVwbGljYXRlIGtleXMgaW4gYSBrZXllZCBlYWNoJyk7XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5hZGQoa2V5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9zcHJlYWRfdXBkYXRlKGxldmVscywgdXBkYXRlcykge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHt9O1xuICAgIGNvbnN0IHRvX251bGxfb3V0ID0ge307XG4gICAgY29uc3QgYWNjb3VudGVkX2ZvciA9IHsgJCRzY29wZTogMSB9O1xuICAgIGxldCBpID0gbGV2ZWxzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IG8gPSBsZXZlbHNbaV07XG4gICAgICAgIGNvbnN0IG4gPSB1cGRhdGVzW2ldO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBuKSlcbiAgICAgICAgICAgICAgICAgICAgdG9fbnVsbF9vdXRba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50ZWRfZm9yW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlW2tleV0gPSBuW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV2ZWxzW2ldID0gbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRvX251bGxfb3V0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiB1cGRhdGUpKVxuICAgICAgICAgICAgdXBkYXRlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGU7XG59XG5mdW5jdGlvbiBnZXRfc3ByZWFkX29iamVjdChzcHJlYWRfcHJvcHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHNwcmVhZF9wcm9wcyA9PT0gJ29iamVjdCcgJiYgc3ByZWFkX3Byb3BzICE9PSBudWxsID8gc3ByZWFkX3Byb3BzIDoge307XG59XG5cbi8vIHNvdXJjZTogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvaW5kaWNlcy5odG1sXG5jb25zdCBib29sZWFuX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KFtcbiAgICAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAnYWxsb3dwYXltZW50cmVxdWVzdCcsXG4gICAgJ2FzeW5jJyxcbiAgICAnYXV0b2ZvY3VzJyxcbiAgICAnYXV0b3BsYXknLFxuICAgICdjaGVja2VkJyxcbiAgICAnY29udHJvbHMnLFxuICAgICdkZWZhdWx0JyxcbiAgICAnZGVmZXInLFxuICAgICdkaXNhYmxlZCcsXG4gICAgJ2Zvcm1ub3ZhbGlkYXRlJyxcbiAgICAnaGlkZGVuJyxcbiAgICAnaXNtYXAnLFxuICAgICdsb29wJyxcbiAgICAnbXVsdGlwbGUnLFxuICAgICdtdXRlZCcsXG4gICAgJ25vbW9kdWxlJyxcbiAgICAnbm92YWxpZGF0ZScsXG4gICAgJ29wZW4nLFxuICAgICdwbGF5c2lubGluZScsXG4gICAgJ3JlYWRvbmx5JyxcbiAgICAncmVxdWlyZWQnLFxuICAgICdyZXZlcnNlZCcsXG4gICAgJ3NlbGVjdGVkJ1xuXSk7XG5cbmNvbnN0IGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyID0gL1tcXHMnXCI+Lz1cXHV7RkREMH0tXFx1e0ZERUZ9XFx1e0ZGRkV9XFx1e0ZGRkZ9XFx1ezFGRkZFfVxcdXsxRkZGRn1cXHV7MkZGRkV9XFx1ezJGRkZGfVxcdXszRkZGRX1cXHV7M0ZGRkZ9XFx1ezRGRkZFfVxcdXs0RkZGRn1cXHV7NUZGRkV9XFx1ezVGRkZGfVxcdXs2RkZGRX1cXHV7NkZGRkZ9XFx1ezdGRkZFfVxcdXs3RkZGRn1cXHV7OEZGRkV9XFx1ezhGRkZGfVxcdXs5RkZGRX1cXHV7OUZGRkZ9XFx1e0FGRkZFfVxcdXtBRkZGRn1cXHV7QkZGRkV9XFx1e0JGRkZGfVxcdXtDRkZGRX1cXHV7Q0ZGRkZ9XFx1e0RGRkZFfVxcdXtERkZGRn1cXHV7RUZGRkV9XFx1e0VGRkZGfVxcdXtGRkZGRX1cXHV7RkZGRkZ9XFx1ezEwRkZGRX1cXHV7MTBGRkZGfV0vdTtcbi8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMlxuLy8gaHR0cHM6Ly9pbmZyYS5zcGVjLndoYXR3Zy5vcmcvI25vbmNoYXJhY3RlclxuZnVuY3Rpb24gc3ByZWFkKGFyZ3MsIGNsYXNzZXNfdG9fYWRkKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IE9iamVjdC5hc3NpZ24oe30sIC4uLmFyZ3MpO1xuICAgIGlmIChjbGFzc2VzX3RvX2FkZCkge1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzcyA9PSBudWxsKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3Nlc190b19hZGQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9ICcgJyArIGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBzdHIgPSAnJztcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBpZiAoaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIudGVzdChuYW1lKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUgPT09IHRydWUpXG4gICAgICAgICAgICBzdHIgKz0gJyAnICsgbmFtZTtcbiAgICAgICAgZWxzZSBpZiAoYm9vbGVhbl9hdHRyaWJ1dGVzLmhhcyhuYW1lLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgc3RyICs9IGAgJHtuYW1lfT1cIiR7U3RyaW5nKHZhbHVlKS5yZXBsYWNlKC9cIi9nLCAnJiMzNDsnKS5yZXBsYWNlKC8nL2csICcmIzM5OycpfVwiYDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzdHI7XG59XG5jb25zdCBlc2NhcGVkID0ge1xuICAgICdcIic6ICcmcXVvdDsnLFxuICAgIFwiJ1wiOiAnJiMzOTsnLFxuICAgICcmJzogJyZhbXA7JyxcbiAgICAnPCc6ICcmbHQ7JyxcbiAgICAnPic6ICcmZ3Q7J1xufTtcbmZ1bmN0aW9uIGVzY2FwZShodG1sKSB7XG4gICAgcmV0dXJuIFN0cmluZyhodG1sKS5yZXBsYWNlKC9bXCInJjw+XS9nLCBtYXRjaCA9PiBlc2NhcGVkW21hdGNoXSk7XG59XG5mdW5jdGlvbiBlYWNoKGl0ZW1zLCBmbikge1xuICAgIGxldCBzdHIgPSAnJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHN0ciArPSBmbihpdGVtc1tpXSwgaSk7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5jb25zdCBtaXNzaW5nX2NvbXBvbmVudCA9IHtcbiAgICAkJHJlbmRlcjogKCkgPT4gJydcbn07XG5mdW5jdGlvbiB2YWxpZGF0ZV9jb21wb25lbnQoY29tcG9uZW50LCBuYW1lKSB7XG4gICAgaWYgKCFjb21wb25lbnQgfHwgIWNvbXBvbmVudC4kJHJlbmRlcikge1xuICAgICAgICBpZiAobmFtZSA9PT0gJ3N2ZWx0ZTpjb21wb25lbnQnKVxuICAgICAgICAgICAgbmFtZSArPSAnIHRoaXM9ey4uLn0nO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDwke25hbWV9PiBpcyBub3QgYSB2YWxpZCBTU1IgY29tcG9uZW50LiBZb3UgbWF5IG5lZWQgdG8gcmV2aWV3IHlvdXIgYnVpbGQgY29uZmlnIHRvIGVuc3VyZSB0aGF0IGRlcGVuZGVuY2llcyBhcmUgY29tcGlsZWQsIHJhdGhlciB0aGFuIGltcG9ydGVkIGFzIHByZS1jb21waWxlZCBtb2R1bGVzYCk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnQ7XG59XG5mdW5jdGlvbiBkZWJ1ZyhmaWxlLCBsaW5lLCBjb2x1bW4sIHZhbHVlcykge1xuICAgIGNvbnNvbGUubG9nKGB7QGRlYnVnfSAke2ZpbGUgPyBmaWxlICsgJyAnIDogJyd9KCR7bGluZX06JHtjb2x1bW59KWApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZyh2YWx1ZXMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICByZXR1cm4gJyc7XG59XG5sZXQgb25fZGVzdHJveTtcbmZ1bmN0aW9uIGNyZWF0ZV9zc3JfY29tcG9uZW50KGZuKSB7XG4gICAgZnVuY3Rpb24gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKSB7XG4gICAgICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICAgICAgY29uc3QgJCQgPSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LFxuICAgICAgICAgICAgY29udGV4dDogbmV3IE1hcChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pLFxuICAgICAgICAgICAgLy8gdGhlc2Ugd2lsbCBiZSBpbW1lZGlhdGVseSBkaXNjYXJkZWRcbiAgICAgICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHsgJCQgfSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBmbihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMpO1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXI6IChwcm9wcyA9IHt9LCBvcHRpb25zID0ge30pID0+IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHsgdGl0bGU6ICcnLCBoZWFkOiAnJywgY3NzOiBuZXcgU2V0KCkgfTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCB7fSwgb3B0aW9ucyk7XG4gICAgICAgICAgICBydW5fYWxsKG9uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBodG1sLFxuICAgICAgICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBBcnJheS5mcm9tKHJlc3VsdC5jc3MpLm1hcChjc3MgPT4gY3NzLmNvZGUpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG51bGwgLy8gVE9ET1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGVhZDogcmVzdWx0LnRpdGxlICsgcmVzdWx0LmhlYWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgICQkcmVuZGVyXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGFkZF9hdHRyaWJ1dGUobmFtZSwgdmFsdWUsIGJvb2xlYW4pIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCAoYm9vbGVhbiAmJiAhdmFsdWUpKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgcmV0dXJuIGAgJHtuYW1lfSR7dmFsdWUgPT09IHRydWUgPyAnJyA6IGA9JHt0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gSlNPTi5zdHJpbmdpZnkoZXNjYXBlKHZhbHVlKSkgOiBgXCIke3ZhbHVlfVwiYH1gfWA7XG59XG5mdW5jdGlvbiBhZGRfY2xhc3NlcyhjbGFzc2VzKSB7XG4gICAgcmV0dXJuIGNsYXNzZXMgPyBgIGNsYXNzPVwiJHtjbGFzc2VzfVwiYCA6ICcnO1xufVxuXG5mdW5jdGlvbiBiaW5kKGNvbXBvbmVudCwgbmFtZSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBpbmRleCA9IGNvbXBvbmVudC4kJC5wcm9wc1tuYW1lXTtcbiAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb21wb25lbnQuJCQuYm91bmRbaW5kZXhdID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrKGNvbXBvbmVudC4kJC5jdHhbaW5kZXhdKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVfY29tcG9uZW50KGJsb2NrKSB7XG4gICAgYmxvY2sgJiYgYmxvY2suYygpO1xufVxuZnVuY3Rpb24gY2xhaW1fY29tcG9uZW50KGJsb2NrLCBwYXJlbnRfbm9kZXMpIHtcbiAgICBibG9jayAmJiBibG9jay5sKHBhcmVudF9ub2Rlcyk7XG59XG5mdW5jdGlvbiBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCB0YXJnZXQsIGFuY2hvcikge1xuICAgIGNvbnN0IHsgZnJhZ21lbnQsIG9uX21vdW50LCBvbl9kZXN0cm95LCBhZnRlcl91cGRhdGUgfSA9IGNvbXBvbmVudC4kJDtcbiAgICBmcmFnbWVudCAmJiBmcmFnbWVudC5tKHRhcmdldCwgYW5jaG9yKTtcbiAgICAvLyBvbk1vdW50IGhhcHBlbnMgYmVmb3JlIHRoZSBpbml0aWFsIGFmdGVyVXBkYXRlXG4gICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld19vbl9kZXN0cm95ID0gb25fbW91bnQubWFwKHJ1bikuZmlsdGVyKGlzX2Z1bmN0aW9uKTtcbiAgICAgICAgaWYgKG9uX2Rlc3Ryb3kpIHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kucHVzaCguLi5uZXdfb25fZGVzdHJveSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBFZGdlIGNhc2UgLSBjb21wb25lbnQgd2FzIGRlc3Ryb3llZCBpbW1lZGlhdGVseSxcbiAgICAgICAgICAgIC8vIG1vc3QgbGlrZWx5IGFzIGEgcmVzdWx0IG9mIGEgYmluZGluZyBpbml0aWFsaXNpbmdcbiAgICAgICAgICAgIHJ1bl9hbGwobmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICB9XG4gICAgICAgIGNvbXBvbmVudC4kJC5vbl9tb3VudCA9IFtdO1xuICAgIH0pO1xuICAgIGFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZGVzdHJveV9jb21wb25lbnQoY29tcG9uZW50LCBkZXRhY2hpbmcpIHtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJDtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgcnVuX2FsbCgkJC5vbl9kZXN0cm95KTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuZChkZXRhY2hpbmcpO1xuICAgICAgICAvLyBUT0RPIG51bGwgb3V0IG90aGVyIHJlZnMsIGluY2x1ZGluZyBjb21wb25lbnQuJCQgKGJ1dCBuZWVkIHRvXG4gICAgICAgIC8vIHByZXNlcnZlIGZpbmFsIHN0YXRlPylcbiAgICAgICAgJCQub25fZGVzdHJveSA9ICQkLmZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgJCQuY3R4ID0gW107XG4gICAgfVxufVxuZnVuY3Rpb24gbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpIHtcbiAgICBpZiAoY29tcG9uZW50LiQkLmRpcnR5WzBdID09PSAtMSkge1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgICAgIGNvbXBvbmVudC4kJC5kaXJ0eS5maWxsKDApO1xuICAgIH1cbiAgICBjb21wb25lbnQuJCQuZGlydHlbKGkgLyAzMSkgfCAwXSB8PSAoMSA8PCAoaSAlIDMxKSk7XG59XG5mdW5jdGlvbiBpbml0KGNvbXBvbmVudCwgb3B0aW9ucywgaW5zdGFuY2UsIGNyZWF0ZV9mcmFnbWVudCwgbm90X2VxdWFsLCBwcm9wcywgZGlydHkgPSBbLTFdKSB7XG4gICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkID0ge1xuICAgICAgICBmcmFnbWVudDogbnVsbCxcbiAgICAgICAgY3R4OiBudWxsLFxuICAgICAgICAvLyBzdGF0ZVxuICAgICAgICBwcm9wcyxcbiAgICAgICAgdXBkYXRlOiBub29wLFxuICAgICAgICBub3RfZXF1YWwsXG4gICAgICAgIGJvdW5kOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgLy8gbGlmZWN5Y2xlXG4gICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgb25fZGVzdHJveTogW10sXG4gICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICBhZnRlcl91cGRhdGU6IFtdLFxuICAgICAgICBjb250ZXh0OiBuZXcgTWFwKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSksXG4gICAgICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZVxuICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICBkaXJ0eSxcbiAgICAgICAgc2tpcF9ib3VuZDogZmFsc2VcbiAgICB9O1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICQkLmN0eCA9IGluc3RhbmNlXG4gICAgICAgID8gaW5zdGFuY2UoY29tcG9uZW50LCBvcHRpb25zLnByb3BzIHx8IHt9LCAoaSwgcmV0LCAuLi5yZXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJlc3QubGVuZ3RoID8gcmVzdFswXSA6IHJldDtcbiAgICAgICAgICAgIGlmICgkJC5jdHggJiYgbm90X2VxdWFsKCQkLmN0eFtpXSwgJCQuY3R4W2ldID0gdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkJC5za2lwX2JvdW5kICYmICQkLmJvdW5kW2ldKVxuICAgICAgICAgICAgICAgICAgICAkJC5ib3VuZFtpXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlYWR5KVxuICAgICAgICAgICAgICAgICAgICBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KVxuICAgICAgICA6IFtdO1xuICAgICQkLnVwZGF0ZSgpO1xuICAgIHJlYWR5ID0gdHJ1ZTtcbiAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgIC8vIGBmYWxzZWAgYXMgYSBzcGVjaWFsIGNhc2Ugb2Ygbm8gRE9NIGNvbXBvbmVudFxuICAgICQkLmZyYWdtZW50ID0gY3JlYXRlX2ZyYWdtZW50ID8gY3JlYXRlX2ZyYWdtZW50KCQkLmN0eCkgOiBmYWxzZTtcbiAgICBpZiAob3B0aW9ucy50YXJnZXQpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaHlkcmF0ZSkge1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBjaGlsZHJlbihvcHRpb25zLnRhcmdldCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQubChub2Rlcyk7XG4gICAgICAgICAgICBub2Rlcy5mb3JFYWNoKGRldGFjaCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuYygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmludHJvKVxuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihjb21wb25lbnQuJCQuZnJhZ21lbnQpO1xuICAgICAgICBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCBvcHRpb25zLnRhcmdldCwgb3B0aW9ucy5hbmNob3IpO1xuICAgICAgICBmbHVzaCgpO1xuICAgIH1cbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG59XG5sZXQgU3ZlbHRlRWxlbWVudDtcbmlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBTdmVsdGVFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuJCQuc2xvdHRlZCkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0aGlzLiQkLnNsb3R0ZWRba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGF0dHIsIF9vbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXNbYXR0cl0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvLyBUT0RPIHNob3VsZCB0aGlzIGRlbGVnYXRlIHRvIGFkZEV2ZW50TGlzdGVuZXI/XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMuIFVzZWQgd2hlbiBkZXY9ZmFsc2UuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICB9XG4gICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc3BhdGNoX2Rldih0eXBlLCBkZXRhaWwpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudCh0eXBlLCBPYmplY3QuYXNzaWduKHsgdmVyc2lvbjogJzMuMzIuMycgfSwgZGV0YWlsKSkpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpO1xufVxuZnVuY3Rpb24gZGV0YWNoX2Rldihub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmUnLCB7IG5vZGUgfSk7XG4gICAgZGV0YWNoKG5vZGUpO1xufVxuZnVuY3Rpb24gZGV0YWNoX2JldHdlZW5fZGV2KGJlZm9yZSwgYWZ0ZXIpIHtcbiAgICB3aGlsZSAoYmVmb3JlLm5leHRTaWJsaW5nICYmIGJlZm9yZS5uZXh0U2libGluZyAhPT0gYWZ0ZXIpIHtcbiAgICAgICAgZGV0YWNoX2RldihiZWZvcmUubmV4dFNpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9iZWZvcmVfZGV2KGFmdGVyKSB7XG4gICAgd2hpbGUgKGFmdGVyLnByZXZpb3VzU2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGFmdGVyLnByZXZpb3VzU2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoX2FmdGVyX2RldihiZWZvcmUpIHtcbiAgICB3aGlsZSAoYmVmb3JlLm5leHRTaWJsaW5nKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBsaXN0ZW5fZGV2KG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zLCBoYXNfcHJldmVudF9kZWZhdWx0LCBoYXNfc3RvcF9wcm9wYWdhdGlvbikge1xuICAgIGNvbnN0IG1vZGlmaWVycyA9IG9wdGlvbnMgPT09IHRydWUgPyBbJ2NhcHR1cmUnXSA6IG9wdGlvbnMgPyBBcnJheS5mcm9tKE9iamVjdC5rZXlzKG9wdGlvbnMpKSA6IFtdO1xuICAgIGlmIChoYXNfcHJldmVudF9kZWZhdWx0KVxuICAgICAgICBtb2RpZmllcnMucHVzaCgncHJldmVudERlZmF1bHQnKTtcbiAgICBpZiAoaGFzX3N0b3BfcHJvcGFnYXRpb24pXG4gICAgICAgIG1vZGlmaWVycy5wdXNoKCdzdG9wUHJvcGFnYXRpb24nKTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUFkZEV2ZW50TGlzdGVuZXInLCB7IG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBtb2RpZmllcnMgfSk7XG4gICAgY29uc3QgZGlzcG9zZSA9IGxpc3Rlbihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgICAgICBkaXNwb3NlKCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHJfZGV2KG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICBhdHRyKG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUpO1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZUF0dHJpYnV0ZScsIHsgbm9kZSwgYXR0cmlidXRlIH0pO1xuICAgIGVsc2VcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXRBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBwcm9wX2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0UHJvcGVydHknLCB7IG5vZGUsIHByb3BlcnR5LCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIGRhdGFzZXRfZGV2KG5vZGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIG5vZGUuZGF0YXNldFtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldERhdGFzZXQnLCB7IG5vZGUsIHByb3BlcnR5LCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhX2Rldih0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgPT09IGRhdGEpXG4gICAgICAgIHJldHVybjtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldERhdGEnLCB7IG5vZGU6IHRleHQsIGRhdGEgfSk7XG4gICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfYXJndW1lbnQoYXJnKSB7XG4gICAgaWYgKHR5cGVvZiBhcmcgIT09ICdzdHJpbmcnICYmICEoYXJnICYmIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmICdsZW5ndGgnIGluIGFyZykpIHtcbiAgICAgICAgbGV0IG1zZyA9ICd7I2VhY2h9IG9ubHkgaXRlcmF0ZXMgb3ZlciBhcnJheS1saWtlIG9iamVjdHMuJztcbiAgICAgICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgYXJnICYmIFN5bWJvbC5pdGVyYXRvciBpbiBhcmcpIHtcbiAgICAgICAgICAgIG1zZyArPSAnIFlvdSBjYW4gdXNlIGEgc3ByZWFkIHRvIGNvbnZlcnQgdGhpcyBpdGVyYWJsZSBpbnRvIGFuIGFycmF5Lic7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfc2xvdHMobmFtZSwgc2xvdCwga2V5cykge1xuICAgIGZvciAoY29uc3Qgc2xvdF9rZXkgb2YgT2JqZWN0LmtleXMoc2xvdCkpIHtcbiAgICAgICAgaWYgKCF+a2V5cy5pbmRleE9mKHNsb3Rfa2V5KSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGA8JHtuYW1lfT4gcmVjZWl2ZWQgYW4gdW5leHBlY3RlZCBzbG90IFwiJHtzbG90X2tleX1cIi5gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMgd2l0aCBzb21lIG1pbm9yIGRldi1lbmhhbmNlbWVudHMuIFVzZWQgd2hlbiBkZXY9dHJ1ZS5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50RGV2IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucyB8fCAoIW9wdGlvbnMudGFyZ2V0ICYmICFvcHRpb25zLiQkaW5saW5lKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ3RhcmdldCcgaXMgYSByZXF1aXJlZCBvcHRpb25cIik7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLiRkZXN0cm95KCk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvbXBvbmVudCB3YXMgYWxyZWFkeSBkZXN0cm95ZWQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgIH07XG4gICAgfVxuICAgICRjYXB0dXJlX3N0YXRlKCkgeyB9XG4gICAgJGluamVjdF9zdGF0ZSgpIHsgfVxufVxuLyoqXG4gKiBCYXNlIGNsYXNzIHRvIGNyZWF0ZSBzdHJvbmdseSB0eXBlZCBTdmVsdGUgY29tcG9uZW50cy5cbiAqIFRoaXMgb25seSBleGlzdHMgZm9yIHR5cGluZyBwdXJwb3NlcyBhbmQgc2hvdWxkIGJlIHVzZWQgaW4gYC5kLnRzYCBmaWxlcy5cbiAqXG4gKiAjIyMgRXhhbXBsZTpcbiAqXG4gKiBZb3UgaGF2ZSBjb21wb25lbnQgbGlicmFyeSBvbiBucG0gY2FsbGVkIGBjb21wb25lbnQtbGlicmFyeWAsIGZyb20gd2hpY2hcbiAqIHlvdSBleHBvcnQgYSBjb21wb25lbnQgY2FsbGVkIGBNeUNvbXBvbmVudGAuIEZvciBTdmVsdGUrVHlwZVNjcmlwdCB1c2VycyxcbiAqIHlvdSB3YW50IHRvIHByb3ZpZGUgdHlwaW5ncy4gVGhlcmVmb3JlIHlvdSBjcmVhdGUgYSBgaW5kZXguZC50c2A6XG4gKiBgYGB0c1xuICogaW1wb3J0IHsgU3ZlbHRlQ29tcG9uZW50VHlwZWQgfSBmcm9tIFwic3ZlbHRlXCI7XG4gKiBleHBvcnQgY2xhc3MgTXlDb21wb25lbnQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnRUeXBlZDx7Zm9vOiBzdHJpbmd9PiB7fVxuICogYGBgXG4gKiBUeXBpbmcgdGhpcyBtYWtlcyBpdCBwb3NzaWJsZSBmb3IgSURFcyBsaWtlIFZTIENvZGUgd2l0aCB0aGUgU3ZlbHRlIGV4dGVuc2lvblxuICogdG8gcHJvdmlkZSBpbnRlbGxpc2Vuc2UgYW5kIHRvIHVzZSB0aGUgY29tcG9uZW50IGxpa2UgdGhpcyBpbiBhIFN2ZWx0ZSBmaWxlXG4gKiB3aXRoIFR5cGVTY3JpcHQ6XG4gKiBgYGBzdmVsdGVcbiAqIDxzY3JpcHQgbGFuZz1cInRzXCI+XG4gKiBcdGltcG9ydCB7IE15Q29tcG9uZW50IH0gZnJvbSBcImNvbXBvbmVudC1saWJyYXJ5XCI7XG4gKiA8L3NjcmlwdD5cbiAqIDxNeUNvbXBvbmVudCBmb289eydiYXInfSAvPlxuICogYGBgXG4gKlxuICogIyMjIyBXaHkgbm90IG1ha2UgdGhpcyBwYXJ0IG9mIGBTdmVsdGVDb21wb25lbnQoRGV2KWA/XG4gKiBCZWNhdXNlXG4gKiBgYGB0c1xuICogY2xhc3MgQVN1YmNsYXNzT2ZTdmVsdGVDb21wb25lbnQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGNvbnN0IGNvbXBvbmVudDogdHlwZW9mIFN2ZWx0ZUNvbXBvbmVudCA9IEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50O1xuICogYGBgXG4gKiB3aWxsIHRocm93IGEgdHlwZSBlcnJvciwgc28gd2UgbmVlZCB0byBzZXBlcmF0ZSB0aGUgbW9yZSBzdHJpY3RseSB0eXBlZCBjbGFzcy5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50VHlwZWQgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnREZXYge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbG9vcF9ndWFyZCh0aW1lb3V0KSB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChEYXRlLm5vdygpIC0gc3RhcnQgPiB0aW1lb3V0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0luZmluaXRlIGxvb3AgZGV0ZWN0ZWQnKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmV4cG9ydCB7IEh0bWxUYWcsIFN2ZWx0ZUNvbXBvbmVudCwgU3ZlbHRlQ29tcG9uZW50RGV2LCBTdmVsdGVDb21wb25lbnRUeXBlZCwgU3ZlbHRlRWxlbWVudCwgYWN0aW9uX2Rlc3Ryb3llciwgYWRkX2F0dHJpYnV0ZSwgYWRkX2NsYXNzZXMsIGFkZF9mbHVzaF9jYWxsYmFjaywgYWRkX2xvY2F0aW9uLCBhZGRfcmVuZGVyX2NhbGxiYWNrLCBhZGRfcmVzaXplX2xpc3RlbmVyLCBhZGRfdHJhbnNmb3JtLCBhZnRlclVwZGF0ZSwgYXBwZW5kLCBhcHBlbmRfZGV2LCBhc3NpZ24sIGF0dHIsIGF0dHJfZGV2LCBhdHRyaWJ1dGVfdG9fb2JqZWN0LCBiZWZvcmVVcGRhdGUsIGJpbmQsIGJpbmRpbmdfY2FsbGJhY2tzLCBibGFua19vYmplY3QsIGJ1YmJsZSwgY2hlY2tfb3V0cm9zLCBjaGlsZHJlbiwgY2xhaW1fY29tcG9uZW50LCBjbGFpbV9lbGVtZW50LCBjbGFpbV9zcGFjZSwgY2xhaW1fdGV4dCwgY2xlYXJfbG9vcHMsIGNvbXBvbmVudF9zdWJzY3JpYmUsIGNvbXB1dGVfcmVzdF9wcm9wcywgY29tcHV0ZV9zbG90cywgY3JlYXRlRXZlbnREaXNwYXRjaGVyLCBjcmVhdGVfYW5pbWF0aW9uLCBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uLCBjcmVhdGVfY29tcG9uZW50LCBjcmVhdGVfaW5fdHJhbnNpdGlvbiwgY3JlYXRlX291dF90cmFuc2l0aW9uLCBjcmVhdGVfc2xvdCwgY3JlYXRlX3Nzcl9jb21wb25lbnQsIGN1cnJlbnRfY29tcG9uZW50LCBjdXN0b21fZXZlbnQsIGRhdGFzZXRfZGV2LCBkZWJ1ZywgZGVzdHJveV9ibG9jaywgZGVzdHJveV9jb21wb25lbnQsIGRlc3Ryb3lfZWFjaCwgZGV0YWNoLCBkZXRhY2hfYWZ0ZXJfZGV2LCBkZXRhY2hfYmVmb3JlX2RldiwgZGV0YWNoX2JldHdlZW5fZGV2LCBkZXRhY2hfZGV2LCBkaXJ0eV9jb21wb25lbnRzLCBkaXNwYXRjaF9kZXYsIGVhY2gsIGVsZW1lbnQsIGVsZW1lbnRfaXMsIGVtcHR5LCBlc2NhcGUsIGVzY2FwZWQsIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMsIGZpeF9hbmRfZGVzdHJveV9ibG9jaywgZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jaywgZml4X3Bvc2l0aW9uLCBmbHVzaCwgZ2V0Q29udGV4dCwgZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUsIGdldF9jdXJyZW50X2NvbXBvbmVudCwgZ2V0X2N1c3RvbV9lbGVtZW50c19zbG90cywgZ2V0X3Nsb3RfY2hhbmdlcywgZ2V0X3Nsb3RfY29udGV4dCwgZ2V0X3NwcmVhZF9vYmplY3QsIGdldF9zcHJlYWRfdXBkYXRlLCBnZXRfc3RvcmVfdmFsdWUsIGdsb2JhbHMsIGdyb3VwX291dHJvcywgaGFuZGxlX3Byb21pc2UsIGhhc0NvbnRleHQsIGhhc19wcm9wLCBpZGVudGl0eSwgaW5pdCwgaW5zZXJ0LCBpbnNlcnRfZGV2LCBpbnRyb3MsIGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLCBpc19jbGllbnQsIGlzX2Nyb3Nzb3JpZ2luLCBpc19lbXB0eSwgaXNfZnVuY3Rpb24sIGlzX3Byb21pc2UsIGxpc3RlbiwgbGlzdGVuX2RldiwgbG9vcCwgbG9vcF9ndWFyZCwgbWlzc2luZ19jb21wb25lbnQsIG1vdW50X2NvbXBvbmVudCwgbm9vcCwgbm90X2VxdWFsLCBub3csIG51bGxfdG9fZW1wdHksIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMsIG9uRGVzdHJveSwgb25Nb3VudCwgb25jZSwgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIHByZXZlbnRfZGVmYXVsdCwgcHJvcF9kZXYsIHF1ZXJ5X3NlbGVjdG9yX2FsbCwgcmFmLCBydW4sIHJ1bl9hbGwsIHNhZmVfbm90X2VxdWFsLCBzY2hlZHVsZV91cGRhdGUsIHNlbGVjdF9tdWx0aXBsZV92YWx1ZSwgc2VsZWN0X29wdGlvbiwgc2VsZWN0X29wdGlvbnMsIHNlbGVjdF92YWx1ZSwgc2VsZiwgc2V0Q29udGV4dCwgc2V0X2F0dHJpYnV0ZXMsIHNldF9jdXJyZW50X2NvbXBvbmVudCwgc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEsIHNldF9kYXRhLCBzZXRfZGF0YV9kZXYsIHNldF9pbnB1dF90eXBlLCBzZXRfaW5wdXRfdmFsdWUsIHNldF9ub3csIHNldF9yYWYsIHNldF9zdG9yZV92YWx1ZSwgc2V0X3N0eWxlLCBzZXRfc3ZnX2F0dHJpYnV0ZXMsIHNwYWNlLCBzcHJlYWQsIHN0b3BfcHJvcGFnYXRpb24sIHN1YnNjcmliZSwgc3ZnX2VsZW1lbnQsIHRleHQsIHRpY2ssIHRpbWVfcmFuZ2VzX3RvX2FycmF5LCB0b19udW1iZXIsIHRvZ2dsZV9jbGFzcywgdHJhbnNpdGlvbl9pbiwgdHJhbnNpdGlvbl9vdXQsIHVwZGF0ZV9rZXllZF9lYWNoLCB1cGRhdGVfc2xvdCwgdXBkYXRlX3Nsb3Rfc3ByZWFkLCB2YWxpZGF0ZV9jb21wb25lbnQsIHZhbGlkYXRlX2VhY2hfYXJndW1lbnQsIHZhbGlkYXRlX2VhY2hfa2V5cywgdmFsaWRhdGVfc2xvdHMsIHZhbGlkYXRlX3N0b3JlLCB4bGlua19hdHRyIH07XG4iLCJpbXBvcnQgeyBpbml0IH0gZnJvbSAnLi9pbmRpY2F0b3JGb3JtJ1xyXG5cclxuY29uc3QgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxGb3JtRWxlbWVudD4oJ1tkYXRhLWNvbXBvbmVudD1cImluZGljYXRvckZvcm1cIl0nKVxyXG5cclxuZm9ybXMuZm9yRWFjaCgoZm9ybSk6IHZvaWQgPT4ge1xyXG4gICAgaW5pdChmb3JtKTtcclxufSlcclxuIiwiPHNjcmlwdCBsYW5nPVwidHlwZXNjcmlwdFwiPnZhciBjb2xvclZhcmlhbnRzO1xyXG4oZnVuY3Rpb24gKGNvbG9yVmFyaWFudHMpIHtcclxuICAgIGNvbG9yVmFyaWFudHNbY29sb3JWYXJpYW50c1tcIm5ldHRsZVwiXSA9IDBdID0gXCJuZXR0bGVcIjtcclxuICAgIGNvbG9yVmFyaWFudHNbY29sb3JWYXJpYW50c1tcImJyYW1ibGVcIl0gPSAxXSA9IFwiYnJhbWJsZVwiO1xyXG59KShjb2xvclZhcmlhbnRzIHx8IChjb2xvclZhcmlhbnRzID0ge30pKTtcclxudmFyIHNpemVzO1xyXG4oZnVuY3Rpb24gKHNpemVzKSB7XHJcbiAgICBzaXplc1tzaXplc1tcIm5vcm1hbFwiXSA9IDBdID0gXCJub3JtYWxcIjtcclxuICAgIHNpemVzW3NpemVzW1wic21hbGxcIl0gPSAxXSA9IFwic21hbGxcIjtcclxufSkoc2l6ZXMgfHwgKHNpemVzID0ge30pKTtcclxuZXhwb3J0IGxldCBsYWJlbCA9ICcnO1xyXG5leHBvcnQgbGV0IGZ1bGwgPSBmYWxzZTtcclxuZXhwb3J0IGxldCBjbGFzc05hbWVzID0gJyc7XHJcbmV4cG9ydCBsZXQgY29sb3JWYXJpYW50ID0gJ25ldHRsZSc7XHJcbmV4cG9ydCBsZXQgc2l6ZSA9ICdub3JtYWwnO1xyXG5leHBvcnQgbGV0IGFzTGluayA9IGZhbHNlO1xyXG5leHBvcnQgbGV0IGhyZWYgPSAnJztcclxubGV0IGJ1dHRvbkNsYXNzTmFtZXMgPSAnJztcclxuLyoqXHJcbiAqIENvbG9yIHZhcmlhbnRzXHJcbiAqL1xyXG5pZiAoY29sb3JWYXJpYW50ID09ICduZXR0bGUnKSB7XHJcbiAgICBidXR0b25DbGFzc05hbWVzICs9XHJcbiAgICAgICAgJyBib3JkZXItZ3JlZW4tNzAwIGJvcmRlci0yIGhvdmVyOmJnLWdyZWVuLTEwMCBhY3RpdmU6YmctZ3JlZW4tNjAwJztcclxufVxyXG5pZiAoY29sb3JWYXJpYW50ID09ICdicmFtYmxlJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPVxyXG4gICAgICAgICcgYm9yZGVyLWdyYXktODAwIGJvcmRlciBob3ZlcjpiZy1ncmVlbi0xMDAgYWN0aXZlOmJnLWdyZWVuLTYwMCc7XHJcbn1cclxuLyoqXHJcbiAqIFNpemUgdmFyaWFudHNcclxuICovXHJcbmlmIChzaXplID09ICdub3JtYWwnKSB7XHJcbiAgICBidXR0b25DbGFzc05hbWVzICs9ICcgcHgtNiBweS0zJztcclxufVxyXG5pZiAoc2l6ZSA9PSAnc21hbGwnKSB7XHJcbiAgICBidXR0b25DbGFzc05hbWVzICs9ICcgdGV4dC1iYXNlIHB4LTMgcHktMyc7XHJcbn1cclxuPC9zY3JpcHQ+XHJcblxyXG57I2lmIGFzTGlua31cclxuICAgIDxhXHJcbiAgICAgICAgICAgIGNsYXNzOnctZnVsbD17ZnVsbH1cclxuICAgICAgICAgICAgaHJlZj1cInsgaHJlZiB9XCJcclxuICAgICAgICAgICAgY2xhc3M9XCJcclxuICBcdHtidXR0b25DbGFzc05hbWVzfVxyXG4gIFx0e2NsYXNzTmFtZXMgPyBgICR7Y2xhc3NOYW1lc31gIDogJyd9XCJcclxuICAgID5cclxuICAgICAgICB7bGFiZWx9XHJcbiAgICA8L2E+XHJcbns6ZWxzZSB9XHJcbiAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIG9uOmNsaWNrXHJcbiAgICAgICAgICAgIGNsYXNzOnctZnVsbD17ZnVsbH1cclxuICAgICAgICAgICAgY2xhc3M9XCJcclxuICBcdHtidXR0b25DbGFzc05hbWVzfVxyXG4gIFx0e2NsYXNzTmFtZXMgPyBgICR7Y2xhc3NOYW1lc31gIDogJyd9XCJcclxuICAgID5cclxuICAgICAgICB7bGFiZWx9XHJcbiAgICA8L2J1dHRvbj5cclxuXHJcbnsvaWZ9IiwiPHNjcmlwdCBsYW5nPVwidHlwZXNjcmlwdFwiPmltcG9ydCBCdXR0b24gZnJvbSAnLi4vc2hhcmVkL0J1dHRvbic7XHJcbmltcG9ydCB7IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciB9IGZyb20gJ3N2ZWx0ZSc7XHJcbmltcG9ydCB7IE1lc3VyZUN1c3RvbVN0b3JhYmxlIH0gZnJvbSBcIi4uLy4uL3N0b3JhYmxlcy9NZXN1cmVDdXN0b21TdG9yYWJsZVwiO1xyXG5pbXBvcnQgeyBtZXN1cmVDdXN0b21TdG9yZSB9IGZyb20gXCIuLi8uLi9hcGkvaHlicmlkU3RvcmVcIjtcclxuZXhwb3J0IGxldCBtZXN1cmU7XHJcbmNvbnN0IGRpc3BhdGNoID0gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCk7XHJcbmNvbnN0IGhhbmRsZURlbGV0ZSA9IChldmVudCkgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGNvbmZpcm1EZWxldGUgPSBjb25maXJtKCfDinRlcy12b3VzIHPDu3LigKJlIGRlIHZvdWxvaXIgc3VwcHJpbWVyIHVuZSBkZSB2b3MgbWVzdXJlcyBwZXJzb25uYWxpc8OpZXMgPycpO1xyXG4gICAgaWYgKGNvbmZpcm1EZWxldGUpIHtcclxuICAgICAgICBtZXN1cmVDdXN0b21TdG9yZS5kZWxldGVCeUlkKG1lc3VyZS5pZCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVE9ETzogcmVtb3ZlIHRoaXMgZGlzcGF0Y2hlciB3aGVuIHdlIGhhdmUgYSBnbG9iYWwgYXBwbGljYXRpb24gc3RhdGUgYW5kIHVzZVxyXG4gICAgICAgICAqICAgICAgIDxNZXN1cmVzTGlua3M+IHByb3BzIHRvIGh5ZHJhdGUgbWVzdXJlcyBsaXN0LlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGRpc3BhdGNoKCdkZWxldGUnLCBtZXN1cmUuaWQpO1xyXG4gICAgfVxyXG59O1xyXG48L3NjcmlwdD5cclxuXHJcbjxtYWluPlxyXG4gICAgPGFcclxuICAgICAgICAgICAgY2xhc3M9XCJiZy13aGl0ZSBwLTQgcm91bmRlZCBteS00IGdyaWQgZ3JpZC1jb2xzLTEgbGc6Z3JpZC1jb2xzLTEyIGxnOmdhcC0xXCJcclxuICAgICAgICAgICAgaHJlZj1cIm1lc3VyZV9wZXJzb25uYWxpc2VlLmh0bWw/ZXBjaV9pZD17bWVzdXJlLmVwY2lfaWR9Jm1lc3VyZV91aWQ9e21lc3VyZS51aWR9XCJcclxuICAgID5cclxuICAgICAgICA8aDMgY2xhc3M9XCJsZzpjb2wtc3Bhbi04IHRleHQteGwgZm9udC1zZW1pYm9sZCBtYi02IHByLTI4XCI+XHJcbiAgICAgICAgICAgIHttZXN1cmUubmFtZX1cclxuICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiU3VwcHJpbWVyXCJcclxuICAgICAgICAgICAgICAgICAgICBjb2xvclZhcmlhbnQ9XCJicmFtYmxlXCJcclxuICAgICAgICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9uOmNsaWNrPXtoYW5kbGVEZWxldGV9XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lcz1cIm1sLTZcIlxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgIDwvaDM+XHJcbiAgICA8L2E+XHJcbjwvbWFpbj4iLCI8c2NyaXB0IGxhbmc9XCJ0eXBlc2NyaXB0XCI+dmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5pbXBvcnQgTWVzdXJlTGluayBmcm9tICcuL01lc3VyZUxpbmsuc3ZlbHRlJztcclxuaW1wb3J0IHsgbWVzdXJlQ3VzdG9tU3RvcmUgfSBmcm9tIFwiLi4vLi4vYXBpL2h5YnJpZFN0b3JlXCI7XHJcbmltcG9ydCB7IE1lc3VyZUN1c3RvbVN0b3JhYmxlIH0gZnJvbSBcIi4uLy4uL3N0b3JhYmxlcy9NZXN1cmVDdXN0b21TdG9yYWJsZVwiO1xyXG5leHBvcnQgbGV0IGNsaW1hdF9wcmF0aWNfdGhlbWF0aXF1ZV9pZDtcclxubGV0IGN1c3RvbU1lc3VyZXMgPSBbXTtcclxuY29uc3QgdXBkYXRlTWVzdXJlcyA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgY29uc3QgYWxsID0geWllbGQgbWVzdXJlQ3VzdG9tU3RvcmUucmV0cmlldmVBbGwoKTtcclxuICAgIGN1c3RvbU1lc3VyZXMgPSBhbGwuZmlsdGVyKChtZXN1cmUpID0+IG1lc3VyZS5jbGltYXRfcHJhdGljX3RoZW1hdGljX2lkID09IGNsaW1hdF9wcmF0aWNfdGhlbWF0aXF1ZV9pZCk7XHJcbn0pO1xyXG51cGRhdGVNZXN1cmVzKCk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPHVsPlxyXG4gICAgeyNlYWNoIGN1c3RvbU1lc3VyZXMgYXMgbWVzdXJlfVxyXG4gICAgICAgIDxNZXN1cmVMaW5rXHJcbiAgICAgICAgICAgICAgICBvbjpkZWxldGU9e3VwZGF0ZU1lc3VyZXN9XHJcbiAgICAgICAgICAgICAgICBtZXN1cmU9e21lc3VyZX1cclxuICAgICAgICAvPlxyXG4gICAgey9lYWNofVxyXG48L3VsPlxyXG4iLCJleHBvcnQgY2xhc3MgVGhlbWF0aXF1ZSB7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgY29uc3RydWN0b3IoaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB0aGVtYXRpcXVlcyA9IHtcclxuXHJcbiAgICBcInN0cmF0ZWdpZVwiOiBuZXcgVGhlbWF0aXF1ZShcInN0cmF0ZWdpZVwiLCBcIlN0cmF0w6lnaWVcIiksXHJcblxyXG4gICAgXCJ1cmJhbmlzbWVcIjogbmV3IFRoZW1hdGlxdWUoXCJ1cmJhbmlzbWVcIiwgXCJVcmJhbmlzbWUgZXQgYW3DqW5hZ2VtZW50XCIpLFxyXG5cclxuICAgIFwiYmF0aW1lbnRzXCI6IG5ldyBUaGVtYXRpcXVlKFwiYmF0aW1lbnRzXCIsIFwiQsOidGltZW50cyBldCBwYXRyaW1vaW5lXCIpLFxyXG5cclxuICAgIFwiZW5lcmdpZVwiOiBuZXcgVGhlbWF0aXF1ZShcImVuZXJnaWVcIiwgXCJHZXN0aW9uLCBwcm9kdWN0aW9uIGV0IGRpc3RyaWJ1dGlvbiBkZSBsJ8OpbmVyZ2llXCIpLFxyXG5cclxuICAgIFwibW9iaWxpdGVzXCI6IG5ldyBUaGVtYXRpcXVlKFwibW9iaWxpdGVzXCIsIFwiTW9iaWxpdMOpc1wiKSxcclxuXHJcbiAgICBcImFncmlfYWxpbVwiOiBuZXcgVGhlbWF0aXF1ZShcImFncmlfYWxpbVwiLCBcIkFncmljdWx0dXJlIGV0IGFsaW1lbnRhdGlvblwiKSxcclxuXHJcbiAgICBcImZvcmV0X2Jpb2RpdlwiOiBuZXcgVGhlbWF0aXF1ZShcImZvcmV0X2Jpb2RpdlwiLCBcIkZvcsOqdHMsIGVzcGFjZXMgdmVydHMgZXQgYmlvZGl2ZXJzaXTDqVwiKSxcclxuXHJcbiAgICBcImNvbnNvX3Jlc3BcIjogbmV3IFRoZW1hdGlxdWUoXCJjb25zb19yZXNwXCIsIFwiQ29uc29tbWF0aW9uIMOpY29yZXNwb25zYWJsZVwiKSxcclxuXHJcbiAgICBcImRlY2hldHNcIjogbmV3IFRoZW1hdGlxdWUoXCJkZWNoZXRzXCIsIFwiRMOpY2hldHNcIiksXHJcblxyXG4gICAgXCJlYXVcIjogbmV3IFRoZW1hdGlxdWUoXCJlYXVcIiwgXCJFYXUgZXQgYXNzYWluaXNzZW1lbnRcIiksXHJcblxyXG4gICAgXCJwcmVjYV9lbmVyZ2llXCI6IG5ldyBUaGVtYXRpcXVlKFwicHJlY2FfZW5lcmdpZVwiLCBcIlByw6ljYXJpdMOpIMOpbmVyZ8OpdGlxdWVcIiksXHJcblxyXG4gICAgXCJkZXZfZWNvXCI6IG5ldyBUaGVtYXRpcXVlKFwiZGV2X2Vjb1wiLCBcIkFjdGl2aXTDqXMgw6ljb25vbWlxdWVzXCIpLFxyXG5cclxuICAgIFwidG91cmlzbWVcIjogbmV3IFRoZW1hdGlxdWUoXCJ0b3VyaXNtZVwiLCBcIlRvdXJpc21lXCIpLFxyXG5cclxuICAgIFwib3JnYV9pbnRlcm5lXCI6IG5ldyBUaGVtYXRpcXVlKFwib3JnYV9pbnRlcm5lXCIsIFwiT3JnYW5pc2F0aW9uIGludGVybmVcIiksXHJcblxyXG4gICAgXCJmb3JtYV9zZW5zaWJcIjogbmV3IFRoZW1hdGlxdWUoXCJmb3JtYV9zZW5zaWJcIiwgXCJGb3JtYXRpb24sIHNlbnNpYmlsaXNhdGlvbiwgY29tbXVuaWNhdGlvblwiKSxcclxuXHJcbiAgICBcInBhcnRlbl9jb29wXCI6IG5ldyBUaGVtYXRpcXVlKFwicGFydGVuX2Nvb3BcIiwgXCJQYXJ0ZW5hcmlhdCBldCBjb29ww6lyYXRpb25cIiksXHJcblxyXG4gICAgXCJlY2lcIjogbmV3IFRoZW1hdGlxdWUoXCJlY2lcIiwgXCLDiWNvbm9taWUgY2lyY3VsYWlyZVwiKSxcclxuXHJcbn0iLCJpbXBvcnQgJy4vc3R5bGVzLmNzcydcclxuaW1wb3J0ICcuL2NvbXBvbmVudHMvbGVnYWN5L21lc3VyZSdcclxuaW1wb3J0ICcuL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvcnNMaXN0J1xyXG5pbXBvcnQgTWVzdXJlTGlua3MgZnJvbSAnLi9jb21wb25lbnRzL21lc3VyZXMvTWVzdXJlTGlua3Muc3ZlbHRlJ1xyXG5pbXBvcnQgeyBUaGVtYXRpcXVlLCB0aGVtYXRpcXVlcyB9IGZyb20gJy4vLi4vdmVuZG9ycy90aGVtYXRpcXVlcydcclxuXHJcbmNvbnN0IGluaXRDdXN0b21NZXN1cmVzRm9yVGhlbWF0aXF1ZXMgPSAodGhlbWF0aXF1ZTogVGhlbWF0aXF1ZSk6IHZvaWQgPT4ge1xyXG4gIG5ldyBNZXN1cmVMaW5rcyh7XHJcbiAgICAvLyBAdHMtaWdub3JlXHJcbiAgICB0YXJnZXQ6IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcihgW2RhdGEtY3VzdG9tLW1lc3VyZS10aGVtYXRpcXVlPVwiJHt0aGVtYXRpcXVlLmlkfVwiXWApLFxyXG4gICAgcHJvcHM6IHtcclxuICAgICAgY2xpbWF0X3ByYXRpY190aGVtYXRpcXVlX2lkOiB0aGVtYXRpcXVlLmlkLFxyXG4gICAgfVxyXG4gIH0pXHJcbn1cclxuXHJcbk9iamVjdC52YWx1ZXModGhlbWF0aXF1ZXMpLmZvckVhY2goaW5pdEN1c3RvbU1lc3VyZXNGb3JUaGVtYXRpcXVlcylcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==