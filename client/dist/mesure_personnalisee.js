(()=>{"use strict";const e=e=>null!=e.id&&null!=e.pathname;class t{constructor({epci_id:e,indicateur_id:t,year:n,value:r}){this.epci_id=e,this.indicateur_id=t,this.year=n,this.value=r}get pathname(){return t.pathname}}t.pathname="indicateur_value";class n extends t{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return n.buildId(this.epci_id,this.indicateur_id,this.year)}}class r{constructor({host:e,endpoint:t,serializer:n,deserializer:r}){this.host=e,this.pathname=t,this.serializer=n,this.deserializer=r}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await fetch(`${this.host}/${this.pathname}/`,{method:"POST",mode:"cors",body:JSON.stringify(this.serializer(t))});return this.deserializer(await n.json())}async retrieveAll(){return this.retrieveAtPath("all")}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"});return 404==t.status?null:this.deserializer(await t.json())}async retrieveAtPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"}),n=await t.json(),r=[];for(let e=0;e<n.length;e++)r.push(this.deserializer(n[e]));return r}async deleteById(e){return 200==(await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"DELETE"})).status}}const i=()=>{const e=new URLSearchParams(window.location.search).get("epci_id");if(!e)throw new Error("Parameter epci_id is empty.");return e};class a{constructor({action_id:e,epci_id:t,avancement:n}){this.action_id=e,this.epci_id=t,this.avancement=n}get pathname(){return a.pathname}}a.pathname="action_status";class s extends a{static buildId(e,t){return`${e}/${t}`}get id(){return s.buildId(this.epci_id,this.action_id)}}class o{constructor({uid:e,epci_id:t,mesure_id:n,name:r,description:i}){this.uid=e,this.epci_id=t,this.mesure_id=n,this.name=r,this.description=i}get pathname(){return o.pathname}}o.pathname="action_custom";class c extends o{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return c.buildId(this.epci_id,this.mesure_id,this.uid)}}const l=()=>{const e=window.location.hostname;if("localhost"===e.substring(0,10))return"http://localhost:8000";if("sandbox.territoiresentransitions.fr"===e)return"https://sandboxterritoires.osc-fr1.scalingo.io";if("staging.territoiresentransitions.fr"===e)return"https://territoiresentransitions.osc-fr1.scalingo.io";throw`no API host for ${e}`};class u{constructor({uid:e,epci_id:t,climat_pratic_thematic_id:n,name:r}){this.uid=e,this.epci_id=t,this.climat_pratic_thematic_id=n,this.name=r}get pathname(){return u.pathname}}u.pathname="mesure_custom";class d extends u{static buildId(e,t){return`${e}/${t}`}get id(){return d.buildId(this.epci_id,this.uid)}}class h{constructor({host:e,endpoint:t,serializer:n,deserializer:i}){this.cache=null,this.retrieving=null,this.host=e,this.pathname=t,this.serializer=n,this.deserializer=i,this.api=new r({host:this.host,endpoint:this.pathname,serializer:this.serializer,deserializer:this.deserializer})}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await this.api.store(t);return this.writeInCache(n)}retrieveAll(){return this.getCache()}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await this.getCache();for(let n of t)if(n.id.startsWith(e))return n;return null}async retrieveAtPath(e){const t=await this.getCache(),n=[];for(let r of t)r.id.startsWith(e)&&n.push(r);return n}async deleteById(e){const t=await this.api.deleteById(this.stripId(e)),n=await this.getCache();return this.cache=n.filter((t=>t.id!==e)),t}stripId(e){const t=this.pathname.split("/");let n=e.split("/"),r=!1;for(let e=0;e<t.length;e++)if(t[e]==n[0])r=!0,n=n.slice(1);else if(r)break;return n.join("/")}async writeInCache(e){await this.removeFromCache(e.id);const t=await this.getCache();return t.push(e),this.cache=t,e}async removeFromCache(e){const t=await this.getCache(),n=t.filter((t=>t.id!==e)),r=n.length!=t.length;return this.cache=n,r}async getCache(){return null!==this.cache?this.cache:(null===this.retrieving&&(this.retrieving=this.api.retrieveAll(),this.retrieving.then((e=>{this.cache=e}))),this.retrieving)}}const f=new h({host:l(),endpoint:`v1/${t.pathname}/${i()}`,serializer:e=>e,deserializer:e=>new n(e)}),p=new h({host:l(),endpoint:`v1/${a.pathname}/${i()}`,serializer:e=>e,deserializer:e=>new s(e)}),m=new h({host:l(),endpoint:`v1/${o.pathname}/${i()}`,serializer:e=>e,deserializer:e=>new c(e)}),g=new h({host:l(),endpoint:`v1/${u.pathname}/${i()}`,serializer:e=>e,deserializer:e=>new d(e)}),$=i();document.querySelectorAll(".status").forEach((e=>(e=>{let t=e.dataset.actionId||"",n=e.querySelectorAll('input[type="radio"]');((e,t)=>{let n=t=>{const n=t.target.value,r=new s({epci_id:$,action_id:e,avancement:n});p.store(r)};t.forEach((e=>{e.addEventListener("change",n)}))})(t,n),(async(e,t)=>{let n="pas_faite";try{const r=await p.retrieveById(`${$}/${e}`);r&&(n=r.avancement)}catch(e){}finally{const r=`action-${e}_${n}`;t.forEach((e=>{e.id===r&&(e.checked=!0)}))}})(t,n)})(e)));const y=e=>{e.preventDefault()},v=e=>{const t=e.target,{id:r,year:a}=w(t),s=i(),o=new n({epci_id:s,indicateur_id:r,year:a,value:t.value});f.store(o)},b=e=>{"Enter"===e.key&&e.target.blur()},_=async e=>{e.value="",e.addEventListener("blur",v),e.addEventListener("keypress",b)},w=e=>({id:e.dataset.indicatorId,year:+e.dataset.indicatorYear});function x(){}function k(e){return e()}function C(){return Object.create(null)}function E(e){e.forEach(k)}function I(e){return"function"==typeof e}function z(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function P(e){return 0===Object.keys(e).length}function A(e,t){e.appendChild(t)}function L(e,t,n){e.insertBefore(t,n||null)}function B(e){e.parentNode.removeChild(e)}function N(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function T(e){return document.createElement(e)}function S(e){return document.createTextNode(e)}function j(){return S(" ")}function V(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function q(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function H(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function O(e,t,n){e.classList[n?"add":"remove"](t)}let F;function M(e){F=e}document.querySelectorAll('[data-component="indicatorForm"]').forEach((e=>{(async e=>{e.addEventListener("submit",y);const t=e.querySelectorAll("input");for(let e of t)_(e);const{id:n,year:r}=w(t[0]),a=i(),s=await f.retrieveAtPath(`${a}/${n}`);for(let e of t){const{id:t,year:n}=w(e);let r="";for(let e of s)e.year==n&&e.indicateur_id==t&&(r=e.value);e.value=r}})(e)})),new Set,new Set;const R=[],D=[],G=[],U=[],W=Promise.resolve();let J=!1;function Y(e){G.push(e)}let K=!1;const Q=new Set;function X(){if(!K){K=!0;do{for(let e=0;e<R.length;e+=1){const t=R[e];M(t),Z(t.$$)}for(M(null),R.length=0;D.length;)D.pop()();for(let e=0;e<G.length;e+=1){const t=G[e];Q.has(t)||(Q.add(t),t())}G.length=0}while(R.length);for(;U.length;)U.pop()();J=!1,K=!1,Q.clear()}}function Z(e){if(null!==e.fragment){e.update(),E(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Y)}}const ee=new Set;let te,ne;function re(){te={r:0,c:[],p:te}}function ie(){te.r||E(te.c),te=te.p}function ae(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function se(e,t,n,r){if(e&&e.o){if(ee.has(e))return;ee.add(e),te.c.push((()=>{ee.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function oe(e){e&&e.c()}function ce(e,t,n){const{fragment:r,on_mount:i,on_destroy:a,after_update:s}=e.$$;r&&r.m(t,n),Y((()=>{const t=i.map(k).filter(I);a?a.push(...t):E(t),e.$$.on_mount=[]})),s.forEach(Y)}function le(e,t){const n=e.$$;null!==n.fragment&&(E(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ue(e,t,n,r,i,a,s=[-1]){const o=F;M(e);const c=e.$$={fragment:null,ctx:null,props:a,update:x,not_equal:i,bound:C(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(o?o.$$.context:[]),callbacks:C(),dirty:s,skip_bound:!1};let l=!1;if(c.ctx=n?n(e,t.props||{},((t,n,...r)=>{const a=r.length?r[0]:n;return c.ctx&&i(c.ctx[t],c.ctx[t]=a)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](a),l&&function(e,t){-1===e.$$.dirty[0]&&(R.push(e),J||(J=!0,W.then(X)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],c.update(),l=!0,E(c.before_update),c.fragment=!!r&&r(c.ctx),t.target){if(t.hydrate){const e=(u=t.target,Array.from(u.childNodes));c.fragment&&c.fragment.l(e),e.forEach(B)}else c.fragment&&c.fragment.c();t.intro&&ae(e.$$.fragment),ce(e,t.target,t.anchor),X()}var u;M(o)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(ne=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){le(this,1),this.$destroy=x}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!P(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class de{$destroy(){le(this,1),this.$destroy=x}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!P(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function he(e){let t,n,r;return{c(){t=T("h1"),n=S(e[0]),q(t,"class",r="text-3xl font-semibold "+(e[1]?` ${e[1]}`:""))},m(e,r){L(e,t,r),A(t,n)},p(e,[i]){1&i&&H(n,e[0]),2&i&&r!==(r="text-3xl font-semibold "+(e[1]?` ${e[1]}`:""))&&q(t,"class",r)},i:x,o:x,d(e){e&&B(t)}}}function fe(e,t,n){let{name:r=""}=t,{classNames:i}=t;return e.$$set=e=>{"name"in e&&n(0,r=e.name),"classNames"in e&&n(1,i=e.classNames)},[r,i]}const pe=class extends de{constructor(e){super(),ue(this,e,fe,he,z,{name:0,classNames:1})}},me={test:"Ville de test",clunisois:"CC du Clunisois",coeur_savoie:"CC Coeur de Savoie",doubs_baumois:"CC Doubs Baumois",haut_poitou:"CC Haut Poitou",pays_rethelois:"CC Pays Rethélois",pyrenees_gaves:"CC Pyrénées Vallées des Gaves",terres_haut_berry:"CC Terres du Haut Berry",touraine_est:"CC Touraine-Est Vallées",cyclad:"Cyclad",hennebont:"Hennebont",ploemeur:"Plœmeur"};function ge(e){let t,n,r,i,a;return{c(){t=S(e[1]),n=j(),r=T("a"),i=S("(modifier)"),q(r,"href",a="/?epci_id="+e[0]),q(r,"class","underline")},m(e,a){L(e,t,a),L(e,n,a),L(e,r,a),A(r,i)},p:x,i:x,o:x,d(e){e&&B(t),e&&B(n),e&&B(r)}}}function $e(e){const t=i();return[t,me[t]]}const ye=class extends de{constructor(e){super(),ue(this,e,$e,ge,z,{})}};function ve(e){let t,n,r,i,a,s,o,c,l,u,d,h,f,p,m,g,$,y,v;return l=new ye({}),{c(){t=T("nav"),n=T("ul"),r=T("li"),i=T("a"),a=S("Territoires en Transitions"),o=j(),c=T("li"),oe(l.$$.fragment),u=j(),d=T("li"),h=T("a"),f=S("Plan d'actions"),m=j(),g=T("li"),g.innerHTML='<a class="p-1 rounded hover:bg-gray-100 hover:text-gray-700 focus:bg-gray-100 focus:text-gray-700 active:text-gray-900 active:shadow-inner active:bg-white" href="mesures.html">Référentiels</a>',$=j(),y=T("li"),y.innerHTML='<a class="p-1 rounded hover:bg-gray-100 hover:text-gray-700 focus:bg-gray-100 focus:text-gray-700 active:text-gray-900 active:shadow-inner active:bg-white" href="indicateurs.html">Indicateurs</a>',q(i,"class","p-1 rounded hover:bg-gray-100 hover:text-gray-700 focus:bg-gray-100 focus:text-gray-700 active:text-gray-900 active:shadow-inner active:bg-white"),q(i,"href",s="/?epci_id="+e[0]),q(r,"class","mr-4"),q(c,"class","mr-4 flex-grow text-center"),q(h,"class","p-1 rounded hover:bg-gray-100 hover:text-gray-700 focus:bg-gray-100 focus:text-gray-700 active:text-gray-900 active:shadow-inner active:bg-white"),q(h,"href",p="fiches/?epci_id="+e[0]),q(d,"class","mr-4"),q(g,"class","mr-4"),q(y,"class","mr-4"),q(n,"class","container mx-auto lg:px-20 px-4 p-4 flex text-xl"),q(t,"class","bg-green-600")},m(e,s){L(e,t,s),A(t,n),A(n,r),A(r,i),A(i,a),A(n,o),A(n,c),ce(l,c,null),A(n,u),A(n,d),A(d,h),A(h,f),A(n,m),A(n,g),A(n,$),A(n,y),v=!0},p:x,i(e){v||(ae(l.$$.fragment,e),v=!0)},o(e){se(l.$$.fragment,e),v=!1},d(e){e&&B(t),le(l)}}}function be(e){return[i()]}const _e=class extends de{constructor(e){super(),ue(this,e,be,ve,z,{})}};function we(e){let t,n,r,i,a;return{c(){t=T("button"),n=S(e[0]),q(t,"class",r="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),O(t,"w-full",e[1])},m(r,s){L(r,t,s),A(t,n),i||(a=V(t,"click",e[8]),i=!0)},p(e,i){1&i&&H(n,e[0]),36&i&&r!==(r="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&q(t,"class",r),38&i&&O(t,"w-full",e[1])},d(e){e&&B(t),i=!1,a()}}}function xe(e){let t,n,r;return{c(){t=T("a"),n=S(e[0]),q(t,"href",e[4]),q(t,"class",r="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),O(t,"w-full",e[1])},m(e,r){L(e,t,r),A(t,n)},p(e,i){1&i&&H(n,e[0]),16&i&&q(t,"href",e[4]),36&i&&r!==(r="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&q(t,"class",r),38&i&&O(t,"w-full",e[1])},d(e){e&&B(t)}}}function ke(e){let t;function n(e,t){return e[3]?xe:we}let r=n(e),i=r(e);return{c(){i.c(),t=S("")},m(e,n){i.m(e,n),L(e,t,n)},p(e,[a]){r===(r=n(e))&&i?i.p(e,a):(i.d(1),i=r(e),i&&(i.c(),i.m(t.parentNode,t)))},i:x,o:x,d(e){i.d(e),e&&B(t)}}}function Ce(e,t,n){var r,i;!function(e){e[e.nettle=0]="nettle",e[e.bramble=1]="bramble"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.small=1]="small"}(i||(i={}));let{label:a=""}=t,{full:s=!1}=t,{classNames:o=""}=t,{colorVariant:c="nettle"}=t,{size:l="normal"}=t,{asLink:u=!1}=t,{href:d=""}=t,h="";return"nettle"==c&&(h+=" border-green-700 border-2 hover:bg-green-100 active:bg-green-600"),"bramble"==c&&(h+=" border-gray-800 border hover:bg-green-100 active:bg-green-600"),"normal"==l&&(h+=" px-6 py-3"),"small"==l&&(h+=" text-base px-3 py-3"),e.$$set=e=>{"label"in e&&n(0,a=e.label),"full"in e&&n(1,s=e.full),"classNames"in e&&n(2,o=e.classNames),"colorVariant"in e&&n(6,c=e.colorVariant),"size"in e&&n(7,l=e.size),"asLink"in e&&n(3,u=e.asLink),"href"in e&&n(4,d=e.href)},[a,s,o,u,d,h,c,l,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}const Ee=class extends de{constructor(e){super(),ue(this,e,Ce,ke,z,{label:0,full:1,classNames:2,colorVariant:6,size:7,asLink:3,href:4})}};function Ie(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function ze(e){let t,n,r,i,a,s,o,c,l,u,d,h,f,p=e[10].label+"";return{c(){t=T("div"),n=T("input"),s=j(),o=T("label"),c=S(p),d=j(),n.__value=r=e[10].key,n.value=n.__value,q(n,"id",i="action-"+e[0]+"_"+e[10].key),q(n,"name",a="action-"+e[0]+"_status"),q(n,"type","radio"),q(n,"class","sr-only"),e[6][0].push(n),q(o,"for",l="action-"+e[0]+"_"+e[10].key),q(o,"class",u=e[3][e[12]])},m(r,i){L(r,t,i),A(t,n),n.checked=n.__value===e[1],A(t,s),A(t,o),A(o,c),A(t,d),h||(f=[V(n,"change",e[5]),V(n,"change",e[4])],h=!0)},p(e,t){1&t&&i!==(i="action-"+e[0]+"_"+e[10].key)&&q(n,"id",i),1&t&&a!==(a="action-"+e[0]+"_status")&&q(n,"name",a),2&t&&(n.checked=n.__value===e[1]),1&t&&l!==(l="action-"+e[0]+"_"+e[10].key)&&q(o,"for",l)},d(r){r&&B(t),e[6][0].splice(e[6][0].indexOf(n),1),h=!1,E(f)}}}function Pe(e){let t,n,r=e[2],i=[];for(let t=0;t<r.length;t+=1)i[t]=ze(Ie(e,r,t));return{c(){t=T("form"),n=T("fieldset");for(let e=0;e<i.length;e+=1)i[e].c();q(n,"class","flex status"),q(n,"data-action-id",e[0]),q(t,"class","lg:col-span-5 lg:col-end-13 grid justify-items-end")},m(e,r){L(e,t,r),A(t,n);for(let e=0;e<i.length;e+=1)i[e].m(n,null)},p(e,[t]){if(31&t){let a;for(r=e[2],a=0;a<r.length;a+=1){const s=Ie(e,r,a);i[a]?i[a].p(s,t):(i[a]=ze(s),i[a].c(),i[a].m(n,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=r.length}1&t&&q(n,"data-action-id",e[0])},i:x,o:x,d(e){e&&B(t),N(i,e)}}}function Ae(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};let{actionId:a}=t;const o=i();let c="pas_faite";return r(void 0,void 0,void 0,(function*(){const e=yield p.retrieveById(`${o}/${a}`);e&&n(1,c=e.avancement)})),e.$$set=e=>{"actionId"in e&&n(0,a=e.actionId)},[a,c,[{key:"non_concernee",label:"Non concernée"},{key:"pas_faite",label:"Pas faite"},{key:"programmee",label:"Prévue"},{key:"en_cours",label:"En cours"},{key:"faite",label:"Faite"}],["border rounded-l flex-1 block whitespace-nowrap px-2 py-1 cursor-pointer border-gray-400","border-t border-r border-b flex-1 block whitespace-nowrap px-2 py-1 cursor-pointer border-gray-400","border-t border-r border-b flex-1 block whitespace-nowrap px-2 py-1 cursor-pointer border-gray-400","border-t border-r border-b rounded-r flex-1 block whitespace-nowrap px-2 py-1 cursor-pointer border-gray-400"],e=>{const t=new s({epci_id:o,action_id:a,avancement:c});p.store(t)},function(){c=this.__value,n(1,c)},[[]]]}const Le=class extends de{constructor(e){super(),ue(this,e,Ae,Pe,z,{actionId:0})}};function Be(e){let t,n,r,i,a,s,o,c,l,u,d,h,f,p,m,g,$=e[0].name+"",y=e[0].description+"";return h=new Ee({props:{label:"Supprimer",colorVariant:"bramble",size:"small",classNames:""}}),h.$on("click",e[1]),p=new Le({props:{actionId:e[0].uid}}),{c(){t=T("section"),n=T("div"),r=T("h3"),i=S($),a=j(),s=T("details"),o=T("summary"),o.textContent="Plus",c=j(),l=T("div"),u=S(y),d=j(),oe(h.$$.fragment),f=j(),oe(p.$$.fragment),q(r,"class","pr-28"),q(o,"class","border border-gray-400 rounded px-2 py-1 absolute top-0\r\n         right-0 cursor-pointer hover:bg-gray-200"),q(l,"class","details-content whitespace-pre"),q(s,"class","expandable"),q(n,"class","relative lg:col-span-7"),q(t,"class","p-4 rounded my-4 action grid grid-cols-1 lg:grid-cols-12 lg:gap-4 bg-white "),q(t,"id",m="action-"+e[0].uid)},m(e,m){L(e,t,m),A(t,n),A(n,r),A(r,i),A(n,a),A(n,s),A(s,o),A(s,c),A(s,l),A(l,u),A(s,d),ce(h,s,null),A(t,f),ce(p,t,null),g=!0},p(e,[n]){(!g||1&n)&&$!==($=e[0].name+"")&&H(i,$),(!g||1&n)&&y!==(y=e[0].description+"")&&H(u,y);const r={};1&n&&(r.actionId=e[0].uid),p.$set(r),(!g||1&n&&m!==(m="action-"+e[0].uid))&&q(t,"id",m)},i(e){g||(ae(h.$$.fragment,e),ae(p.$$.fragment,e),g=!0)},o(e){se(h.$$.fragment,e),se(p.$$.fragment,e),g=!1},d(e){e&&B(t),le(h),le(p)}}}function Ne(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};let{action:i}=t;const a=function(){const e=function(){if(!F)throw new Error("Function called outside component initialization");return F}();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const i=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach((t=>{t.call(e,i)}))}}}();return e.$$set=e=>{"action"in e&&n(0,i=e.action)},[i,e=>r(void 0,void 0,void 0,(function*(){e.preventDefault(),confirm("Êtes-vous sûr•e de vouloir supprimer une de vos actions personnalisées ?")&&(yield m.deleteById(i.id),a("delete",i.id))}))]}const Te=class extends de{constructor(e){super(),ue(this,e,Ne,Be,z,{action:0})}};function Se(e,t,n){const r=e.slice();return r[8]=t[n],r}function je(e){let t,n,r,i;return t=new pe({props:{name:e[0].name,classNames:"flex-grow"}}),r=new Ee({props:{asLink:!0,label:"Ajouter une action",href:"action_ajout.html?epci_id="+e[2]+"&mesure_uid="+e[0].uid}}),{c(){oe(t.$$.fragment),n=j(),oe(r.$$.fragment)},m(e,a){ce(t,e,a),L(e,n,a),ce(r,e,a),i=!0},p(e,n){const i={};1&n&&(i.name=e[0].name),t.$set(i);const a={};1&n&&(a.href="action_ajout.html?epci_id="+e[2]+"&mesure_uid="+e[0].uid),r.$set(a)},i(e){i||(ae(t.$$.fragment,e),ae(r.$$.fragment,e),i=!0)},o(e){se(t.$$.fragment,e),se(r.$$.fragment,e),i=!1},d(e){le(t,e),e&&B(n),le(r,e)}}}function Ve(e){let t,n;return t=new Te({props:{action:e[8]}}),t.$on("delete",e[3]),{c(){oe(t.$$.fragment)},m(e,r){ce(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.action=e[8]),t.$set(r)},i(e){n||(ae(t.$$.fragment,e),n=!0)},o(e){se(t.$$.fragment,e),n=!1},d(e){le(t,e)}}}function qe(e){let t,n,r,i,a,s;t=new _e({});let o=null!=e[0]&&je(e),c=e[1],l=[];for(let t=0;t<c.length;t+=1)l[t]=Ve(Se(e,c,t));const u=e=>se(l[e],1,1,(()=>{l[e]=null}));return{c(){oe(t.$$.fragment),n=j(),r=T("main"),i=T("header"),o&&o.c(),a=j();for(let e=0;e<l.length;e+=1)l[e].c();q(i,"class","flex my-10"),q(r,"class","container mx-auto lg:px-20 px-4"),q(r,"id","mesure-6.5.5")},m(e,c){ce(t,e,c),L(e,n,c),L(e,r,c),A(r,i),o&&o.m(i,null),A(r,a);for(let e=0;e<l.length;e+=1)l[e].m(r,null);s=!0},p(e,[t]){if(null!=e[0]?o?(o.p(e,t),1&t&&ae(o,1)):(o=je(e),o.c(),ae(o,1),o.m(i,null)):o&&(re(),se(o,1,1,(()=>{o=null})),ie()),10&t){let n;for(c=e[1],n=0;n<c.length;n+=1){const i=Se(e,c,n);l[n]?(l[n].p(i,t),ae(l[n],1)):(l[n]=Ve(i),l[n].c(),ae(l[n],1),l[n].m(r,null))}for(re(),n=c.length;n<l.length;n+=1)u(n);ie()}},i(e){if(!s){ae(t.$$.fragment,e),ae(o);for(let e=0;e<c.length;e+=1)ae(l[e]);s=!0}},o(e){se(t.$$.fragment,e),se(o),l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)se(l[e]);s=!1},d(e){le(t,e),e&&B(n),e&&B(r),o&&o.d(),N(l,e)}}}function He(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function o(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}c((r=r.apply(e,t||[])).next())}))};const a=i(),s=(e=>{e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))})("mesure_uid"),o=d.buildId(a,s);let c,l=[];const u=()=>r(void 0,void 0,void 0,(function*(){n(1,l=yield m.retrieveAtPath(`${a}/${s}`))}));return r(void 0,void 0,void 0,(function*(){n(0,c=yield g.retrieveById(o)),yield u()})),[c,l,a,u]}new class extends de{constructor(e){super(),ue(this,e,He,qe,z,{})}}({target:document.body})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL3N0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3ZlbmRvcnMvaW5kaWNhdGV1cl92YWx1ZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvc3RvcmFibGVzL0luZGljYXRldXJWYWx1ZVN0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9hcGkvYXBpU3RvcmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9jdXJyZW50RXBjaS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXMudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9jdXN0b20udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25DdXN0b21TdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL2N1cnJlbnRBUEkudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9oeWJyaWRTdG9yZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvY29tcG9uZW50cy9sZWdhY3kvc3RhdHVzUGlja2VyLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL2xlZ2FjeS9tZXN1cmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvckZvcm0udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvcnNMaXN0LnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL3NoYXJlZC9UaXRsZS5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vdmVuZG9ycy9lcGNpc19kZWZhdWx0LnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL3NoYXJlZC9FcGNpTmF2RGlzcGxheS5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvc2hhcmVkL05hdi5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvc2hhcmVkL0J1dHRvbi5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvYWN0aW9ucy9BY3Rpb25TdGF0dXMuc3ZlbHRlIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL2FjdGlvbnMvQWN0aW9uLnN2ZWx0ZSIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvY29tcG9uZW50cy9tZXN1cmVzL01lc3VyZUN1c3RvbVBhZ2Uuc3ZlbHRlIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy91dGlscy91cmwudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL21lc3VyZV9wZXJzb25uYWxpc2VlLnRzIl0sIm5hbWVzIjpbImlzU3RvcmFibGUiLCJzdG9yYWJsZSIsInVuZGVmaW5lZCIsImlkIiwicGF0aG5hbWUiLCJJbmRpY2F0ZXVyVmFsdWUiLCJlcGNpX2lkIiwiaW5kaWNhdGV1cl9pZCIsInllYXIiLCJ2YWx1ZSIsInRoaXMiLCJJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZSIsImJ1aWxkSWQiLCJBUElTdG9yZSIsImhvc3QiLCJlbmRwb2ludCIsInNlcmlhbGl6ZXIiLCJkZXNlcmlhbGl6ZXIiLCJFcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJtb2RlIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJqc29uIiwicmV0cmlldmVBdFBhdGgiLCJyZXRyaWV2ZUJ5UGF0aCIsInBhdGgiLCJzdGF0dXMiLCJkYXRhIiwicmVzdWx0cyIsImkiLCJsZW5ndGgiLCJwdXNoIiwiZ2V0Q3VycmVudEVwY2lJZCIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiZ2V0IiwiQWN0aW9uU3RhdHVzIiwiYWN0aW9uX2lkIiwiYXZhbmNlbWVudCIsIkFjdGlvblN0YXR1c1N0b3JhYmxlIiwiQWN0aW9uQ3VzdG9tIiwidWlkIiwibWVzdXJlX2lkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwiQWN0aW9uQ3VzdG9tU3RvcmFibGUiLCJnZXRDdXJyZW50QVBJIiwiaG9zdG5hbWUiLCJzdWJzdHJpbmciLCJNZXN1cmVDdXN0b20iLCJjbGltYXRfcHJhdGljX3RoZW1hdGljX2lkIiwiTWVzdXJlQ3VzdG9tU3RvcmFibGUiLCJIeWJyaWRTdG9yZSIsImNhY2hlIiwicmV0cmlldmluZyIsImFwaSIsInN0b3JlZCIsInN0b3JlIiwid3JpdGVJbkNhY2hlIiwiZ2V0Q2FjaGUiLCJzdGFydHNXaXRoIiwiZGVsZXRlZCIsImRlbGV0ZUJ5SWQiLCJzdHJpcElkIiwiZmlsdGVyIiwiY2FjaGVkIiwic3BsaXQiLCJtYXRjaCIsInNsaWNlIiwiam9pbiIsInJlbW92ZUZyb21DYWNoZSIsImZpbHRlcmVkIiwicmV0cmlldmVBbGwiLCJ0aGVuIiwicmV0cmlldmVkIiwiaW5kaWNhdGV1clZhbHVlU3RvcmUiLCJzZXJpYWxpemVkIiwiYWN0aW9uU3RhdHVzU3RvcmUiLCJhY3Rpb25DdXN0b21TdG9yZSIsIm1lc3VyZUN1c3RvbVN0b3JlIiwiZWNwaUlkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJhY3Rpb25JZCIsImRhdGFzZXQiLCJpbnB1dHMiLCJvbkNoYW5nZSIsImV2ZW50IiwiYWN0aW9uQXZhbmNlbWVudEtleSIsInRhcmdldCIsImlucHV0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImFkZExpc3RlbmVycyIsImFzeW5jIiwicmV0cmlldmVCeUlkIiwiZSIsInNlbGVjdGVkSW5wdXRJZCIsImNoZWNrZWQiLCJjaGVja0lucHV0IiwiaW5pdCIsInByZXZlbnREZWZhdWx0Iiwib25CbHVyIiwiaW5wdXRQcm9wZXJ0aWVzIiwiY3VycmVudEVwY2lJZCIsIm9uS2V5UHJlc3MiLCJrZXkiLCJibHVyIiwiaW5pdFllYXJseUlucHV0IiwiaW5kaWNhdG9ySWQiLCJpbmRpY2F0b3JZZWFyIiwibm9vcCIsInJ1biIsImZuIiwiYmxhbmtfb2JqZWN0IiwiT2JqZWN0IiwiY3JlYXRlIiwicnVuX2FsbCIsImZucyIsImlzX2Z1bmN0aW9uIiwidGhpbmciLCJzYWZlX25vdF9lcXVhbCIsImEiLCJiIiwiaXNfZW1wdHkiLCJvYmoiLCJrZXlzIiwiYXBwZW5kIiwibm9kZSIsImFwcGVuZENoaWxkIiwiaW5zZXJ0IiwiYW5jaG9yIiwiaW5zZXJ0QmVmb3JlIiwiZGV0YWNoIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiZGVzdHJveV9lYWNoIiwiaXRlcmF0aW9ucyIsImRldGFjaGluZyIsImQiLCJjcmVhdGVFbGVtZW50IiwiY3JlYXRlVGV4dE5vZGUiLCJzcGFjZSIsImxpc3RlbiIsImhhbmRsZXIiLCJvcHRpb25zIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImF0dHIiLCJhdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJnZXRBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzZXRfZGF0YSIsInRleHQiLCJ3aG9sZVRleHQiLCJ0b2dnbGVfY2xhc3MiLCJ0b2dnbGUiLCJjbGFzc0xpc3QiLCJjdXJyZW50X2NvbXBvbmVudCIsInNldF9jdXJyZW50X2NvbXBvbmVudCIsImNvbXBvbmVudCIsImZvcm0iLCJlcGNpSWQiLCJpbmRpY2F0ZXVyVmFsdWVzIiwiaW5kaWNhdGV1clZhbHVlIiwiU2V0IiwiZGlydHlfY29tcG9uZW50cyIsImJpbmRpbmdfY2FsbGJhY2tzIiwicmVuZGVyX2NhbGxiYWNrcyIsImZsdXNoX2NhbGxiYWNrcyIsInJlc29sdmVkX3Byb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInVwZGF0ZV9zY2hlZHVsZWQiLCJhZGRfcmVuZGVyX2NhbGxiYWNrIiwiZmx1c2hpbmciLCJzZWVuX2NhbGxiYWNrcyIsImZsdXNoIiwidXBkYXRlIiwiJCQiLCJwb3AiLCJjYWxsYmFjayIsImhhcyIsImFkZCIsImNsZWFyIiwiZnJhZ21lbnQiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJwIiwiY3R4IiwiYWZ0ZXJfdXBkYXRlIiwib3V0cm9pbmciLCJvdXRyb3MiLCJTdmVsdGVFbGVtZW50IiwiZ3JvdXBfb3V0cm9zIiwiciIsImMiLCJjaGVja19vdXRyb3MiLCJ0cmFuc2l0aW9uX2luIiwiYmxvY2siLCJsb2NhbCIsImRlbGV0ZSIsInRyYW5zaXRpb25fb3V0IiwibyIsImNyZWF0ZV9jb21wb25lbnQiLCJtb3VudF9jb21wb25lbnQiLCJvbl9tb3VudCIsIm9uX2Rlc3Ryb3kiLCJtIiwibmV3X29uX2Rlc3Ryb3kiLCJtYXAiLCJkZXN0cm95X2NvbXBvbmVudCIsImluc3RhbmNlIiwiY3JlYXRlX2ZyYWdtZW50Iiwibm90X2VxdWFsIiwicHJvcHMiLCJwYXJlbnRfY29tcG9uZW50IiwiYm91bmQiLCJjb250ZXh0IiwiTWFwIiwiY2FsbGJhY2tzIiwic2tpcF9ib3VuZCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGROb2RlcyIsImwiLCJpbnRybyIsImdsb2JhbFRoaXMiLCJnbG9iYWwiLCJIVE1MRWxlbWVudCIsInN1cGVyIiwiYXR0YWNoU2hhZG93Iiwic2xvdHRlZCIsIl9vbGRWYWx1ZSIsIm5ld1ZhbHVlIiwiJGRlc3Ryb3kiLCJ0eXBlIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiJCRwcm9wcyIsIiQkc2V0IiwiU3ZlbHRlQ29tcG9uZW50IiwiY2xhc3NOYW1lcyIsImVwY2lzX2RlZmF1bHQiLCJjb2xvclZhcmlhbnRzIiwic2l6ZXMiLCJsYWJlbCIsImZ1bGwiLCJjb2xvclZhcmlhbnQiLCJzaXplIiwiYXNMaW5rIiwiaHJlZiIsImJ1dHRvbkNsYXNzTmFtZXMiLCJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJzdGVwIiwibmV4dCIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsImFwcGx5IiwiXyIsImFjdGlvbiIsImRpc3BhdGNoIiwiZ2V0X2N1cnJlbnRfY29tcG9uZW50IiwiZGV0YWlsIiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJjdXN0b21fZXZlbnQiLCJjYWxsIiwiY3JlYXRlRXZlbnREaXNwYXRjaGVyIiwiY29uZmlybSIsIm1lc3VyZVVpZCIsInJlcGxhY2UiLCJSZWdFeHAiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZ2V0VXJsUGFyYW1ldGVyIiwibWVzdXJlSWQiLCJtZXN1cmUiLCJhY3Rpb25zIiwidXBkYXRlQWN0aW9ucyJdLCJtYXBwaW5ncyI6Im1CQVdPLE1BQU1BLEVBQWNDLEdBQ2FDLE1BQTVCRCxFQUFzQkUsSUFBc0RELE1BQWxDRCxFQUFzQkcsU0NMckUsTUFBTUMsRUFhVCxhQUFZLFFBQ1JDLEVBQU8sY0FDUEMsRUFBYSxLQUNiQyxFQUFJLE1BQ0pDLElBT0FDLEtBQUtKLFFBQVVBLEVBQ2ZJLEtBQUtILGNBQWdCQSxFQUNyQkcsS0FBS0YsS0FBT0EsRUFDWkUsS0FBS0QsTUFBUUEsRUF6QmpCLGVBQ0ksT0FBT0osRUFBZ0JELFVBRmIsRUFBQUEsU0FBbUIsbUJDTjlCLE1BQU1PLFVBQWdDTixFQUN6QyxlQUFlQyxFQUFpQkMsRUFBdUJDLEdBQ25ELE1BQU8sR0FBR0YsS0FBV0MsS0FBaUJDLElBRzFDLFNBQ0ksT0FBT0csRUFBd0JDLFFBQVFGLEtBQUtKLFFBQVNJLEtBQUtILGNBQWVHLEtBQUtGLE9DSC9FLE1BQU1LLEVBQ1QsYUFDSSxLQUNJQyxFQUFJLFNBQ0pDLEVBQVEsV0FDUkMsRUFBVSxhQUNWQyxJQU9KUCxLQUFLSSxLQUFPQSxFQUNaSixLQUFLTixTQUFXVyxFQUNoQkwsS0FBS00sV0FBYUEsRUFDbEJOLEtBQUtPLGFBQWVBLEVBY3hCLFlBQVloQixHQUNSLElBQUtELEVBQVdDLEdBQ1osTUFBTSxJQUFJaUIsYUFBZ0JqQixFQUFWLHFCQUdwQixNQUFNa0IsUUFBaUJDLE1BQU0sR0FBR1YsS0FBS0ksUUFBUUosS0FBS04sWUFBYSxDQUMzRGlCLE9BQVEsT0FDUkMsS0FBTSxPQUNOQyxLQUFNQyxLQUFLQyxVQUFVZixLQUFLTSxXQUFXZixNQUd6QyxP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U0FBV3JQLEVBQU8sYUFDckJzUCxLQUFLaFEsU0FBU0MsUUFFcEMsT0FBbUIsT0FBWlIsRUFBbUIsR0FBS3dRLG1CQUFtQnhRLEVBQVEsR0FBR3FRLFFBQVEsTUFBTyxPRGM1REksQ0FBZ0IsY0FDNUJDLEVBQVdqUCxFQUFxQjdDLFFBQVEwRSxFQUFROE0sRyxJQUNsRE8sRUFDQUMsRUFBVSxHLE1BQ1JDLEVBQWdCLElBQU1qQyxPQUFVLE9BQVEsT0FBUSxHQUFRLFksSUFDMURnQyxRQUFnQnhOLEVBQWtCekQsZUFBZSxHQUFHMkQsS0FBVThNLFMsT0FFOUN4QixPQUFVLE9BQVEsT0FBUSxHQUFRLFksSUFDbEQrQixRQUFldE4sRUFBa0JpQixhQUFhb00sVUFDeENHLE8sVUV2QlcsSSxnRUFBcUIsQ0FFeEM1TSxPQUFRVixTQUFTaEUsUSIsImZpbGUiOiJtZXN1cmVfcGVyc29ubmFsaXNlZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEYXRhIHRoYXQgY2FuIGJlIHN0b3JlZCBhdCBwYXRoL2lkLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTdG9yYWJsZSB7XHJcbiAgICBpZDogc3RyaW5nLFxyXG4gICAgcGF0aG5hbWU6IHN0cmluZyxcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0b3JhYmxlIHR5cGUgZ3VhcmQuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgaXNTdG9yYWJsZSA9IChzdG9yYWJsZTogYW55KTogc3RvcmFibGUgaXMgU3RvcmFibGUgPT4ge1xyXG4gICAgcmV0dXJuIChzdG9yYWJsZSBhcyBTdG9yYWJsZSkuaWQgIT0gdW5kZWZpbmVkICYmIChzdG9yYWJsZSBhcyBTdG9yYWJsZSkucGF0aG5hbWUgIT0gdW5kZWZpbmVkXHJcbn1cclxuIiwiZXhwb3J0IGludGVyZmFjZSBJbmRpY2F0ZXVyVmFsdWVJbnRlcmZhY2Uge1xyXG4gICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIGluZGljYXRldXJfaWQ6IHN0cmluZyxcclxuICAgICAgICB5ZWFyOiBudW1iZXIsXHJcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEluZGljYXRldXJWYWx1ZSB7XHJcbiAgICBwdWJsaWMgc3RhdGljIHBhdGhuYW1lOiBzdHJpbmcgPSAnaW5kaWNhdGV1cl92YWx1ZSc7XHJcbiAgICBnZXQgcGF0aG5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gSW5kaWNhdGV1clZhbHVlLnBhdGhuYW1lO1xyXG4gICAgfVxyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgaW5kaWNhdGV1cl9pZDogc3RyaW5nO1xyXG4gICAgeWVhcjogbnVtYmVyO1xyXG4gICAgdmFsdWU6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBJbmRpY2F0ZXVyVmFsdWUgaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIGluZGljYXRldXJfaWQsXHJcbiAgICAgICAgeWVhcixcclxuICAgICAgICB2YWx1ZSxcclxuICAgIH06IHtcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZDogc3RyaW5nLFxyXG4gICAgICAgIHllYXI6IG51bWJlcixcclxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxyXG4gICAgfSkge1xyXG4gICAgICAgIHRoaXMuZXBjaV9pZCA9IGVwY2lfaWQ7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0ZXVyX2lkID0gaW5kaWNhdGV1cl9pZDtcclxuICAgICAgICB0aGlzLnllYXIgPSB5ZWFyO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7SW5kaWNhdGV1clZhbHVlfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9pbmRpY2F0ZXVyX3ZhbHVlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSW5kaWNhdGV1clZhbHVlU3RvcmFibGUgZXh0ZW5kcyBJbmRpY2F0ZXVyVmFsdWUge1xyXG4gICAgc3RhdGljIGJ1aWxkSWQoZXBjaV9pZDogc3RyaW5nLCBpbmRpY2F0ZXVyX2lkOiBzdHJpbmcsIHllYXI6IG51bWJlcikgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHtlcGNpX2lkfS8ke2luZGljYXRldXJfaWR9LyR7eWVhcn1gXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEluZGljYXRldXJWYWx1ZVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLmluZGljYXRldXJfaWQsIHRoaXMueWVhcilcclxuICAgIH1cclxufSIsImltcG9ydCB7aXNTdG9yYWJsZX0gZnJvbSBcIi4vc3RvcmFibGVcIjtcclxuXHJcbi8qKlxyXG4gKiBBIFN0b3JlIGZvciBTdG9yYWJsZSBvYmplY3QgdXNpbmcgYSByZW1vdGUgYXBpXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQVBJU3RvcmU8VD4ge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBob3N0LFxyXG4gICAgICAgICAgICBlbmRwb2ludCxcclxuICAgICAgICAgICAgc2VyaWFsaXplcixcclxuICAgICAgICAgICAgZGVzZXJpYWxpemVyLFxyXG4gICAgICAgIH06IHtcclxuICAgICAgICAgICAgaG9zdDogc3RyaW5nLFxyXG4gICAgICAgICAgICBlbmRwb2ludDogc3RyaW5nLFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyOiAoc3RvcmFibGU6IFQpID0+IG9iamVjdCxcclxuICAgICAgICAgICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZDogb2JqZWN0KSA9PiBULFxyXG4gICAgICAgIH0pIHtcclxuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xyXG4gICAgICAgIHRoaXMucGF0aG5hbWUgPSBlbmRwb2ludDtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHRoaXMuZGVzZXJpYWxpemVyID0gZGVzZXJpYWxpemVyO1xyXG4gICAgfVxyXG5cclxuICAgIGhvc3Q6IHN0cmluZztcclxuICAgIHBhdGhuYW1lOiBzdHJpbmc7XHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGU6IFQpID0+IG9iamVjdDtcclxuICAgIGRlc2VyaWFsaXplcjogKHNlcmlhbGl6ZWQ6IG9iamVjdCkgPT4gVDtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9yZSBhIFN0b3JhYmxlIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdG9yYWJsZSB0aGUgb2JqZWN0IHRvIHNhdmVcclxuICAgICAqL1xyXG4gICAgYXN5bmMgc3RvcmUoc3RvcmFibGU6IFQpOiBQcm9taXNlPFQ+IHtcclxuICAgICAgICBpZiAoIWlzU3RvcmFibGUoc3RvcmFibGUpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0eXBlb2Ygc3RvcmFibGV9IGlzIG5vdCBzdG9yYWJsZS5gKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmhvc3R9LyR7dGhpcy5wYXRobmFtZX0vYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLnNlcmlhbGl6ZXIoc3RvcmFibGUpKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kZXNlcmlhbGl6ZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhbGwgc3RvcmFibGUgb2YgdHlwZSBUIGV4aXN0aW5nIGF0IHBhdGhuYW1lLlxyXG4gICAgICogSWYgbm90aGluZyBpcyBmb3VuZCByZXR1cm5zIGFuIGVtcHR5IHJlY29yZC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVBbGwoKTogUHJvbWlzZTxBcnJheTxUPj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlQXRQYXRoKCdhbGwnKVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGEgc3RvcmFibGUgd2l0aCBtYXRjaGluZyBwYXRoIGFuZCBwYXRoLlxyXG4gICAgICogVGhyb3cgaWYgbm8gc3RvcmFibGUgaXMgZm91bmQgb3IgcGF0aCBkb2VzIG5vdCBleGlzdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgU3RvcmFibGUgaWRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVCeVBhdGgoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJldHJpZXZlQnlQYXRoKHBhdGg6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuaG9zdH0vJHt0aGlzLnBhdGhuYW1lfS8ke3BhdGh9YCwge1xyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNDA0KSByZXR1cm4gbnVsbDtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZXNlcmlhbGl6ZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyByZXRyaWV2ZUF0UGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmhvc3R9LyR7dGhpcy5wYXRobmFtZX0vJHtwYXRofWAsIHtcclxuICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxyXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0aGlzLmRlc2VyaWFsaXplcihkYXRhW2ldKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlbGV0ZSBhIFN0b3JhYmxlIHN0b3JlZCBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqIFJldHVybiB0cnVlIGlmIHNvbWV0aGluZyB3YXMgZGVsZXRlZCwgZmFsc2UgaWYgbm90aGluZyBleGlzdHMgYXQgcGF0aG5hbWUvaWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkIFN0b3JhYmxlIGlkXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGRlbGV0ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5ob3N0fS8ke3RoaXMucGF0aG5hbWV9LyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMgPT0gMjAwO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBnZXRDdXJyZW50RXBjaUlkID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpXHJcbiAgICBjb25zdCBpZCA9IHVybFBhcmFtcy5nZXQoJ2VwY2lfaWQnKVxyXG5cclxuICAgIGlmICghaWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BhcmFtZXRlciBlcGNpX2lkIGlzIGVtcHR5LicpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGlkXHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIEFjdGlvblN0YXR1c0ludGVyZmFjZSB7XHJcbiAgICBhY3Rpb25faWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgYXZhbmNlbWVudDogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aW9uU3RhdHVzIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcGF0aG5hbWU6IHN0cmluZyA9ICdhY3Rpb25fc3RhdHVzJztcclxuICAgIGdldCBwYXRobmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBBY3Rpb25TdGF0dXMucGF0aG5hbWU7XHJcbiAgICB9XHJcbiAgICBhY3Rpb25faWQ6IHN0cmluZztcclxuICAgIGVwY2lfaWQ6IHN0cmluZztcclxuICAgIGF2YW5jZW1lbnQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBBY3Rpb25TdGF0dXMgaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICBhY3Rpb25faWQsXHJcbiAgICAgICAgZXBjaV9pZCxcclxuICAgICAgICBhdmFuY2VtZW50LFxyXG4gICAgfToge1xyXG4gICAgICAgIGFjdGlvbl9pZDogc3RyaW5nLFxyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBhdmFuY2VtZW50OiBzdHJpbmcsXHJcbiAgICB9KSB7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25faWQgPSBhY3Rpb25faWQ7XHJcbiAgICAgICAgdGhpcy5lcGNpX2lkID0gZXBjaV9pZDtcclxuICAgICAgICB0aGlzLmF2YW5jZW1lbnQgPSBhdmFuY2VtZW50O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtBY3Rpb25TdGF0dXN9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25TdGF0dXNTdG9yYWJsZSBleHRlbmRzIEFjdGlvblN0YXR1cyB7XHJcbiAgICBzdGF0aWMgYnVpbGRJZChlcGNpX2lkOiBzdHJpbmcsIGFjdGlvbl9pZDogc3RyaW5nKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7YWN0aW9uX2lkfWA7XHJcbiAgICB9XHJcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQWN0aW9uU3RhdHVzU3RvcmFibGUuYnVpbGRJZCh0aGlzLmVwY2lfaWQsIHRoaXMuYWN0aW9uX2lkKVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBBY3Rpb25DdXN0b21JbnRlcmZhY2Uge1xyXG4gICAgdWlkOiBzdHJpbmcsXHJcbiAgICAgICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIG1lc3VyZV9pZDogc3RyaW5nLFxyXG4gICAgICAgIG5hbWU6IHN0cmluZyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aW9uQ3VzdG9tIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcGF0aG5hbWU6IHN0cmluZyA9ICdhY3Rpb25fY3VzdG9tJztcclxuICAgIGdldCBwYXRobmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBBY3Rpb25DdXN0b20ucGF0aG5hbWU7XHJcbiAgICB9XHJcbiAgICB1aWQ6IHN0cmluZztcclxuICAgIGVwY2lfaWQ6IHN0cmluZztcclxuICAgIG1lc3VyZV9pZDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBBY3Rpb25DdXN0b20gaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICB1aWQsXHJcbiAgICAgICAgZXBjaV9pZCxcclxuICAgICAgICBtZXN1cmVfaWQsXHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgIH06IHtcclxuICAgICAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbWVzdXJlX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICB9KSB7XHJcbiAgICAgICAgdGhpcy51aWQgPSB1aWQ7XHJcbiAgICAgICAgdGhpcy5lcGNpX2lkID0gZXBjaV9pZDtcclxuICAgICAgICB0aGlzLm1lc3VyZV9pZCA9IG1lc3VyZV9pZDtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgIH1cclxufSIsImltcG9ydCB7QWN0aW9uQ3VzdG9tfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9hY3Rpb25fY3VzdG9tXCI7XHJcblxyXG5leHBvcnQgIGNsYXNzIEFjdGlvbkN1c3RvbVN0b3JhYmxlIGV4dGVuZHMgQWN0aW9uQ3VzdG9tIHtcclxuICAgIHN0YXRpYyBidWlsZElkKGVwY2lfaWQ6IHN0cmluZywgbWVzdXJlX2lkOiBzdHJpbmcsIHVpZDogc3RyaW5nKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7bWVzdXJlX2lkfS8ke3VpZH1gXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEFjdGlvbkN1c3RvbVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLm1lc3VyZV9pZCwgdGhpcy51aWQpXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY29uc3QgZ2V0Q3VycmVudEFQSSA9ICgpOiBzdHJpbmcgPT4ge1xyXG4gICAgY29uc3QgaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7XHJcbiAgICBpZiAoaG9zdG5hbWUuc3Vic3RyaW5nKDAsIDEwKSA9PT0gJ2xvY2FsaG9zdCcpIHJldHVybiAnaHR0cDovL2xvY2FsaG9zdDo4MDAwJztcclxuICAgIGlmIChob3N0bmFtZSA9PT0gJ3NhbmRib3gudGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyJykgcmV0dXJuICdodHRwczovL3NhbmRib3h0ZXJyaXRvaXJlcy5vc2MtZnIxLnNjYWxpbmdvLmlvJ1xyXG4gICAgaWYgKGhvc3RuYW1lID09PSAnc3RhZ2luZy50ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnInKSByZXR1cm4gJ2h0dHBzOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLm9zYy1mcjEuc2NhbGluZ28uaW8nXHJcbiAgICB0aHJvdyBgbm8gQVBJIGhvc3QgZm9yICR7aG9zdG5hbWV9YFxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBNZXN1cmVDdXN0b21JbnRlcmZhY2Uge1xyXG4gICAgdWlkOiBzdHJpbmcsXHJcbiAgICAgICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQ6IHN0cmluZyxcclxuICAgICAgICBuYW1lOiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNZXN1cmVDdXN0b20ge1xyXG4gICAgcHVibGljIHN0YXRpYyBwYXRobmFtZTogc3RyaW5nID0gJ21lc3VyZV9jdXN0b20nO1xyXG4gICAgZ2V0IHBhdGhuYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIE1lc3VyZUN1c3RvbS5wYXRobmFtZTtcclxuICAgIH1cclxuICAgIHVpZDogc3RyaW5nO1xyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIE1lc3VyZUN1c3RvbSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioe1xyXG4gICAgICAgIHVpZCxcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQsXHJcbiAgICAgICAgbmFtZSxcclxuICAgIH06IHtcclxuICAgICAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDogc3RyaW5nLFxyXG4gICAgICAgIG5hbWU6IHN0cmluZyxcclxuICAgIH0pIHtcclxuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcclxuICAgICAgICB0aGlzLmVwY2lfaWQgPSBlcGNpX2lkO1xyXG4gICAgICAgIHRoaXMuY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZCA9IGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQ7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7TWVzdXJlQ3VzdG9tfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWVzdXJlQ3VzdG9tU3RvcmFibGUgZXh0ZW5kcyBNZXN1cmVDdXN0b20ge1xyXG4gICAgc3RhdGljIGJ1aWxkSWQoZXBjaV9pZDogc3RyaW5nLCB1aWQ6IHN0cmluZykgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHtlcGNpX2lkfS8ke3VpZH1gO1xyXG4gICAgfVxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIE1lc3VyZUN1c3RvbVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLnVpZClcclxuICAgIH1cclxufSIsImltcG9ydCB7aXNTdG9yYWJsZSwgU3RvcmFibGV9IGZyb20gXCIuL3N0b3JhYmxlXCI7XHJcbmltcG9ydCB7SW5kaWNhdGV1clZhbHVlU3RvcmFibGV9IGZyb20gXCIuLi9zdG9yYWJsZXMvSW5kaWNhdGV1clZhbHVlU3RvcmFibGVcIjtcclxuaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWUsIEluZGljYXRldXJWYWx1ZUludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvaW5kaWNhdGV1cl92YWx1ZVwiO1xyXG5pbXBvcnQge0FQSVN0b3JlfSBmcm9tIFwiLi9hcGlTdG9yZVwiO1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuL2N1cnJlbnRFcGNpXCI7XHJcbmltcG9ydCB7QWN0aW9uU3RhdHVzLCBBY3Rpb25TdGF0dXNJbnRlcmZhY2V9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXNcIjtcclxuaW1wb3J0IHtBY3Rpb25TdGF0dXNTdG9yYWJsZX0gZnJvbSBcIi4uL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZVwiO1xyXG5pbXBvcnQge0FjdGlvbkN1c3RvbVN0b3JhYmxlfSBmcm9tIFwiLi4vc3RvcmFibGVzL0FjdGlvbkN1c3RvbVN0b3JhYmxlXCI7XHJcbmltcG9ydCB7QWN0aW9uQ3VzdG9tLCBBY3Rpb25DdXN0b21JbnRlcmZhY2V9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9jdXN0b21cIjtcclxuaW1wb3J0IHtnZXRDdXJyZW50QVBJfSBmcm9tIFwiLi9jdXJyZW50QVBJXCI7XHJcbmltcG9ydCB7TWVzdXJlQ3VzdG9tU3RvcmFibGV9IGZyb20gXCIuLi9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGVcIjtcclxuaW1wb3J0IHtNZXN1cmVDdXN0b20sIE1lc3VyZUN1c3RvbUludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvbWVzdXJlX2N1c3RvbVwiO1xyXG5cclxuLyoqXHJcbiAqIEEgU3RvcmUgZm9yIFN0b3JhYmxlIG9iamVjdCB1c2luZyBhIHJlbW90ZSBhcGkgYW5kIGEgbG9jYWwgY2FjaGUuXHJcbiAqXHJcbiAqIFRoZSBsb2NhbCBjYWNoZSBpcyBrZXB0IGluIG1lbW9yeSBmb3Igbm93LlxyXG4gKi9cclxuY2xhc3MgSHlicmlkU3RvcmU8VCBleHRlbmRzIFN0b3JhYmxlPiB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhvc3QsXHJcbiAgICAgICAgICAgIGVuZHBvaW50LFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXIsXHJcbiAgICAgICAgfToge1xyXG4gICAgICAgICAgICBob3N0OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIGVuZHBvaW50OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZTogVCkgPT4gb2JqZWN0LFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkOiBvYmplY3QpID0+IFQsXHJcbiAgICAgICAgfSkge1xyXG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XHJcbiAgICAgICAgdGhpcy5wYXRobmFtZSA9IGVuZHBvaW50O1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5kZXNlcmlhbGl6ZXIgPSBkZXNlcmlhbGl6ZXI7XHJcblxyXG4gICAgICAgIHRoaXMuYXBpID0gbmV3IEFQSVN0b3JlPFQ+KHtcclxuICAgICAgICAgICAgaG9zdDogdGhpcy5ob3N0LFxyXG4gICAgICAgICAgICBlbmRwb2ludDogdGhpcy5wYXRobmFtZSxcclxuICAgICAgICAgICAgc2VyaWFsaXplcjogdGhpcy5zZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IHRoaXMuZGVzZXJpYWxpemVyXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgdG9kbyB1c2UgbG9jYWwgc3RvcmUgZm9yIGNhY2hpbmdcclxuICAgICAgICB0aGlzLmxvY2FsID0gbmV3IExvY2FsU3RvcmU8VD4oe1xyXG4gICAgICAgICAgICBwYXRobmFtZTogdGhpcy5wYXRobmFtZSxcclxuICAgICAgICAgICAgc2VyaWFsaXplcjogdGhpcy5zZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IHRoaXMuZGVzZXJpYWxpemVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgKi9cclxuICAgIH1cclxuXHJcbiAgICBob3N0OiBzdHJpbmc7XHJcbiAgICBwYXRobmFtZTogc3RyaW5nO1xyXG4gICAgc2VyaWFsaXplcjogKHN0b3JhYmxlOiBUKSA9PiBvYmplY3Q7XHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkOiBvYmplY3QpID0+IFQ7XHJcbiAgICBhcGk6IEFQSVN0b3JlPFQ+O1xyXG4gICAgcHJpdmF0ZSBjYWNoZTogVFtdIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgLy8gbG9jYWw6IExvY2FsU3RvcmU8VD47XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RvcmUgYSBTdG9yYWJsZSBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc3RvcmFibGUgdGhlIG9iamVjdCB0byBzYXZlXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHN0b3JlKHN0b3JhYmxlOiBUKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgaWYgKCFpc1N0b3JhYmxlKHN0b3JhYmxlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dHlwZW9mIHN0b3JhYmxlfSBpcyBub3Qgc3RvcmFibGUuYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHN0b3JlZCA9IGF3YWl0IHRoaXMuYXBpLnN0b3JlKHN0b3JhYmxlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy53cml0ZUluQ2FjaGUoc3RvcmVkKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYWxsIHN0b3JhYmxlIG9mIHR5cGUgVCBleGlzdGluZyBhdCBwYXRobmFtZS5cclxuICAgICAqIElmIG5vdGhpbmcgaXMgZm91bmQgcmV0dXJucyBhbiBlbXB0eSByZWNvcmQuXHJcbiAgICAgKi9cclxuICAgIHJldHJpZXZlQWxsKCk6IFByb21pc2U8QXJyYXk8VD4+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhIHN0b3JhYmxlIHdpdGggbWF0Y2hpbmcgaWQuXHJcbiAgICAgKiBUaHJvdyBpZiBubyBzdG9yYWJsZSBpcyBmb3VuZCBvciBwYXRoIGRvZXMgbm90IGV4aXN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZCBTdG9yYWJsZSBpZFxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZUJ5UGF0aChpZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYSBzdG9yYWJsZSB3aXRoIG1hdGNoaW5nIHBhdGguXHJcbiAgICAgKiBUaHJvdyBpZiBubyBzdG9yYWJsZSBpcyBmb3VuZCBvciBwYXRoIGRvZXMgbm90IGV4aXN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIFN0b3JhYmxlIHBhdGhcclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVCeVBhdGgocGF0aDogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGZvciAobGV0IHN0b3JhYmxlIG9mIGNhY2hlKSB7XHJcbiAgICAgICAgICAgIGlmIChzdG9yYWJsZS5pZC5zdGFydHNXaXRoKHBhdGgpKSByZXR1cm4gc3RvcmFibGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGFsbCBzdG9yYWJsZSBvZiB0eXBlIFQgZXhpc3RpbmcgYXQgcGF0aCB1bmRlciBwYXRobmFtZS5cclxuICAgICAqIElmIG5vdGhpbmcgaXMgZm91bmQgcmV0dXJucyBhbiBlbXB0eSBsaXN0LlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUF0UGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBzdG9yYWJsZSBvZiBjYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFibGUuaWQuc3RhcnRzV2l0aChwYXRoKSkgcmVzdWx0cy5wdXNoKHN0b3JhYmxlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVsZXRlIGEgU3RvcmFibGUgc3RvcmVkIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICogUmV0dXJuIHRydWUgaWYgc29tZXRoaW5nIHdhcyBkZWxldGVkLCBmYWxzZSBpZiBub3RoaW5nIGV4aXN0cyBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgU3RvcmFibGUgaWRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgZGVsZXRlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlZCA9IGF3YWl0IHRoaXMuYXBpLmRlbGV0ZUJ5SWQodGhpcy5zdHJpcElkKGlkKSk7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlLmZpbHRlcihjYWNoZWQgPT4gY2FjaGVkLmlkICE9PSBpZCk7XHJcbiAgICAgICAgcmV0dXJuIGRlbGV0ZWQ7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RyaXAgaWQgcmVtb3ZlcyByZWR1bmRhbnQgcGFydHMgc2hhcmVkIGJ5IHRoZSBpZCBhbmQgdGhlIGVuZHBvaW50LlxyXG4gICAgICpcclxuICAgICAqIEV4OiBpZiB0aGUgZW5kcG9pbnQgcGF0aCBpcyBgdjEvZW5kcG9pbnQvZXBjaV9pZC9gXHJcbiAgICAgKiBhbmQgdGhlIGlkIGlzIGBlcGNpX2lkL3BhcnRfYS9wYXJ0X2JgXHJcbiAgICAgKiB0aGUgcmVzdWx0aW5nIHN0cmlwcGVkIGlkIHdvdWxkIGJlIGBwYXJ0X2EvcGFydF9iYCxcclxuICAgICAqIGEgcGF0aCByZW1vdmVkIGZyb20gdGhlIHJlZHVuZGFudCBwYXJ0IGBlcGNpX2lkYFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0cmlwSWQoaWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLnBhdGhuYW1lLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IHBhdGggPSBpZC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCBtYXRjaCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVuZHBvaW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJ0ID0gZW5kcG9pbnRbaV07XHJcbiAgICAgICAgICAgIGlmIChwYXJ0ID09IHBhdGhbMF0pIHtcclxuICAgICAgICAgICAgICAgIG1hdGNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBhdGguam9pbignLycpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgd3JpdGVJbkNhY2hlKHN0b3JhYmxlOiBUKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5yZW1vdmVGcm9tQ2FjaGUoc3RvcmFibGUuaWQpO1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGNhY2hlLnB1c2goc3RvcmFibGUpO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWNoZTtcclxuICAgICAgICByZXR1cm4gc3RvcmFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyByZW1vdmVGcm9tQ2FjaGUoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gY2FjaGUuZmlsdGVyKGNhY2hlZCA9PiBjYWNoZWQuaWQgIT09IGlkKTtcclxuICAgICAgICBjb25zdCBkZWxldGVkID0gZmlsdGVyZWQubGVuZ3RoICE9IGNhY2hlLmxlbmd0aDtcclxuICAgICAgICB0aGlzLmNhY2hlID0gZmlsdGVyZWQ7XHJcbiAgICAgICAgcmV0dXJuIGRlbGV0ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRDYWNoZSgpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FjaGUgIT09IG51bGwpIHJldHVybiB0aGlzLmNhY2hlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yZXRyaWV2aW5nID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmV0cmlldmluZyA9IHRoaXMuYXBpLnJldHJpZXZlQWxsKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJldHJpZXZpbmcudGhlbigocmV0cmlldmVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlID0gcmV0cmlldmVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmluZztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJldHJpZXZpbmc6IFByb21pc2U8QXJyYXk8VD4+IHwgbnVsbCA9IG51bGw7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgaW5kaWNhdGV1clZhbHVlU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8SW5kaWNhdGV1clZhbHVlU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtJbmRpY2F0ZXVyVmFsdWUucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEluZGljYXRldXJWYWx1ZVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgSW5kaWNhdGV1clZhbHVlSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgYWN0aW9uU3RhdHVzU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8QWN0aW9uU3RhdHVzU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtBY3Rpb25TdGF0dXMucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEFjdGlvblN0YXR1c1N0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgQWN0aW9uU3RhdHVzSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgYWN0aW9uQ3VzdG9tU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8QWN0aW9uQ3VzdG9tU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtBY3Rpb25DdXN0b20ucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEFjdGlvbkN1c3RvbVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgQWN0aW9uQ3VzdG9tSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgbWVzdXJlQ3VzdG9tU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8TWVzdXJlQ3VzdG9tU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtNZXN1cmVDdXN0b20ucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IE1lc3VyZUN1c3RvbVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgTWVzdXJlQ3VzdG9tSW50ZXJmYWNlKSxcclxufSk7IiwiaW1wb3J0IHthY3Rpb25TdGF0dXNTdG9yZX0gZnJvbSBcIi4uLy4uL2FwaS9oeWJyaWRTdG9yZVwiO1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuaW1wb3J0IHtBY3Rpb25TdGF0dXNTdG9yYWJsZX0gZnJvbSBcIi4uLy4uL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZVwiO1xyXG5cclxuY29uc3QgZWNwaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpXHJcblxyXG5jb25zdCBhZGRMaXN0ZW5lcnMgPSAoYWN0aW9uSWQ6IHN0cmluZywgaW5wdXRzOiBOb2RlTGlzdE9mPEhUTUxJbnB1dEVsZW1lbnQ+KTogdm9pZCA9PiB7XHJcbiAgICBsZXQgb25DaGFuZ2UgPSAoZXZlbnQ6IEV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuICAgICAgICBjb25zdCBhY3Rpb25BdmFuY2VtZW50S2V5ID0gdGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgY29uc3QgYXZhbmNlbWVudCA9IG5ldyBBY3Rpb25TdGF0dXNTdG9yYWJsZSh7XHJcbiAgICAgICAgICAgIGVwY2lfaWQ6IGVjcGlJZCxcclxuICAgICAgICAgICAgYWN0aW9uX2lkOiBhY3Rpb25JZCxcclxuICAgICAgICAgICAgYXZhbmNlbWVudDogYWN0aW9uQXZhbmNlbWVudEtleVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGFjdGlvblN0YXR1c1N0b3JlLnN0b3JlKGF2YW5jZW1lbnQpXHJcbiAgICB9XHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KTogdm9pZCA9PiB7XHJcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25DaGFuZ2UpXHJcbiAgICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgdGhlIHZhbHVlIG9mIHRoZSBzdGF0dXMgcGlja2VyIHdpdGggYSBkZWZhdWx0IHZhbHVlIG9yIHRoZSB2YWx1ZSByZXRyaWV2ZWQgZnJvbSBzdG9yZS5cclxuICovXHJcbmNvbnN0IGNoZWNrSW5wdXQgPSBhc3luYyAoYWN0aW9uSWQ6IHN0cmluZywgaW5wdXRzOiBOb2RlTGlzdE9mPEhUTUxJbnB1dEVsZW1lbnQ+KTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcbiAgICBsZXQgYWN0aW9uQXZhbmNlbWVudEtleSA9ICdwYXNfZmFpdGUnO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBhY3Rpb25TdGF0dXNTdG9yZS5yZXRyaWV2ZUJ5SWQoYCR7ZWNwaUlkfS8ke2FjdGlvbklkfWApXHJcbiAgICAgICAgaWYgKHN0YXR1cykgYWN0aW9uQXZhbmNlbWVudEtleSA9IHN0YXR1cy5hdmFuY2VtZW50O1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIC8vICBzaG91bGQgZG8gc29tZXRoaW5nIG1lYW5pbmdmdWwuXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSW5wdXRJZCA9IGBhY3Rpb24tJHthY3Rpb25JZH1fJHthY3Rpb25BdmFuY2VtZW50S2V5fWBcclxuICAgICAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgaWYgKGlucHV0LmlkID09PSBzZWxlY3RlZElucHV0SWQpIGlucHV0LmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIHRoZSBzdGF0dXMgcGlja2VyIG9mIGFuIGFjdGlvbiB3aXRoIGFsbCBpdHMgZXZlbnQgbGlzdGVuZXJzXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgaW5pdCA9IChlbGVtZW50OiBIVE1MRmllbGRTZXRFbGVtZW50KTogdm9pZCA9PiB7XHJcbiAgICBsZXQgYWN0aW9uSWQgPSBlbGVtZW50LmRhdGFzZXQuYWN0aW9uSWQgfHwgJydcclxuICAgIGxldCBpbnB1dHMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTElucHV0RWxlbWVudD4oJ2lucHV0W3R5cGU9XCJyYWRpb1wiXScpXHJcblxyXG4gICAgYWRkTGlzdGVuZXJzKGFjdGlvbklkLCBpbnB1dHMpXHJcbiAgICBjaGVja0lucHV0KGFjdGlvbklkLCBpbnB1dHMpXHJcbn0iLCJpbXBvcnQgeyBpbml0IH0gZnJvbSAnLi9zdGF0dXNQaWNrZXInXHJcblxyXG5sZXQgc3RhdHVzUGlja2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTEZpZWxkU2V0RWxlbWVudD4oJy5zdGF0dXMnKVxyXG5cclxuc3RhdHVzUGlja2Vycy5mb3JFYWNoKChlbGVtZW50KTogdm9pZCA9PiBpbml0KGVsZW1lbnQpKVxyXG5cclxuXHJcbiIsImltcG9ydCB7aW5kaWNhdGV1clZhbHVlU3RvcmV9IGZyb20gXCIuLi8uLi9hcGkvaHlicmlkU3RvcmVcIjtcclxuaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZX0gZnJvbSAnLi4vLi4vc3RvcmFibGVzL0luZGljYXRldXJWYWx1ZVN0b3JhYmxlJ1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuXHJcbi8qKlxyXG4gKiBQcmV2ZW50IGRlZmF1bHQgZm9ybSBiZWhhdmlvci5cclxuICovXHJcbmNvbnN0IHByZXZlbnREZWZhdWx0ID0gKGV2ZW50OiBFdmVudCk6IHZvaWQgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG59XHJcblxyXG4vKipcclxuICogU2F2ZSB2YWx1ZSBmb3IgYSBzaW5nbGUgeWVhcmx5IGlucHV0IG9uIGJsdXIuXHJcbiAqL1xyXG5jb25zdCBvbkJsdXIgPSAoZXZlbnQ6IEZvY3VzRXZlbnQpOiB2b2lkID0+IHtcclxuICAgIGNvbnN0IGlucHV0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBjb25zdCB7aWQsIHllYXJ9ID0gaW5wdXRQcm9wZXJ0aWVzKGlucHV0KVxyXG4gICAgY29uc3QgY3VycmVudEVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKVxyXG4gICAgY29uc3QgdmFsdWUgPSBuZXcgSW5kaWNhdGV1clZhbHVlU3RvcmFibGUoe1xyXG4gICAgICAgIGVwY2lfaWQ6IGN1cnJlbnRFcGNpSWQsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZDogaWQsXHJcbiAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICB2YWx1ZTogaW5wdXQudmFsdWVcclxuICAgIH0pXHJcblxyXG4gICAgaW5kaWNhdGV1clZhbHVlU3RvcmUuc3RvcmUodmFsdWUpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxsIGJsdXIgb24gZW50ZXIuXHJcbiAqL1xyXG5jb25zdCBvbktleVByZXNzID0gKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIGlucHV0LmJsdXIoKVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBhIHNpbmdsZSB5ZWFybHkgaW5wdXQgd2l0aCBhIHJldHJpZXZlZCB2YWx1ZSBvciBhbiBlbXB0eSB2YWx1ZSBpZiBub25lIGZvdW5kLlxyXG4gKi9cclxuY29uc3QgaW5pdFllYXJseUlucHV0ID0gYXN5bmMgKGlucHV0OiBIVE1MSW5wdXRFbGVtZW50KTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcblxyXG4gICAgaW5wdXQudmFsdWUgPSAgJydcclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvbkJsdXIpXHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIG9uS2V5UHJlc3MpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IGluZGljYXRldXIgaWQgYW5kIHllYXIgZnJvbSBpbnB1dC5cclxuICovXHJcbmNvbnN0IGlucHV0UHJvcGVydGllcyA9IChpbnB1dDogSFRNTElucHV0RWxlbWVudCk6IHsgaWQ6IHN0cmluZywgeWVhcjogbnVtYmVyIH0gPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogaW5wdXQuZGF0YXNldC5pbmRpY2F0b3JJZCEsXHJcbiAgICAgICAgeWVhcjogK2lucHV0LmRhdGFzZXQuaW5kaWNhdG9yWWVhciEsXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGVhY2ggeWVhcmx5IGlucHV0IGxpbmtlZCB0byBhbiBpbmRpY2F0b3Igd2l0aCBhbGwgaXRzIGV2ZW50IGxpc3RlbmVycy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBpbml0ID0gYXN5bmMgIChmb3JtOiBIVE1MRm9ybUVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgcHJldmVudERlZmF1bHQpXHJcbiAgICBjb25zdCBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JylcclxuICAgIGZvciAobGV0IGlucHV0IG9mIGlucHV0cykge1xyXG4gICAgICAgIGluaXRZZWFybHlJbnB1dChpbnB1dClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7aWQsIHllYXJ9ID0gaW5wdXRQcm9wZXJ0aWVzKGlucHV0c1swXSlcclxuICAgIGNvbnN0IGVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKVxyXG5cclxuICAgIGNvbnN0IGluZGljYXRldXJWYWx1ZXMgPSBhd2FpdCBpbmRpY2F0ZXVyVmFsdWVTdG9yZS5yZXRyaWV2ZUF0UGF0aChcclxuICAgICAgICBgJHtlcGNpSWR9LyR7aWR9YFxyXG4gICAgKVxyXG5cclxuICAgIGZvciAobGV0IGlucHV0IG9mIGlucHV0cykge1xyXG4gICAgICAgIGNvbnN0IHtpZCwgeWVhcn0gPSBpbnB1dFByb3BlcnRpZXMoaW5wdXQpXHJcbiAgICAgICAgbGV0IHZhbHVlID0gJydcclxuICAgICAgICBmb3IgKGxldCBpbmRpY2F0ZXVyVmFsdWUgb2YgaW5kaWNhdGV1clZhbHVlcykge1xyXG4gICAgICAgICAgICBpZiAoaW5kaWNhdGV1clZhbHVlLnllYXIgPT0geWVhciAmJiBpbmRpY2F0ZXVyVmFsdWUuaW5kaWNhdGV1cl9pZCA9PSBpZClcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gaW5kaWNhdGV1clZhbHVlLnZhbHVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4iLCJmdW5jdGlvbiBub29wKCkgeyB9XG5jb25zdCBpZGVudGl0eSA9IHggPT4geDtcbmZ1bmN0aW9uIGFzc2lnbih0YXIsIHNyYykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IGsgaW4gc3JjKVxuICAgICAgICB0YXJba10gPSBzcmNba107XG4gICAgcmV0dXJuIHRhcjtcbn1cbmZ1bmN0aW9uIGlzX3Byb21pc2UodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIGFkZF9sb2NhdGlvbihlbGVtZW50LCBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIpIHtcbiAgICBlbGVtZW50Ll9fc3ZlbHRlX21ldGEgPSB7XG4gICAgICAgIGxvYzogeyBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIgfVxuICAgIH07XG59XG5mdW5jdGlvbiBydW4oZm4pIHtcbiAgICByZXR1cm4gZm4oKTtcbn1cbmZ1bmN0aW9uIGJsYW5rX29iamVjdCgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcbn1cbmZ1bmN0aW9uIHJ1bl9hbGwoZm5zKSB7XG4gICAgZm5zLmZvckVhY2gocnVuKTtcbn1cbmZ1bmN0aW9uIGlzX2Z1bmN0aW9uKHRoaW5nKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGluZyA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIHNhZmVfbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYiB8fCAoKGEgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnKSB8fCB0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5mdW5jdGlvbiBub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiO1xufVxuZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfc3RvcmUoc3RvcmUsIG5hbWUpIHtcbiAgICBpZiAoc3RvcmUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RvcmUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmFtZX0nIGlzIG5vdCBhIHN0b3JlIHdpdGggYSAnc3Vic2NyaWJlJyBtZXRob2RgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmUsIC4uLmNhbGxiYWNrcykge1xuICAgIGlmIChzdG9yZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBjb25zdCB1bnN1YiA9IHN0b3JlLnN1YnNjcmliZSguLi5jYWxsYmFja3MpO1xuICAgIHJldHVybiB1bnN1Yi51bnN1YnNjcmliZSA/ICgpID0+IHVuc3ViLnVuc3Vic2NyaWJlKCkgOiB1bnN1Yjtcbn1cbmZ1bmN0aW9uIGdldF9zdG9yZV92YWx1ZShzdG9yZSkge1xuICAgIGxldCB2YWx1ZTtcbiAgICBzdWJzY3JpYmUoc3RvcmUsIF8gPT4gdmFsdWUgPSBfKSgpO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGNvbXBvbmVudF9zdWJzY3JpYmUoY29tcG9uZW50LCBzdG9yZSwgY2FsbGJhY2spIHtcbiAgICBjb21wb25lbnQuJCQub25fZGVzdHJveS5wdXNoKHN1YnNjcmliZShzdG9yZSwgY2FsbGJhY2spKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zbG90KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICBjb25zdCBzbG90X2N0eCA9IGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbik7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uWzBdKHNsb3RfY3R4KTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblsxXSAmJiBmblxuICAgICAgICA/IGFzc2lnbigkJHNjb3BlLmN0eC5zbGljZSgpLCBkZWZpbml0aW9uWzFdKGZuKGN0eCkpKVxuICAgICAgICA6ICQkc2NvcGUuY3R4O1xufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY2hhbmdlcyhkZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvblsyXSAmJiBmbikge1xuICAgICAgICBjb25zdCBsZXRzID0gZGVmaW5pdGlvblsyXShmbihkaXJ0eSkpO1xuICAgICAgICBpZiAoJCRzY29wZS5kaXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxldHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGgubWF4KCQkc2NvcGUuZGlydHkubGVuZ3RoLCBsZXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkW2ldID0gJCRzY29wZS5kaXJ0eVtpXSB8IGxldHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkJHNjb3BlLmRpcnR5IHwgbGV0cztcbiAgICB9XG4gICAgcmV0dXJuICQkc2NvcGUuZGlydHk7XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdChzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3Rfc3ByZWFkKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3Rfc3ByZWFkX2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9zcHJlYWRfY2hhbmdlc19mbihkaXJ0eSkgfCBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXhjbHVkZV9pbnRlcm5hbF9wcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3VsdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Jlc3RfcHJvcHMocHJvcHMsIGtleXMpIHtcbiAgICBjb25zdCByZXN0ID0ge307XG4gICAga2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoIWtleXMuaGFzKGspICYmIGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3Rba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfc2xvdHMoc2xvdHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgbGV0IHJhbiA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICBpZiAocmFuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICBmbi5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuICAgIH07XG59XG5mdW5jdGlvbiBudWxsX3RvX2VtcHR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X3N0b3JlX3ZhbHVlKHN0b3JlLCByZXQsIHZhbHVlID0gcmV0KSB7XG4gICAgc3RvcmUuc2V0KHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufVxuY29uc3QgaGFzX3Byb3AgPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbmZ1bmN0aW9uIGFjdGlvbl9kZXN0cm95ZXIoYWN0aW9uX3Jlc3VsdCkge1xuICAgIHJldHVybiBhY3Rpb25fcmVzdWx0ICYmIGlzX2Z1bmN0aW9uKGFjdGlvbl9yZXN1bHQuZGVzdHJveSkgPyBhY3Rpb25fcmVzdWx0LmRlc3Ryb3kgOiBub29wO1xufVxuXG5jb25zdCBpc19jbGllbnQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbmxldCBub3cgPSBpc19jbGllbnRcbiAgICA/ICgpID0+IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxuICAgIDogKCkgPT4gRGF0ZS5ub3coKTtcbmxldCByYWYgPSBpc19jbGllbnQgPyBjYiA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2IpIDogbm9vcDtcbi8vIHVzZWQgaW50ZXJuYWxseSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gc2V0X25vdyhmbikge1xuICAgIG5vdyA9IGZuO1xufVxuZnVuY3Rpb24gc2V0X3JhZihmbikge1xuICAgIHJhZiA9IGZuO1xufVxuXG5jb25zdCB0YXNrcyA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHJ1bl90YXNrcyhub3cpIHtcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBpZiAoIXRhc2suYyhub3cpKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgICAgICB0YXNrLmYoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0YXNrcy5zaXplICE9PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbn1cbi8qKlxuICogRm9yIHRlc3RpbmcgcHVycG9zZXMgb25seSFcbiAqL1xuZnVuY3Rpb24gY2xlYXJfbG9vcHMoKSB7XG4gICAgdGFza3MuY2xlYXIoKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXNrIHRoYXQgcnVucyBvbiBlYWNoIHJhZiBmcmFtZVxuICogdW50aWwgaXQgcmV0dXJucyBhIGZhbHN5IHZhbHVlIG9yIGlzIGFib3J0ZWRcbiAqL1xuZnVuY3Rpb24gbG9vcChjYWxsYmFjaykge1xuICAgIGxldCB0YXNrO1xuICAgIGlmICh0YXNrcy5zaXplID09PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBuZXcgUHJvbWlzZShmdWxmaWxsID0+IHtcbiAgICAgICAgICAgIHRhc2tzLmFkZCh0YXNrID0geyBjOiBjYWxsYmFjaywgZjogZnVsZmlsbCB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0KCkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gYXBwZW5kKHRhcmdldCwgbm9kZSkge1xuICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xufVxuZnVuY3Rpb24gZGV0YWNoKG5vZGUpIHtcbiAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2VhY2goaXRlcmF0aW9ucywgZGV0YWNoaW5nKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpdGVyYXRpb25zW2ldKVxuICAgICAgICAgICAgaXRlcmF0aW9uc1tpXS5kKGRldGFjaGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBlbGVtZW50X2lzKG5hbWUsIGlzKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSwgeyBpcyB9KTtcbn1cbmZ1bmN0aW9uIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMob2JqLCBleGNsdWRlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgICBpZiAoaGFzX3Byb3Aob2JqLCBrKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgJiYgZXhjbHVkZS5pbmRleE9mKGspID09PSAtMSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGFyZ2V0W2tdID0gb2JqW2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBzdmdfZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBuYW1lKTtcbn1cbmZ1bmN0aW9uIHRleHQoZGF0YSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhKTtcbn1cbmZ1bmN0aW9uIHNwYWNlKCkge1xuICAgIHJldHVybiB0ZXh0KCcgJyk7XG59XG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgICByZXR1cm4gdGV4dCgnJyk7XG59XG5mdW5jdGlvbiBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJldmVudF9kZWZhdWx0KGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc3RvcF9wcm9wYWdhdGlvbihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZWxmKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoaXMpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgZWxzZSBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSAhPT0gdmFsdWUpXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0X2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBkZXNjcmlwdG9ycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG5vZGUuX19wcm90b19fKTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2tleV0gPT0gbnVsbCkge1xuICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdfX3ZhbHVlJykge1xuICAgICAgICAgICAgbm9kZS52YWx1ZSA9IG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yc1trZXldICYmIGRlc2NyaXB0b3JzW2tleV0uc2V0KSB7XG4gICAgICAgICAgICBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdmdfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YShub2RlLCBwcm9wLCB2YWx1ZSkge1xuICAgIGlmIChwcm9wIGluIG5vZGUpIHtcbiAgICAgICAgbm9kZVtwcm9wXSA9IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXR0cihub2RlLCBwcm9wLCB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24geGxpbmtfYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUoZ3JvdXAsIF9fdmFsdWUsIGNoZWNrZWQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChncm91cFtpXS5jaGVja2VkKVxuICAgICAgICAgICAgdmFsdWUuYWRkKGdyb3VwW2ldLl9fdmFsdWUpO1xuICAgIH1cbiAgICBpZiAoIWNoZWNrZWQpIHtcbiAgICAgICAgdmFsdWUuZGVsZXRlKF9fdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbSh2YWx1ZSk7XG59XG5mdW5jdGlvbiB0b19udW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6ICt2YWx1ZTtcbn1cbmZ1bmN0aW9uIHRpbWVfcmFuZ2VzX3RvX2FycmF5KHJhbmdlcykge1xuICAgIGNvbnN0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYXJyYXkucHVzaCh7IHN0YXJ0OiByYW5nZXMuc3RhcnQoaSksIGVuZDogcmFuZ2VzLmVuZChpKSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gY2hpbGRyZW4oZWxlbWVudCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2Rlcyk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBzdmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgICAgIGxldCBqID0gMDtcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgICAgICAgICAgd2hpbGUgKGogPCBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzW2orK107XG4gICAgICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCByZW1vdmUubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShyZW1vdmVba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGVzLnNwbGljZShpLCAxKVswXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3ZnID8gc3ZnX2VsZW1lbnQobmFtZSkgOiBlbGVtZW50KG5hbWUpO1xufVxuZnVuY3Rpb24gY2xhaW1fdGV4dChub2RlcywgZGF0YSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMykge1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gJycgKyBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGVzLnNwbGljZShpLCAxKVswXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGV4dChkYXRhKTtcbn1cbmZ1bmN0aW9uIGNsYWltX3NwYWNlKG5vZGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX3RleHQobm9kZXMsICcgJyk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YSh0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgIT09IGRhdGEpXG4gICAgICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgaW5wdXQudmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF90eXBlKGlucHV0LCB0eXBlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaW5wdXQudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3R5bGUobm9kZSwga2V5LCB2YWx1ZSwgaW1wb3J0YW50KSB7XG4gICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb24oc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIGlmIChvcHRpb24uX192YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9ucyhzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gfnZhbHVlLmluZGV4T2Yob3B0aW9uLl9fdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF92YWx1ZShzZWxlY3QpIHtcbiAgICBjb25zdCBzZWxlY3RlZF9vcHRpb24gPSBzZWxlY3QucXVlcnlTZWxlY3RvcignOmNoZWNrZWQnKSB8fCBzZWxlY3Qub3B0aW9uc1swXTtcbiAgICByZXR1cm4gc2VsZWN0ZWRfb3B0aW9uICYmIHNlbGVjdGVkX29wdGlvbi5fX3ZhbHVlO1xufVxuZnVuY3Rpb24gc2VsZWN0X211bHRpcGxlX3ZhbHVlKHNlbGVjdCkge1xuICAgIHJldHVybiBbXS5tYXAuY2FsbChzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnOmNoZWNrZWQnKSwgb3B0aW9uID0+IG9wdGlvbi5fX3ZhbHVlKTtcbn1cbi8vIHVuZm9ydHVuYXRlbHkgdGhpcyBjYW4ndCBiZSBhIGNvbnN0YW50IGFzIHRoYXQgd291bGRuJ3QgYmUgdHJlZS1zaGFrZWFibGVcbi8vIHNvIHdlIGNhY2hlIHRoZSByZXN1bHQgaW5zdGVhZFxubGV0IGNyb3Nzb3JpZ2luO1xuZnVuY3Rpb24gaXNfY3Jvc3NvcmlnaW4oKSB7XG4gICAgaWYgKGNyb3Nzb3JpZ2luID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY3Jvc3NvcmlnaW4gPSBmYWxzZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdm9pZCB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY3Jvc3NvcmlnaW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcm9zc29yaWdpbjtcbn1cbmZ1bmN0aW9uIGFkZF9yZXNpemVfbGlzdGVuZXIobm9kZSwgZm4pIHtcbiAgICBjb25zdCBjb21wdXRlZF9zdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKGNvbXB1dGVkX3N0eWxlLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICB9XG4gICAgY29uc3QgaWZyYW1lID0gZWxlbWVudCgnaWZyYW1lJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyBsZWZ0OiAwOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyAnICtcbiAgICAgICAgJ292ZXJmbG93OiBoaWRkZW47IGJvcmRlcjogMDsgb3BhY2l0eTogMDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHotaW5kZXg6IC0xOycpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICBpZnJhbWUudGFiSW5kZXggPSAtMTtcbiAgICBjb25zdCBjcm9zc29yaWdpbiA9IGlzX2Nyb3Nzb3JpZ2luKCk7XG4gICAgbGV0IHVuc3Vic2NyaWJlO1xuICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICBpZnJhbWUuc3JjID0gXCJkYXRhOnRleHQvaHRtbCw8c2NyaXB0Pm9ucmVzaXplPWZ1bmN0aW9uKCl7cGFyZW50LnBvc3RNZXNzYWdlKDAsJyonKX08L3NjcmlwdD5cIjtcbiAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4od2luZG93LCAnbWVzc2FnZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpXG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJztcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKGlmcmFtZS5jb250ZW50V2luZG93LCAncmVzaXplJywgZm4pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhcHBlbmQobm9kZSwgaWZyYW1lKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodW5zdWJzY3JpYmUgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZGV0YWNoKGlmcmFtZSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZV9jbGFzcyhlbGVtZW50LCBuYW1lLCB0b2dnbGUpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdFt0b2dnbGUgPyAnYWRkJyA6ICdyZW1vdmUnXShuYW1lKTtcbn1cbmZ1bmN0aW9uIGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwpIHtcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgZmFsc2UsIGZhbHNlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGFuY2hvciA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5hID0gYW5jaG9yO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgIH1cbiAgICBtKGh0bWwsIHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBpZiAoIXRoaXMuZSkge1xuICAgICAgICAgICAgdGhpcy5lID0gZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy50ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaShhbmNob3IpO1xuICAgIH1cbiAgICBoKGh0bWwpIHtcbiAgICAgICAgdGhpcy5lLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHRoaXMubiA9IEFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpO1xuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHAoaHRtbCkge1xuICAgICAgICB0aGlzLmQoKTtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB0aGlzLmkodGhpcy5hKTtcbiAgICB9XG4gICAgZCgpIHtcbiAgICAgICAgdGhpcy5uLmZvckVhY2goZGV0YWNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhdHRyaWJ1dGVfdG9fb2JqZWN0KGF0dHJpYnV0ZXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHJlc3VsdFthdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzKGVsZW1lbnQpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBlbGVtZW50LmNoaWxkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICByZXN1bHRbbm9kZS5zbG90IHx8ICdkZWZhdWx0J10gPSB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmNvbnN0IGFjdGl2ZV9kb2NzID0gbmV3IFNldCgpO1xubGV0IGFjdGl2ZSA9IDA7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vZGFya3NreWFwcC9zdHJpbmctaGFzaC9ibG9iL21hc3Rlci9pbmRleC5qc1xuZnVuY3Rpb24gaGFzaChzdHIpIHtcbiAgICBsZXQgaGFzaCA9IDUzODE7XG4gICAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBoYXNoID4+PiAwO1xufVxuZnVuY3Rpb24gY3JlYXRlX3J1bGUobm9kZSwgYSwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNlLCBmbiwgdWlkID0gMCkge1xuICAgIGNvbnN0IHN0ZXAgPSAxNi42NjYgLyBkdXJhdGlvbjtcbiAgICBsZXQga2V5ZnJhbWVzID0gJ3tcXG4nO1xuICAgIGZvciAobGV0IHAgPSAwOyBwIDw9IDE7IHAgKz0gc3RlcCkge1xuICAgICAgICBjb25zdCB0ID0gYSArIChiIC0gYSkgKiBlYXNlKHApO1xuICAgICAgICBrZXlmcmFtZXMgKz0gcCAqIDEwMCArIGAleyR7Zm4odCwgMSAtIHQpfX1cXG5gO1xuICAgIH1cbiAgICBjb25zdCBydWxlID0ga2V5ZnJhbWVzICsgYDEwMCUgeyR7Zm4oYiwgMSAtIGIpfX1cXG59YDtcbiAgICBjb25zdCBuYW1lID0gYF9fc3ZlbHRlXyR7aGFzaChydWxlKX1fJHt1aWR9YDtcbiAgICBjb25zdCBkb2MgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgYWN0aXZlX2RvY3MuYWRkKGRvYyk7XG4gICAgY29uc3Qgc3R5bGVzaGVldCA9IGRvYy5fX3N2ZWx0ZV9zdHlsZXNoZWV0IHx8IChkb2MuX19zdmVsdGVfc3R5bGVzaGVldCA9IGRvYy5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQoJ3N0eWxlJykpLnNoZWV0KTtcbiAgICBjb25zdCBjdXJyZW50X3J1bGVzID0gZG9jLl9fc3ZlbHRlX3J1bGVzIHx8IChkb2MuX19zdmVsdGVfcnVsZXMgPSB7fSk7XG4gICAgaWYgKCFjdXJyZW50X3J1bGVzW25hbWVdKSB7XG4gICAgICAgIGN1cnJlbnRfcnVsZXNbbmFtZV0gPSB0cnVlO1xuICAgICAgICBzdHlsZXNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtuYW1lfSAke3J1bGV9YCwgc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH1cbiAgICBjb25zdCBhbmltYXRpb24gPSBub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJztcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IGAke2FuaW1hdGlvbiA/IGAke2FuaW1hdGlvbn0sIGAgOiAnJ30ke25hbWV9ICR7ZHVyYXRpb259bXMgbGluZWFyICR7ZGVsYXl9bXMgMSBib3RoYDtcbiAgICBhY3RpdmUgKz0gMTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpIHtcbiAgICBjb25zdCBwcmV2aW91cyA9IChub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJykuc3BsaXQoJywgJyk7XG4gICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmZpbHRlcihuYW1lXG4gICAgICAgID8gYW5pbSA9PiBhbmltLmluZGV4T2YobmFtZSkgPCAwIC8vIHJlbW92ZSBzcGVjaWZpYyBhbmltYXRpb25cbiAgICAgICAgOiBhbmltID0+IGFuaW0uaW5kZXhPZignX19zdmVsdGUnKSA9PT0gLTEgLy8gcmVtb3ZlIGFsbCBTdmVsdGUgYW5pbWF0aW9uc1xuICAgICk7XG4gICAgY29uc3QgZGVsZXRlZCA9IHByZXZpb3VzLmxlbmd0aCAtIG5leHQubGVuZ3RoO1xuICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gbmV4dC5qb2luKCcsICcpO1xuICAgICAgICBhY3RpdmUgLT0gZGVsZXRlZDtcbiAgICAgICAgaWYgKCFhY3RpdmUpXG4gICAgICAgICAgICBjbGVhcl9ydWxlcygpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsZWFyX3J1bGVzKCkge1xuICAgIHJhZigoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGFjdGl2ZV9kb2NzLmZvckVhY2goZG9jID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlc2hlZXQgPSBkb2MuX19zdmVsdGVfc3R5bGVzaGVldDtcbiAgICAgICAgICAgIGxldCBpID0gc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKVxuICAgICAgICAgICAgICAgIHN0eWxlc2hlZXQuZGVsZXRlUnVsZShpKTtcbiAgICAgICAgICAgIGRvYy5fX3N2ZWx0ZV9ydWxlcyA9IHt9O1xuICAgICAgICB9KTtcbiAgICAgICAgYWN0aXZlX2RvY3MuY2xlYXIoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbicpO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwpID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuZnVuY3Rpb24gaGFzQ29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5oYXMoa2V5KTtcbn1cbi8vIFRPRE8gZmlndXJlIG91dCBpZiB3ZSBzdGlsbCB3YW50IHRvIHN1cHBvcnRcbi8vIHNob3J0aGFuZCBldmVudHMsIG9yIGlmIHdlIHdhbnQgdG8gaW1wbGVtZW50XG4vLyBhIHJlYWwgYnViYmxpbmcgbWVjaGFuaXNtXG5mdW5jdGlvbiBidWJibGUoY29tcG9uZW50LCBldmVudCkge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbZXZlbnQudHlwZV07XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IGZuKGV2ZW50KSk7XG4gICAgfVxufVxuXG5jb25zdCBkaXJ0eV9jb21wb25lbnRzID0gW107XG5jb25zdCBpbnRyb3MgPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG5jb25zdCBiaW5kaW5nX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVuZGVyX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgZmx1c2hfY2FsbGJhY2tzID0gW107XG5jb25zdCByZXNvbHZlZF9wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5sZXQgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2NoZWR1bGVfdXBkYXRlKCkge1xuICAgIGlmICghdXBkYXRlX3NjaGVkdWxlZCkge1xuICAgICAgICB1cGRhdGVfc2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZWRfcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0aWNrKCkge1xuICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgIHJldHVybiByZXNvbHZlZF9wcm9taXNlO1xufVxuZnVuY3Rpb24gYWRkX3JlbmRlcl9jYWxsYmFjayhmbikge1xuICAgIHJlbmRlcl9jYWxsYmFja3MucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZGRfZmx1c2hfY2FsbGJhY2soZm4pIHtcbiAgICBmbHVzaF9jYWxsYmFja3MucHVzaChmbik7XG59XG5sZXQgZmx1c2hpbmcgPSBmYWxzZTtcbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgaWYgKGZsdXNoaW5nKVxuICAgICAgICByZXR1cm47XG4gICAgZmx1c2hpbmcgPSB0cnVlO1xuICAgIGRvIHtcbiAgICAgICAgLy8gZmlyc3QsIGNhbGwgYmVmb3JlVXBkYXRlIGZ1bmN0aW9uc1xuICAgICAgICAvLyBhbmQgdXBkYXRlIGNvbXBvbmVudHNcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBkaXJ0eV9jb21wb25lbnRzW2ldO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoY29tcG9uZW50LiQkKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgd2hpbGUgKGJpbmRpbmdfY2FsbGJhY2tzLmxlbmd0aClcbiAgICAgICAgICAgIGJpbmRpbmdfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgIC8vIHRoZW4sIG9uY2UgY29tcG9uZW50cyBhcmUgdXBkYXRlZCwgY2FsbFxuICAgICAgICAvLyBhZnRlclVwZGF0ZSBmdW5jdGlvbnMuIFRoaXMgbWF5IGNhdXNlXG4gICAgICAgIC8vIHN1YnNlcXVlbnQgdXBkYXRlcy4uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gcmVuZGVyX2NhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgIGlmICghc2Vlbl9jYWxsYmFja3MuaGFzKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICAgIC8vIC4uLnNvIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgbG9vcHNcbiAgICAgICAgICAgICAgICBzZWVuX2NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgIH0gd2hpbGUgKGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKTtcbiAgICB3aGlsZSAoZmx1c2hfY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICBmbHVzaF9jYWxsYmFja3MucG9wKCkoKTtcbiAgICB9XG4gICAgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIGZsdXNoaW5nID0gZmFsc2U7XG4gICAgc2Vlbl9jYWxsYmFja3MuY2xlYXIoKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZSgkJCkge1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAkJC51cGRhdGUoKTtcbiAgICAgICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAgICAgY29uc3QgZGlydHkgPSAkJC5kaXJ0eTtcbiAgICAgICAgJCQuZGlydHkgPSBbLTFdO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5wKCQkLmN0eCwgZGlydHkpO1xuICAgICAgICAkJC5hZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbiAgICB9XG59XG5cbmxldCBwcm9taXNlO1xuZnVuY3Rpb24gd2FpdCgpIHtcbiAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKG5vZGUsIGRpcmVjdGlvbiwga2luZCkge1xuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQoYCR7ZGlyZWN0aW9uID8gJ2ludHJvJyA6ICdvdXRybyd9JHtraW5kfWApKTtcbn1cbmNvbnN0IG91dHJvaW5nID0gbmV3IFNldCgpO1xubGV0IG91dHJvcztcbmZ1bmN0aW9uIGdyb3VwX291dHJvcygpIHtcbiAgICBvdXRyb3MgPSB7XG4gICAgICAgIHI6IDAsXG4gICAgICAgIGM6IFtdLFxuICAgICAgICBwOiBvdXRyb3MgLy8gcGFyZW50IGdyb3VwXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNoZWNrX291dHJvcygpIHtcbiAgICBpZiAoIW91dHJvcy5yKSB7XG4gICAgICAgIHJ1bl9hbGwob3V0cm9zLmMpO1xuICAgIH1cbiAgICBvdXRyb3MgPSBvdXRyb3MucDtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25faW4oYmxvY2ssIGxvY2FsKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLmkpIHtcbiAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suaShsb2NhbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9vdXQoYmxvY2ssIGxvY2FsLCBkZXRhY2gsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLm8pIHtcbiAgICAgICAgaWYgKG91dHJvaW5nLmhhcyhibG9jaykpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG91dHJvaW5nLmFkZChibG9jayk7XG4gICAgICAgIG91dHJvcy5jLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChkZXRhY2gpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmQoMSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJsb2NrLm8obG9jYWwpO1xuICAgIH1cbn1cbmNvbnN0IG51bGxfdHJhbnNpdGlvbiA9IHsgZHVyYXRpb246IDAgfTtcbmZ1bmN0aW9uIGNyZWF0ZV9pbl90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdWlkID0gMDtcbiAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzLCB1aWQrKyk7XG4gICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgaWYgKHRhc2spXG4gICAgICAgICAgICB0YXNrLmFib3J0KCk7XG4gICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIHRydWUsICdzdGFydCcpKTtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCB0cnVlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoc3RhcnRlZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlKTtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oZ28pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW52YWxpZGF0ZSgpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBjb25zdCBncm91cCA9IG91dHJvcztcbiAgICBncm91cC5yICs9IDE7XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDEsIDAsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdzdGFydCcpKTtcbiAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghLS1ncm91cC5yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmVzdWx0IGluIGBlbmQoKWAgYmVpbmcgY2FsbGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgZG9uJ3QgbmVlZCB0byBjbGVhbiB1cCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKGdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEgLSB0LCB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBnbygpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBlbmQocmVzZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXNldCAmJiBjb25maWcudGljaykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy50aWNrKDEsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zLCBpbnRybykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCB0ID0gaW50cm8gPyAwIDogMTtcbiAgICBsZXQgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWUgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGNsZWFyX2FuaW1hdGlvbigpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbml0KHByb2dyYW0sIGR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGQgPSBwcm9ncmFtLmIgLSB0O1xuICAgICAgICBkdXJhdGlvbiAqPSBNYXRoLmFicyhkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGE6IHQsXG4gICAgICAgICAgICBiOiBwcm9ncmFtLmIsXG4gICAgICAgICAgICBkLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzdGFydDogcHJvZ3JhbS5zdGFydCxcbiAgICAgICAgICAgIGVuZDogcHJvZ3JhbS5zdGFydCArIGR1cmF0aW9uLFxuICAgICAgICAgICAgZ3JvdXA6IHByb2dyYW0uZ3JvdXBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oYikge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG5vdygpICsgZGVsYXksXG4gICAgICAgICAgICBiXG4gICAgICAgIH07XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIHByb2dyYW0uZ3JvdXAgPSBvdXRyb3M7XG4gICAgICAgICAgICBvdXRyb3MuciArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbnRybywgYW5kIHRoZXJlJ3MgYSBkZWxheSwgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgLy8gYW4gaW5pdGlhbCB0aWNrIGFuZC9vciBhcHBseSBDU1MgYW5pbWF0aW9uIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiKVxuICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHByb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgYiwgJ3N0YXJ0JykpO1xuICAgICAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nX3Byb2dyYW0gJiYgbm93ID4gcGVuZGluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocGVuZGluZ19wcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnc3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIHJ1bm5pbmdfcHJvZ3JhbS5iLCBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24sIDAsIGVhc2luZywgY29uZmlnLmNzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5lbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCA9IHJ1bm5pbmdfcHJvZ3JhbS5iLCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbS5iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludHJvIOKAlCB3ZSBjYW4gdGlkeSB1cCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG91dHJvIOKAlCBuZWVkcyB0byBiZSBjb29yZGluYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIS0tcnVubmluZ19wcm9ncmFtLmdyb3VwLnIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKHJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBydW5uaW5nX3Byb2dyYW0uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcnVubmluZ19wcm9ncmFtLmEgKyBydW5uaW5nX3Byb2dyYW0uZCAqIGVhc2luZyhwIC8gcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhIShydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJ1bihiKSB7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3Byb21pc2UocHJvbWlzZSwgaW5mbykge1xuICAgIGNvbnN0IHRva2VuID0gaW5mby50b2tlbiA9IHt9O1xuICAgIGZ1bmN0aW9uIHVwZGF0ZSh0eXBlLCBpbmRleCwga2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoaW5mby50b2tlbiAhPT0gdG9rZW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSB2YWx1ZTtcbiAgICAgICAgbGV0IGNoaWxkX2N0eCA9IGluZm8uY3R4O1xuICAgICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNoaWxkX2N0eCA9IGNoaWxkX2N0eC5zbGljZSgpO1xuICAgICAgICAgICAgY2hpbGRfY3R4W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgJiYgKGluZm8uY3VycmVudCA9IHR5cGUpKGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBuZWVkc19mbHVzaCA9IGZhbHNlO1xuICAgICAgICBpZiAoaW5mby5ibG9jaykge1xuICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IGluZGV4ICYmIGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzW2ldID09PSBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrc1tpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja19vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9jay5kKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgICAgICBibG9jay5tKGluZm8ubW91bnQoKSwgaW5mby5hbmNob3IpO1xuICAgICAgICAgICAgbmVlZHNfZmx1c2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uYmxvY2sgPSBibG9jaztcbiAgICAgICAgaWYgKGluZm8uYmxvY2tzKVxuICAgICAgICAgICAgaW5mby5ibG9ja3NbaW5kZXhdID0gYmxvY2s7XG4gICAgICAgIGlmIChuZWVkc19mbHVzaCkge1xuICAgICAgICAgICAgZmx1c2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNfcHJvbWlzZShwcm9taXNlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50X2NvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgICAgICBwcm9taXNlLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLmNhdGNoLCAyLCBpbmZvLmVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgICAgICBpZiAoIWluZm8uaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGlmIHdlIHByZXZpb3VzbHkgaGFkIGEgdGhlbi9jYXRjaCBibG9jaywgZGVzdHJveSBpdFxuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnBlbmRpbmcsIDApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8udGhlbikge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLnJlc29sdmVkID0gcHJvbWlzZTtcbiAgICB9XG59XG5cbmNvbnN0IGdsb2JhbHMgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IHdpbmRvd1xuICAgIDogdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXG4gICAgICAgID8gZ2xvYmFsVGhpc1xuICAgICAgICA6IGdsb2JhbCk7XG5cbmZ1bmN0aW9uIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmQoMSk7XG4gICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xufVxuZnVuY3Rpb24gb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiB1cGRhdGVfa2V5ZWRfZWFjaChvbGRfYmxvY2tzLCBkaXJ0eSwgZ2V0X2tleSwgZHluYW1pYywgY3R4LCBsaXN0LCBsb29rdXAsIG5vZGUsIGRlc3Ryb3ksIGNyZWF0ZV9lYWNoX2Jsb2NrLCBuZXh0LCBnZXRfY29udGV4dCkge1xuICAgIGxldCBvID0gb2xkX2Jsb2Nrcy5sZW5ndGg7XG4gICAgbGV0IG4gPSBsaXN0Lmxlbmd0aDtcbiAgICBsZXQgaSA9IG87XG4gICAgY29uc3Qgb2xkX2luZGV4ZXMgPSB7fTtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBvbGRfaW5kZXhlc1tvbGRfYmxvY2tzW2ldLmtleV0gPSBpO1xuICAgIGNvbnN0IG5ld19ibG9ja3MgPSBbXTtcbiAgICBjb25zdCBuZXdfbG9va3VwID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGRlbHRhcyA9IG5ldyBNYXAoKTtcbiAgICBpID0gbjtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkX2N0eCA9IGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSk7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IGJsb2NrID0gbG9va3VwLmdldChrZXkpO1xuICAgICAgICBpZiAoIWJsb2NrKSB7XG4gICAgICAgICAgICBibG9jayA9IGNyZWF0ZV9lYWNoX2Jsb2NrKGtleSwgY2hpbGRfY3R4KTtcbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkeW5hbWljKSB7XG4gICAgICAgICAgICBibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xuICAgICAgICB9XG4gICAgICAgIG5ld19sb29rdXAuc2V0KGtleSwgbmV3X2Jsb2Nrc1tpXSA9IGJsb2NrKTtcbiAgICAgICAgaWYgKGtleSBpbiBvbGRfaW5kZXhlcylcbiAgICAgICAgICAgIGRlbHRhcy5zZXQoa2V5LCBNYXRoLmFicyhpIC0gb2xkX2luZGV4ZXNba2V5XSkpO1xuICAgIH1cbiAgICBjb25zdCB3aWxsX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgZGlkX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgZnVuY3Rpb24gaW5zZXJ0KGJsb2NrKSB7XG4gICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICBibG9jay5tKG5vZGUsIG5leHQpO1xuICAgICAgICBsb29rdXAuc2V0KGJsb2NrLmtleSwgYmxvY2spO1xuICAgICAgICBuZXh0ID0gYmxvY2suZmlyc3Q7XG4gICAgICAgIG4tLTtcbiAgICB9XG4gICAgd2hpbGUgKG8gJiYgbikge1xuICAgICAgICBjb25zdCBuZXdfYmxvY2sgPSBuZXdfYmxvY2tzW24gLSAxXTtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvIC0gMV07XG4gICAgICAgIGNvbnN0IG5ld19rZXkgPSBuZXdfYmxvY2sua2V5O1xuICAgICAgICBjb25zdCBvbGRfa2V5ID0gb2xkX2Jsb2NrLmtleTtcbiAgICAgICAgaWYgKG5ld19ibG9jayA9PT0gb2xkX2Jsb2NrKSB7XG4gICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICBuZXh0ID0gbmV3X2Jsb2NrLmZpcnN0O1xuICAgICAgICAgICAgby0tO1xuICAgICAgICAgICAgbi0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBibG9ja1xuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWxvb2t1cC5oYXMobmV3X2tleSkgfHwgd2lsbF9tb3ZlLmhhcyhuZXdfa2V5KSkge1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlkX21vdmUuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVsdGFzLmdldChuZXdfa2V5KSA+IGRlbHRhcy5nZXQob2xkX2tleSkpIHtcbiAgICAgICAgICAgIGRpZF9tb3ZlLmFkZChuZXdfa2V5KTtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgd2lsbF9tb3ZlLmFkZChvbGRfa2V5KTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAoby0tKSB7XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3Nbb107XG4gICAgICAgIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2Jsb2NrLmtleSkpXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICB9XG4gICAgd2hpbGUgKG4pXG4gICAgICAgIGluc2VydChuZXdfYmxvY2tzW24gLSAxXSk7XG4gICAgcmV0dXJuIG5ld19ibG9ja3M7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2tleXMoY3R4LCBsaXN0LCBnZXRfY29udGV4dCwgZ2V0X2tleSkge1xuICAgIGNvbnN0IGtleXMgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKSk7XG4gICAgICAgIGlmIChrZXlzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBoYXZlIGR1cGxpY2F0ZSBrZXlzIGluIGEga2V5ZWQgZWFjaCcpO1xuICAgICAgICB9XG4gICAgICAgIGtleXMuYWRkKGtleSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRfc3ByZWFkX3VwZGF0ZShsZXZlbHMsIHVwZGF0ZXMpIHtcbiAgICBjb25zdCB1cGRhdGUgPSB7fTtcbiAgICBjb25zdCB0b19udWxsX291dCA9IHt9O1xuICAgIGNvbnN0IGFjY291bnRlZF9mb3IgPSB7ICQkc2NvcGU6IDEgfTtcbiAgICBsZXQgaSA9IGxldmVscy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBvID0gbGV2ZWxzW2ldO1xuICAgICAgICBjb25zdCBuID0gdXBkYXRlc1tpXTtcbiAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gbikpXG4gICAgICAgICAgICAgICAgICAgIHRvX251bGxfb3V0W2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbikge1xuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudGVkX2ZvcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gbltrZXldO1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldmVsc1tpXSA9IG47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0b19udWxsX291dCkge1xuICAgICAgICBpZiAoIShrZXkgaW4gdXBkYXRlKSlcbiAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlO1xufVxuZnVuY3Rpb24gZ2V0X3NwcmVhZF9vYmplY3Qoc3ByZWFkX3Byb3BzKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBzcHJlYWRfcHJvcHMgPT09ICdvYmplY3QnICYmIHNwcmVhZF9wcm9wcyAhPT0gbnVsbCA/IHNwcmVhZF9wcm9wcyA6IHt9O1xufVxuXG4vLyBzb3VyY2U6IGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbFxuY29uc3QgYm9vbGVhbl9hdHRyaWJ1dGVzID0gbmV3IFNldChbXG4gICAgJ2FsbG93ZnVsbHNjcmVlbicsXG4gICAgJ2FsbG93cGF5bWVudHJlcXVlc3QnLFxuICAgICdhc3luYycsXG4gICAgJ2F1dG9mb2N1cycsXG4gICAgJ2F1dG9wbGF5JyxcbiAgICAnY2hlY2tlZCcsXG4gICAgJ2NvbnRyb2xzJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RlZmVyJyxcbiAgICAnZGlzYWJsZWQnLFxuICAgICdmb3Jtbm92YWxpZGF0ZScsXG4gICAgJ2hpZGRlbicsXG4gICAgJ2lzbWFwJyxcbiAgICAnbG9vcCcsXG4gICAgJ211bHRpcGxlJyxcbiAgICAnbXV0ZWQnLFxuICAgICdub21vZHVsZScsXG4gICAgJ25vdmFsaWRhdGUnLFxuICAgICdvcGVuJyxcbiAgICAncGxheXNpbmxpbmUnLFxuICAgICdyZWFkb25seScsXG4gICAgJ3JlcXVpcmVkJyxcbiAgICAncmV2ZXJzZWQnLFxuICAgICdzZWxlY3RlZCdcbl0pO1xuXG5jb25zdCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciA9IC9bXFxzJ1wiPi89XFx1e0ZERDB9LVxcdXtGREVGfVxcdXtGRkZFfVxcdXtGRkZGfVxcdXsxRkZGRX1cXHV7MUZGRkZ9XFx1ezJGRkZFfVxcdXsyRkZGRn1cXHV7M0ZGRkV9XFx1ezNGRkZGfVxcdXs0RkZGRX1cXHV7NEZGRkZ9XFx1ezVGRkZFfVxcdXs1RkZGRn1cXHV7NkZGRkV9XFx1ezZGRkZGfVxcdXs3RkZGRX1cXHV7N0ZGRkZ9XFx1ezhGRkZFfVxcdXs4RkZGRn1cXHV7OUZGRkV9XFx1ezlGRkZGfVxcdXtBRkZGRX1cXHV7QUZGRkZ9XFx1e0JGRkZFfVxcdXtCRkZGRn1cXHV7Q0ZGRkV9XFx1e0NGRkZGfVxcdXtERkZGRX1cXHV7REZGRkZ9XFx1e0VGRkZFfVxcdXtFRkZGRn1cXHV7RkZGRkV9XFx1e0ZGRkZGfVxcdXsxMEZGRkV9XFx1ezEwRkZGRn1dL3U7XG4vLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNhdHRyaWJ1dGVzLTJcbi8vIGh0dHBzOi8vaW5mcmEuc3BlYy53aGF0d2cub3JnLyNub25jaGFyYWN0ZXJcbmZ1bmN0aW9uIHNwcmVhZChhcmdzLCBjbGFzc2VzX3RvX2FkZCkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCAuLi5hcmdzKTtcbiAgICBpZiAoY2xhc3Nlc190b19hZGQpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMuY2xhc3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyArPSAnICcgKyBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgc3RyID0gJyc7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgaWYgKGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLnRlc3QobmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKVxuICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke1N0cmluZyh2YWx1ZSkucmVwbGFjZSgvXCIvZywgJyYjMzQ7JykucmVwbGFjZSgvJy9nLCAnJiMzOTsnKX1cImA7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgZXNjYXBlZCA9IHtcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0Oydcbn07XG5mdW5jdGlvbiBlc2NhcGUoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZSgvW1wiJyY8Pl0vZywgbWF0Y2ggPT4gZXNjYXBlZFttYXRjaF0pO1xufVxuZnVuY3Rpb24gZWFjaChpdGVtcywgZm4pIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBzdHIgKz0gZm4oaXRlbXNbaV0sIGkpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgbWlzc2luZ19jb21wb25lbnQgPSB7XG4gICAgJCRyZW5kZXI6ICgpID0+ICcnXG59O1xuZnVuY3Rpb24gdmFsaWRhdGVfY29tcG9uZW50KGNvbXBvbmVudCwgbmFtZSkge1xuICAgIGlmICghY29tcG9uZW50IHx8ICFjb21wb25lbnQuJCRyZW5kZXIpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50JylcbiAgICAgICAgICAgIG5hbWUgKz0gJyB0aGlzPXsuLi59JztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8JHtuYW1lfT4gaXMgbm90IGEgdmFsaWQgU1NSIGNvbXBvbmVudC4gWW91IG1heSBuZWVkIHRvIHJldmlldyB5b3VyIGJ1aWxkIGNvbmZpZyB0byBlbnN1cmUgdGhhdCBkZXBlbmRlbmNpZXMgYXJlIGNvbXBpbGVkLCByYXRoZXIgdGhhbiBpbXBvcnRlZCBhcyBwcmUtY29tcGlsZWQgbW9kdWxlc2ApO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZGVidWcoZmlsZSwgbGluZSwgY29sdW1uLCB2YWx1ZXMpIHtcbiAgICBjb25zb2xlLmxvZyhge0BkZWJ1Z30gJHtmaWxlID8gZmlsZSArICcgJyA6ICcnfSgke2xpbmV9OiR7Y29sdW1ufSlgKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2codmFsdWVzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuICcnO1xufVxubGV0IG9uX2Rlc3Ryb3k7XG5mdW5jdGlvbiBjcmVhdGVfc3NyX2NvbXBvbmVudChmbikge1xuICAgIGZ1bmN0aW9uICQkcmVuZGVyKHJlc3VsdCwgcHJvcHMsIGJpbmRpbmdzLCBzbG90cykge1xuICAgICAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgICAgIGNvbnN0ICQkID0ge1xuICAgICAgICAgICAgb25fZGVzdHJveSxcbiAgICAgICAgICAgIGNvbnRleHQ6IG5ldyBNYXAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSxcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgYmUgaW1tZWRpYXRlbHkgZGlzY2FyZGVkXG4gICAgICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudCh7ICQkIH0pO1xuICAgICAgICBjb25zdCBodG1sID0gZm4ocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVuZGVyOiAocHJvcHMgPSB7fSwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gICAgICAgICAgICBvbl9kZXN0cm95ID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7IHRpdGxlOiAnJywgaGVhZDogJycsIGNzczogbmV3IFNldCgpIH07XG4gICAgICAgICAgICBjb25zdCBodG1sID0gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywge30sIG9wdGlvbnMpO1xuICAgICAgICAgICAgcnVuX2FsbChvbl9kZXN0cm95KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgICAgICBjc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogQXJyYXkuZnJvbShyZXN1bHQuY3NzKS5tYXAoY3NzID0+IGNzcy5jb2RlKS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBudWxsIC8vIFRPRE9cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhlYWQ6IHJlc3VsdC50aXRsZSArIHJlc3VsdC5oZWFkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAkJHJlbmRlclxuICAgIH07XG59XG5mdW5jdGlvbiBhZGRfYXR0cmlidXRlKG5hbWUsIHZhbHVlLCBib29sZWFuKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGJvb2xlYW4gJiYgIXZhbHVlKSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIHJldHVybiBgICR7bmFtZX0ke3ZhbHVlID09PSB0cnVlID8gJycgOiBgPSR7dHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IEpTT04uc3RyaW5naWZ5KGVzY2FwZSh2YWx1ZSkpIDogYFwiJHt2YWx1ZX1cImB9YH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiAnJztcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LnB1c2goLi4ubmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRWRnZSBjYXNlIC0gY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW1tZWRpYXRlbHksXG4gICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgfVxuICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICB9KTtcbiAgICBhZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfY29tcG9uZW50KGNvbXBvbmVudCwgZGV0YWNoaW5nKSB7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQ7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJ1bl9hbGwoJCQub25fZGVzdHJveSk7XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmQoZGV0YWNoaW5nKTtcbiAgICAgICAgLy8gVE9ETyBudWxsIG91dCBvdGhlciByZWZzLCBpbmNsdWRpbmcgY29tcG9uZW50LiQkIChidXQgbmVlZCB0b1xuICAgICAgICAvLyBwcmVzZXJ2ZSBmaW5hbCBzdGF0ZT8pXG4gICAgICAgICQkLm9uX2Rlc3Ryb3kgPSAkJC5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgICQkLmN0eCA9IFtdO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKSB7XG4gICAgaWYgKGNvbXBvbmVudC4kJC5kaXJ0eVswXSA9PT0gLTEpIHtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgICAgICBjb21wb25lbnQuJCQuZGlydHkuZmlsbCgwKTtcbiAgICB9XG4gICAgY29tcG9uZW50LiQkLmRpcnR5WyhpIC8gMzEpIHwgMF0gfD0gKDEgPDwgKGkgJSAzMSkpO1xufVxuZnVuY3Rpb24gaW5pdChjb21wb25lbnQsIG9wdGlvbnMsIGluc3RhbmNlLCBjcmVhdGVfZnJhZ21lbnQsIG5vdF9lcXVhbCwgcHJvcHMsIGRpcnR5ID0gWy0xXSkge1xuICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJCA9IHtcbiAgICAgICAgZnJhZ21lbnQ6IG51bGwsXG4gICAgICAgIGN0eDogbnVsbCxcbiAgICAgICAgLy8gc3RhdGVcbiAgICAgICAgcHJvcHMsXG4gICAgICAgIHVwZGF0ZTogbm9vcCxcbiAgICAgICAgbm90X2VxdWFsLFxuICAgICAgICBib3VuZDogYmxhbmtfb2JqZWN0KCksXG4gICAgICAgIC8vIGxpZmVjeWNsZVxuICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgIG9uX2Rlc3Ryb3k6IFtdLFxuICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgY29udGV4dDogbmV3IE1hcChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pLFxuICAgICAgICAvLyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgZGlydHksXG4gICAgICAgIHNraXBfYm91bmQ6IGZhbHNlXG4gICAgfTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgb3B0aW9ucy5wcm9wcyB8fCB7fSwgKGksIHJldCwgLi4ucmVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXN0Lmxlbmd0aCA/IHJlc3RbMF0gOiByZXQ7XG4gICAgICAgICAgICBpZiAoJCQuY3R4ICYmIG5vdF9lcXVhbCgkJC5jdHhbaV0sICQkLmN0eFtpXSA9IHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICghJCQuc2tpcF9ib3VuZCAmJiAkJC5ib3VuZFtpXSlcbiAgICAgICAgICAgICAgICAgICAgJCQuYm91bmRbaV0odmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkeSlcbiAgICAgICAgICAgICAgICAgICAgbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXTtcbiAgICAkJC51cGRhdGUoKTtcbiAgICByZWFkeSA9IHRydWU7XG4gICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAvLyBgZmFsc2VgIGFzIGEgc3BlY2lhbCBjYXNlIG9mIG5vIERPTSBjb21wb25lbnRcbiAgICAkJC5mcmFnbWVudCA9IGNyZWF0ZV9mcmFnbWVudCA/IGNyZWF0ZV9mcmFnbWVudCgkJC5jdHgpIDogZmFsc2U7XG4gICAgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmh5ZHJhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gY2hpbGRyZW4ob3B0aW9ucy50YXJnZXQpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50Lmwobm9kZXMpO1xuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChkZXRhY2gpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5pbnRybylcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oY29tcG9uZW50LiQkLmZyYWdtZW50KTtcbiAgICAgICAgbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucy50YXJnZXQsIG9wdGlvbnMuYW5jaG9yKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLiQkLnNsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy4kJC5zbG90dGVkW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhhdHRyLCBfb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzW2F0dHJdID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgJGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy8gVE9ETyBzaG91bGQgdGhpcyBkZWxlZ2F0ZSB0byBhZGRFdmVudExpc3RlbmVyP1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzLiBVc2VkIHdoZW4gZGV2PWZhbHNlLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnQge1xuICAgICRkZXN0cm95KCkge1xuICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgfVxuICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkaXNwYXRjaF9kZXYodHlwZSwgZGV0YWlsKSB7XG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQodHlwZSwgT2JqZWN0LmFzc2lnbih7IHZlcnNpb246ICczLjMyLjMnIH0sIGRldGFpbCkpKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmQodGFyZ2V0LCBub2RlKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9kZXYodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlLCBhbmNob3IgfSk7XG4gICAgaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwZXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXNzaWduLCBhdHRyLCBhdHRyX2RldiwgYXR0cmlidXRlX3RvX29iamVjdCwgYmVmb3JlVXBkYXRlLCBiaW5kLCBiaW5kaW5nX2NhbGxiYWNrcywgYmxhbmtfb2JqZWN0LCBidWJibGUsIGNoZWNrX291dHJvcywgY2hpbGRyZW4sIGNsYWltX2NvbXBvbmVudCwgY2xhaW1fZWxlbWVudCwgY2xhaW1fc3BhY2UsIGNsYWltX3RleHQsIGNsZWFyX2xvb3BzLCBjb21wb25lbnRfc3Vic2NyaWJlLCBjb21wdXRlX3Jlc3RfcHJvcHMsIGNvbXB1dGVfc2xvdHMsIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciwgY3JlYXRlX2FuaW1hdGlvbiwgY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbiwgY3JlYXRlX2NvbXBvbmVudCwgY3JlYXRlX2luX3RyYW5zaXRpb24sIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbiwgY3JlYXRlX3Nsb3QsIGNyZWF0ZV9zc3JfY29tcG9uZW50LCBjdXJyZW50X2NvbXBvbmVudCwgY3VzdG9tX2V2ZW50LCBkYXRhc2V0X2RldiwgZGVidWcsIGRlc3Ryb3lfYmxvY2ssIGRlc3Ryb3lfY29tcG9uZW50LCBkZXN0cm95X2VhY2gsIGRldGFjaCwgZGV0YWNoX2FmdGVyX2RldiwgZGV0YWNoX2JlZm9yZV9kZXYsIGRldGFjaF9iZXR3ZWVuX2RldiwgZGV0YWNoX2RldiwgZGlydHlfY29tcG9uZW50cywgZGlzcGF0Y2hfZGV2LCBlYWNoLCBlbGVtZW50LCBlbGVtZW50X2lzLCBlbXB0eSwgZXNjYXBlLCBlc2NhcGVkLCBleGNsdWRlX2ludGVybmFsX3Byb3BzLCBmaXhfYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9wb3NpdGlvbiwgZmx1c2gsIGdldENvbnRleHQsIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlLCBnZXRfY3VycmVudF9jb21wb25lbnQsIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHQsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW50cm9zLCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciwgaXNfY2xpZW50LCBpc19jcm9zc29yaWdpbiwgaXNfZW1wdHksIGlzX2Z1bmN0aW9uLCBpc19wcm9taXNlLCBsaXN0ZW4sIGxpc3Rlbl9kZXYsIGxvb3AsIGxvb3BfZ3VhcmQsIG1pc3NpbmdfY29tcG9uZW50LCBtb3VudF9jb21wb25lbnQsIG5vb3AsIG5vdF9lcXVhbCwgbm93LCBudWxsX3RvX2VtcHR5LCBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzLCBvbkRlc3Ryb3ksIG9uTW91bnQsIG9uY2UsIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBwcmV2ZW50X2RlZmF1bHQsIHByb3BfZGV2LCBxdWVyeV9zZWxlY3Rvcl9hbGwsIHJhZiwgcnVuLCBydW5fYWxsLCBzYWZlX25vdF9lcXVhbCwgc2NoZWR1bGVfdXBkYXRlLCBzZWxlY3RfbXVsdGlwbGVfdmFsdWUsIHNlbGVjdF9vcHRpb24sIHNlbGVjdF9vcHRpb25zLCBzZWxlY3RfdmFsdWUsIHNlbGYsIHNldENvbnRleHQsIHNldF9hdHRyaWJ1dGVzLCBzZXRfY3VycmVudF9jb21wb25lbnQsIHNldF9jdXN0b21fZWxlbWVudF9kYXRhLCBzZXRfZGF0YSwgc2V0X2RhdGFfZGV2LCBzZXRfaW5wdXRfdHlwZSwgc2V0X2lucHV0X3ZhbHVlLCBzZXRfbm93LCBzZXRfcmFmLCBzZXRfc3RvcmVfdmFsdWUsIHNldF9zdHlsZSwgc2V0X3N2Z19hdHRyaWJ1dGVzLCBzcGFjZSwgc3ByZWFkLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X3NwcmVhZCwgdmFsaWRhdGVfY29tcG9uZW50LCB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50LCB2YWxpZGF0ZV9lYWNoX2tleXMsIHZhbGlkYXRlX3Nsb3RzLCB2YWxpZGF0ZV9zdG9yZSwgeGxpbmtfYXR0ciB9O1xuIiwiaW1wb3J0IHsgaW5pdCB9IGZyb20gJy4vaW5kaWNhdG9yRm9ybSdcclxuXHJcbmNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MRm9ybUVsZW1lbnQ+KCdbZGF0YS1jb21wb25lbnQ9XCJpbmRpY2F0b3JGb3JtXCJdJylcclxuXHJcbmZvcm1zLmZvckVhY2goKGZvcm0pOiB2b2lkID0+IHtcclxuICAgIGluaXQoZm9ybSk7XHJcbn0pXHJcbiIsIjxzY3JpcHQgbGFuZz1cInR5cGVzY3JpcHRcIj5leHBvcnQgbGV0IG5hbWUgPSAnJztcclxuZXhwb3J0IGxldCBjbGFzc05hbWVzO1xyXG48L3NjcmlwdD5cclxuXHJcbjxoMVxyXG4gIGNsYXNzPVwidGV4dC0zeGwgZm9udC1zZW1pYm9sZCB7IGNsYXNzTmFtZXMgPyBgICR7Y2xhc3NOYW1lc31gIDogJyd9XCJcclxuPlxyXG4gIHsgbmFtZSB9XHJcbjwvaDE+IiwiZXhwb3J0IGNvbnN0IGVwY2lzX2RlZmF1bHQgPSB7XHJcbiAgICBcInRlc3RcIjogXCJWaWxsZSBkZSB0ZXN0XCIsXHJcbiAgICBcImNsdW5pc29pc1wiOiBcIkNDIGR1IENsdW5pc29pc1wiLFxyXG4gICAgXCJjb2V1cl9zYXZvaWVcIjogXCJDQyBDb2V1ciBkZSBTYXZvaWVcIixcclxuICAgIFwiZG91YnNfYmF1bW9pc1wiOiBcIkNDIERvdWJzIEJhdW1vaXNcIixcclxuICAgIFwiaGF1dF9wb2l0b3VcIjogXCJDQyBIYXV0IFBvaXRvdVwiLFxyXG4gICAgXCJwYXlzX3JldGhlbG9pc1wiOiBcIkNDIFBheXMgUmV0aFxcdTAwZTlsb2lzXCIsXHJcbiAgICBcInB5cmVuZWVzX2dhdmVzXCI6IFwiQ0MgUHlyXFx1MDBlOW5cXHUwMGU5ZXMgVmFsbFxcdTAwZTllcyBkZXMgR2F2ZXNcIixcclxuICAgIFwidGVycmVzX2hhdXRfYmVycnlcIjogXCJDQyBUZXJyZXMgZHUgSGF1dCBCZXJyeVwiLFxyXG4gICAgXCJ0b3VyYWluZV9lc3RcIjogXCJDQyBUb3VyYWluZS1Fc3QgVmFsbFxcdTAwZTllc1wiLFxyXG4gICAgXCJjeWNsYWRcIjogXCJDeWNsYWRcIixcclxuICAgIFwiaGVubmVib250XCI6IFwiSGVubmVib250XCIsXHJcbiAgICBcInBsb2VtZXVyXCI6IFwiUGxcXHUwMTUzbWV1clwiXHJcbn0iLCI8c2NyaXB0IGxhbmc9XCJ0c1wiPmltcG9ydCB7IGdldEN1cnJlbnRFcGNpSWQgfSBmcm9tIFwiLi4vLi4vYXBpL2N1cnJlbnRFcGNpXCI7XHJcbmltcG9ydCB7IGVwY2lzX2RlZmF1bHQgfSBmcm9tIFwiLi4vLi4vLi4vdmVuZG9ycy9lcGNpc19kZWZhdWx0XCI7XHJcbmNvbnN0IGVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKTtcclxuY29uc3QgZXBjaU5hbWUgPSBlcGNpc19kZWZhdWx0W2VwY2lJZF07XHJcbjwvc2NyaXB0PlxyXG5cclxue2VwY2lOYW1lfSA8YSBocmVmPVwiLz9lcGNpX2lkPXtlcGNpSWR9XCIgY2xhc3M9XCJ1bmRlcmxpbmVcIj4obW9kaWZpZXIpPC9hPlxyXG4iLCI8c2NyaXB0PlxyXG4gIGltcG9ydCBFcGNpTmF2RGlzcGxheSBmcm9tIFwiLi9FcGNpTmF2RGlzcGxheS5zdmVsdGVcIjtcclxuICBpbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuXHJcbiAgbGV0IGVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKVxyXG48L3NjcmlwdD5cclxuPG5hdiBjbGFzcz1cImJnLWdyZWVuLTYwMFwiPlxyXG4gIDx1bCBjbGFzcz1cImNvbnRhaW5lciBteC1hdXRvIGxnOnB4LTIwIHB4LTQgcC00IGZsZXggdGV4dC14bFwiPlxyXG4gICAgPGxpIGNsYXNzPVwibXItNFwiPlxyXG4gICAgICA8YSBjbGFzcz1cInAtMSByb3VuZGVkIGhvdmVyOmJnLWdyYXktMTAwIGhvdmVyOnRleHQtZ3JheS03MDAgZm9jdXM6YmctZ3JheS0xMDAgZm9jdXM6dGV4dC1ncmF5LTcwMCBhY3RpdmU6dGV4dC1ncmF5LTkwMCBhY3RpdmU6c2hhZG93LWlubmVyIGFjdGl2ZTpiZy13aGl0ZVwiXHJcbiAgICAgICAgIGhyZWY9XCIvP2VwY2lfaWQ9e2VwY2lJZH1cIj5cclxuICAgICAgICBUZXJyaXRvaXJlcyBlbiBUcmFuc2l0aW9uc1xyXG4gICAgICA8L2E+XHJcbiAgICA8L2xpPlxyXG4gICAgPGxpIGNsYXNzPVwibXItNCBmbGV4LWdyb3cgdGV4dC1jZW50ZXJcIj5cclxuICAgICAgPEVwY2lOYXZEaXNwbGF5Lz5cclxuICAgIDwvbGk+XHJcbiAgICA8bGkgY2xhc3M9XCJtci00XCI+XHJcbiAgICAgIDxhIGNsYXNzPVwicC0xIHJvdW5kZWQgaG92ZXI6YmctZ3JheS0xMDAgaG92ZXI6dGV4dC1ncmF5LTcwMCBmb2N1czpiZy1ncmF5LTEwMCBmb2N1czp0ZXh0LWdyYXktNzAwIGFjdGl2ZTp0ZXh0LWdyYXktOTAwIGFjdGl2ZTpzaGFkb3ctaW5uZXIgYWN0aXZlOmJnLXdoaXRlXCJcclxuICAgICAgICAgaHJlZj1cImZpY2hlcy8/ZXBjaV9pZD17ZXBjaUlkfVwiPlxyXG4gICAgICAgIFBsYW4gZCdhY3Rpb25zXHJcbiAgICAgIDwvYT5cclxuICAgIDwvbGk+XHJcbiAgICA8bGkgY2xhc3M9XCJtci00XCI+XHJcbiAgICAgIDxhIGNsYXNzPVwicC0xIHJvdW5kZWQgaG92ZXI6YmctZ3JheS0xMDAgaG92ZXI6dGV4dC1ncmF5LTcwMCBmb2N1czpiZy1ncmF5LTEwMCBmb2N1czp0ZXh0LWdyYXktNzAwIGFjdGl2ZTp0ZXh0LWdyYXktOTAwIGFjdGl2ZTpzaGFkb3ctaW5uZXIgYWN0aXZlOmJnLXdoaXRlXCJcclxuICAgICAgICAgaHJlZj1cIm1lc3VyZXMuaHRtbFwiPlxyXG4gICAgICAgIFLDqWbDqXJlbnRpZWxzXHJcbiAgICAgIDwvYT5cclxuICAgIDwvbGk+XHJcbiAgICA8bGkgY2xhc3M9XCJtci00XCI+XHJcbiAgICAgIDxhIGNsYXNzPVwicC0xIHJvdW5kZWQgaG92ZXI6YmctZ3JheS0xMDAgaG92ZXI6dGV4dC1ncmF5LTcwMCBmb2N1czpiZy1ncmF5LTEwMCBmb2N1czp0ZXh0LWdyYXktNzAwIGFjdGl2ZTp0ZXh0LWdyYXktOTAwIGFjdGl2ZTpzaGFkb3ctaW5uZXIgYWN0aXZlOmJnLXdoaXRlXCJcclxuICAgICAgICAgaHJlZj1cImluZGljYXRldXJzLmh0bWxcIj5cclxuICAgICAgICBJbmRpY2F0ZXVyc1xyXG4gICAgICA8L2E+XHJcbiAgICA8L2xpPlxyXG4gIDwvdWw+XHJcbjwvbmF2PiIsIjxzY3JpcHQgbGFuZz1cInR5cGVzY3JpcHRcIj52YXIgY29sb3JWYXJpYW50cztcclxuKGZ1bmN0aW9uIChjb2xvclZhcmlhbnRzKSB7XHJcbiAgICBjb2xvclZhcmlhbnRzW2NvbG9yVmFyaWFudHNbXCJuZXR0bGVcIl0gPSAwXSA9IFwibmV0dGxlXCI7XHJcbiAgICBjb2xvclZhcmlhbnRzW2NvbG9yVmFyaWFudHNbXCJicmFtYmxlXCJdID0gMV0gPSBcImJyYW1ibGVcIjtcclxufSkoY29sb3JWYXJpYW50cyB8fCAoY29sb3JWYXJpYW50cyA9IHt9KSk7XHJcbnZhciBzaXplcztcclxuKGZ1bmN0aW9uIChzaXplcykge1xyXG4gICAgc2l6ZXNbc2l6ZXNbXCJub3JtYWxcIl0gPSAwXSA9IFwibm9ybWFsXCI7XHJcbiAgICBzaXplc1tzaXplc1tcInNtYWxsXCJdID0gMV0gPSBcInNtYWxsXCI7XHJcbn0pKHNpemVzIHx8IChzaXplcyA9IHt9KSk7XHJcbmV4cG9ydCBsZXQgbGFiZWwgPSAnJztcclxuZXhwb3J0IGxldCBmdWxsID0gZmFsc2U7XHJcbmV4cG9ydCBsZXQgY2xhc3NOYW1lcyA9ICcnO1xyXG5leHBvcnQgbGV0IGNvbG9yVmFyaWFudCA9ICduZXR0bGUnO1xyXG5leHBvcnQgbGV0IHNpemUgPSAnbm9ybWFsJztcclxuZXhwb3J0IGxldCBhc0xpbmsgPSBmYWxzZTtcclxuZXhwb3J0IGxldCBocmVmID0gJyc7XHJcbmxldCBidXR0b25DbGFzc05hbWVzID0gJyc7XHJcbi8qKlxyXG4gKiBDb2xvciB2YXJpYW50c1xyXG4gKi9cclxuaWYgKGNvbG9yVmFyaWFudCA9PSAnbmV0dGxlJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPVxyXG4gICAgICAgICcgYm9yZGVyLWdyZWVuLTcwMCBib3JkZXItMiBob3ZlcjpiZy1ncmVlbi0xMDAgYWN0aXZlOmJnLWdyZWVuLTYwMCc7XHJcbn1cclxuaWYgKGNvbG9yVmFyaWFudCA9PSAnYnJhbWJsZScpIHtcclxuICAgIGJ1dHRvbkNsYXNzTmFtZXMgKz1cclxuICAgICAgICAnIGJvcmRlci1ncmF5LTgwMCBib3JkZXIgaG92ZXI6YmctZ3JlZW4tMTAwIGFjdGl2ZTpiZy1ncmVlbi02MDAnO1xyXG59XHJcbi8qKlxyXG4gKiBTaXplIHZhcmlhbnRzXHJcbiAqL1xyXG5pZiAoc2l6ZSA9PSAnbm9ybWFsJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPSAnIHB4LTYgcHktMyc7XHJcbn1cclxuaWYgKHNpemUgPT0gJ3NtYWxsJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPSAnIHRleHQtYmFzZSBweC0zIHB5LTMnO1xyXG59XHJcbjwvc2NyaXB0PlxyXG5cclxueyNpZiBhc0xpbmt9XHJcbiAgICA8YVxyXG4gICAgICAgICAgICBjbGFzczp3LWZ1bGw9e2Z1bGx9XHJcbiAgICAgICAgICAgIGhyZWY9XCJ7IGhyZWYgfVwiXHJcbiAgICAgICAgICAgIGNsYXNzPVwiXHJcbiAgXHR7YnV0dG9uQ2xhc3NOYW1lc31cclxuICBcdHtjbGFzc05hbWVzID8gYCAke2NsYXNzTmFtZXN9YCA6ICcnfVwiXHJcbiAgICA+XHJcbiAgICAgICAge2xhYmVsfVxyXG4gICAgPC9hPlxyXG57OmVsc2UgfVxyXG4gICAgPGJ1dHRvblxyXG4gICAgICAgICAgICBvbjpjbGlja1xyXG4gICAgICAgICAgICBjbGFzczp3LWZ1bGw9e2Z1bGx9XHJcbiAgICAgICAgICAgIGNsYXNzPVwiXHJcbiAgXHR7YnV0dG9uQ2xhc3NOYW1lc31cclxuICBcdHtjbGFzc05hbWVzID8gYCAke2NsYXNzTmFtZXN9YCA6ICcnfVwiXHJcbiAgICA+XHJcbiAgICAgICAge2xhYmVsfVxyXG4gICAgPC9idXR0b24+XHJcblxyXG57L2lmfSIsIjxzY3JpcHQgbGFuZz1cInRzXCI+dmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5pbXBvcnQgeyBhY3Rpb25TdGF0dXNTdG9yZSB9IGZyb20gXCIuLi8uLi9hcGkvaHlicmlkU3RvcmVcIjtcclxuaW1wb3J0IHsgZ2V0Q3VycmVudEVwY2lJZCB9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuaW1wb3J0IHsgQWN0aW9uU3RhdHVzU3RvcmFibGUgfSBmcm9tIFwiLi4vLi4vc3RvcmFibGVzL0FjdGlvblN0YXR1c1N0b3JhYmxlXCI7XHJcbmV4cG9ydCBsZXQgYWN0aW9uSWQ7XHJcbmNvbnN0IGF2YW5jZW1lbnRzID0gW1xyXG4gICAge1xyXG4gICAgICAgIGtleTogJ25vbl9jb25jZXJuZWUnLFxyXG4gICAgICAgIGxhYmVsOiAnTm9uIGNvbmNlcm7DqWUnLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBrZXk6ICdwYXNfZmFpdGUnLFxyXG4gICAgICAgIGxhYmVsOiAnUGFzIGZhaXRlJyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAga2V5OiAncHJvZ3JhbW1lZScsXHJcbiAgICAgICAgbGFiZWw6ICdQcsOpdnVlJyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAga2V5OiAnZW5fY291cnMnLFxyXG4gICAgICAgIGxhYmVsOiAnRW4gY291cnMnLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBrZXk6ICdmYWl0ZScsXHJcbiAgICAgICAgbGFiZWw6ICdGYWl0ZScsXHJcbiAgICB9LFxyXG5dO1xyXG5jb25zdCBjbGFzc2VzID0gW1xyXG4gICAgJ2JvcmRlciByb3VuZGVkLWwgZmxleC0xIGJsb2NrIHdoaXRlc3BhY2Utbm93cmFwIHB4LTIgcHktMSBjdXJzb3ItcG9pbnRlciBib3JkZXItZ3JheS00MDAnLFxyXG4gICAgJ2JvcmRlci10IGJvcmRlci1yIGJvcmRlci1iIGZsZXgtMSBibG9jayB3aGl0ZXNwYWNlLW5vd3JhcCBweC0yIHB5LTEgY3Vyc29yLXBvaW50ZXIgYm9yZGVyLWdyYXktNDAwJyxcclxuICAgICdib3JkZXItdCBib3JkZXItciBib3JkZXItYiBmbGV4LTEgYmxvY2sgd2hpdGVzcGFjZS1ub3dyYXAgcHgtMiBweS0xIGN1cnNvci1wb2ludGVyIGJvcmRlci1ncmF5LTQwMCcsXHJcbiAgICAnYm9yZGVyLXQgYm9yZGVyLXIgYm9yZGVyLWIgcm91bmRlZC1yIGZsZXgtMSBibG9jayB3aGl0ZXNwYWNlLW5vd3JhcCBweC0yIHB5LTEgY3Vyc29yLXBvaW50ZXIgYm9yZGVyLWdyYXktNDAwJyxcclxuXTtcclxuY29uc3QgZWNwaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpO1xyXG5sZXQgYWN0aW9uQXZhbmNlbWVudEtleSA9ICdwYXNfZmFpdGUnO1xyXG4vKipcclxuICogT24gaW5wdXQgY2hhbmdlIHN0b3JlL292ZXJ3cml0ZSBhY3Rpb24gc3RhdHVzLlxyXG4gKi9cclxuY29uc3QgaGFuZGxlQ2hhbmdlID0gKF8pID0+IHtcclxuICAgIGNvbnN0IGF2YW5jZW1lbnQgPSBuZXcgQWN0aW9uU3RhdHVzU3RvcmFibGUoe1xyXG4gICAgICAgIGVwY2lfaWQ6IGVjcGlJZCxcclxuICAgICAgICBhY3Rpb25faWQ6IGFjdGlvbklkLFxyXG4gICAgICAgIGF2YW5jZW1lbnQ6IGFjdGlvbkF2YW5jZW1lbnRLZXlcclxuICAgIH0pO1xyXG4gICAgYWN0aW9uU3RhdHVzU3RvcmUuc3RvcmUoYXZhbmNlbWVudCk7XHJcbn07XHJcbi8qKlxyXG4gKiBHZXQgZGF0YSBmcm9tIHN0b3JlLlxyXG4gKi9cclxuY29uc3QgZmV0Y2ggPSAoKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgIGNvbnN0IHN0YXR1cyA9IHlpZWxkIGFjdGlvblN0YXR1c1N0b3JlLnJldHJpZXZlQnlJZChgJHtlY3BpSWR9LyR7YWN0aW9uSWR9YCk7XHJcbiAgICBpZiAoc3RhdHVzKVxyXG4gICAgICAgIGFjdGlvbkF2YW5jZW1lbnRLZXkgPSBzdGF0dXMuYXZhbmNlbWVudDtcclxufSk7XHJcbmZldGNoKCk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPGZvcm0gY2xhc3M9XCJsZzpjb2wtc3Bhbi01IGxnOmNvbC1lbmQtMTMgZ3JpZCBqdXN0aWZ5LWl0ZW1zLWVuZFwiPlxyXG4gICAgPGZpZWxkc2V0IGNsYXNzPVwiZmxleCBzdGF0dXNcIiBkYXRhLWFjdGlvbi1pZD1cInthY3Rpb25JZH1cIj5cclxuICAgICAgICB7I2VhY2ggYXZhbmNlbWVudHMgYXMgYXZhbmNlbWVudCwgaW5kZXh9XHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmluZDpncm91cD17YWN0aW9uQXZhbmNlbWVudEtleX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb246Y2hhbmdlPXtoYW5kbGVDaGFuZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPVwie2F2YW5jZW1lbnQua2V5fVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiYWN0aW9uLXthY3Rpb25JZH1fe2F2YW5jZW1lbnQua2V5fVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9XCJhY3Rpb24te2FjdGlvbklkfV9zdGF0dXNcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicmFkaW9cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cInNyLW9ubHlcIlxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgPGxhYmVsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcj1cImFjdGlvbi17YWN0aW9uSWR9X3thdmFuY2VtZW50LmtleX1cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz17Y2xhc3Nlc1tpbmRleF19XHJcbiAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgeyBhdmFuY2VtZW50LmxhYmVsIH1cclxuICAgICAgICAgICAgICAgIDwvbGFiZWw+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIHsvZWFjaH1cclxuICAgIDwvZmllbGRzZXQ+XHJcbjwvZm9ybT5cclxuIiwiPHNjcmlwdCBsYW5nPVwidHNcIj52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbmltcG9ydCBBY3Rpb25TdGF0dXMgZnJvbSAnLi9BY3Rpb25TdGF0dXMuc3ZlbHRlJztcclxuaW1wb3J0IEJ1dHRvbiBmcm9tIFwiLi4vc2hhcmVkL0J1dHRvbi5zdmVsdGVcIjtcclxuaW1wb3J0IHsgY3JlYXRlRXZlbnREaXNwYXRjaGVyIH0gZnJvbSBcInN2ZWx0ZVwiO1xyXG5pbXBvcnQgeyBBY3Rpb25DdXN0b21TdG9yYWJsZSB9IGZyb20gXCIuLi8uLi9zdG9yYWJsZXMvQWN0aW9uQ3VzdG9tU3RvcmFibGVcIjtcclxuaW1wb3J0IHsgYWN0aW9uQ3VzdG9tU3RvcmUgfSBmcm9tIFwiLi4vLi4vYXBpL2h5YnJpZFN0b3JlXCI7XHJcbmV4cG9ydCBsZXQgYWN0aW9uO1xyXG5jb25zdCBkaXNwYXRjaCA9IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpO1xyXG5jb25zdCBoYW5kbGVEZWxldGUgPSAoZXZlbnQpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IGNvbmZpcm1EZWxldGUgPSBjb25maXJtKCfDinRlcy12b3VzIHPDu3LigKJlIGRlIHZvdWxvaXIgc3VwcHJpbWVyIHVuZSBkZSB2b3MgYWN0aW9ucyBwZXJzb25uYWxpc8OpZXMgPycpO1xyXG4gICAgaWYgKGNvbmZpcm1EZWxldGUpIHtcclxuICAgICAgICB5aWVsZCBhY3Rpb25DdXN0b21TdG9yZS5kZWxldGVCeUlkKGFjdGlvbi5pZCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVE9ETzogcmVtb3ZlIHRoaXMgZGlzcGF0Y2hlciB3aGVuIHdlIGhhdmUgYSBnbG9iYWwgYXBwbGljYXRpb24gc3RhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICBkaXNwYXRjaCgnZGVsZXRlJywgYWN0aW9uLmlkKTtcclxuICAgIH1cclxufSk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPHNlY3Rpb25cclxuICAgICAgICBjbGFzcz1cInAtNCByb3VuZGVkIG15LTQgYWN0aW9uIGdyaWQgZ3JpZC1jb2xzLTEgbGc6Z3JpZC1jb2xzLTEyIGxnOmdhcC00IGJnLXdoaXRlIFwiXHJcbiAgICAgICAgaWQ9XCJhY3Rpb24te2FjdGlvbi51aWR9XCI+XHJcblxyXG4gICAgPGRpdiBjbGFzcz1cInJlbGF0aXZlIGxnOmNvbC1zcGFuLTdcIj5cclxuICAgICAgICA8aDMgY2xhc3M9XCJwci0yOFwiPnthY3Rpb24ubmFtZX08L2gzPlxyXG4gICAgICAgIDxkZXRhaWxzIGNsYXNzPVwiZXhwYW5kYWJsZVwiPlxyXG4gICAgICAgICAgICA8c3VtbWFyeSBjbGFzcz1cImJvcmRlciBib3JkZXItZ3JheS00MDAgcm91bmRlZCBweC0yIHB5LTEgYWJzb2x1dGUgdG9wLTBcclxuICAgICAgICAgcmlnaHQtMCBjdXJzb3ItcG9pbnRlciBob3ZlcjpiZy1ncmF5LTIwMFwiPlBsdXNcclxuICAgICAgICAgICAgPC9zdW1tYXJ5PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGV0YWlscy1jb250ZW50IHdoaXRlc3BhY2UtcHJlXCI+XHJcbiAgICAgICAgICAgICAgICB7YWN0aW9uLmRlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsPVwiU3VwcHJpbWVyXCJcclxuICAgICAgICAgICAgICAgICAgICBjb2xvclZhcmlhbnQ9XCJicmFtYmxlXCJcclxuICAgICAgICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9uOmNsaWNrPXtoYW5kbGVEZWxldGV9XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lcz1cIlwiXHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9kZXRhaWxzPlxyXG4gICAgPC9kaXY+XHJcbiAgICA8QWN0aW9uU3RhdHVzIGFjdGlvbklkPXthY3Rpb24udWlkfS8+XHJcbjwvc2VjdGlvbj5cclxuIiwiPHNjcmlwdCBsYW5nPVwidHlwZXNjcmlwdFwiPnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuaW1wb3J0IFRpdGxlIGZyb20gJy4uL3NoYXJlZC9UaXRsZSc7XHJcbmltcG9ydCBOYXYgZnJvbSAnLi4vc2hhcmVkL05hdic7XHJcbmltcG9ydCB7IGdldFVybFBhcmFtZXRlciB9IGZyb20gJy4uLy4uL3V0aWxzL3VybCc7XHJcbmltcG9ydCBCdXR0b24gZnJvbSBcIi4uL3NoYXJlZC9CdXR0b24uc3ZlbHRlXCI7XHJcbmltcG9ydCBBY3Rpb24gZnJvbSBcIi4uL2FjdGlvbnMvQWN0aW9uLnN2ZWx0ZVwiO1xyXG5pbXBvcnQgeyBhY3Rpb25DdXN0b21TdG9yZSwgbWVzdXJlQ3VzdG9tU3RvcmUgfSBmcm9tIFwiLi4vLi4vYXBpL2h5YnJpZFN0b3JlXCI7XHJcbmltcG9ydCB7IEFjdGlvbkN1c3RvbVN0b3JhYmxlIH0gZnJvbSBcIi4uLy4uL3N0b3JhYmxlcy9BY3Rpb25DdXN0b21TdG9yYWJsZVwiO1xyXG5pbXBvcnQgeyBnZXRDdXJyZW50RXBjaUlkIH0gZnJvbSBcIi4uLy4uL2FwaS9jdXJyZW50RXBjaVwiO1xyXG5pbXBvcnQgeyBNZXN1cmVDdXN0b21TdG9yYWJsZSB9IGZyb20gXCIuLi8uLi9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGVcIjtcclxuY29uc3QgZWNwaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpO1xyXG5jb25zdCBtZXN1cmVVaWQgPSBnZXRVcmxQYXJhbWV0ZXIoJ21lc3VyZV91aWQnKTtcclxuY29uc3QgbWVzdXJlSWQgPSBNZXN1cmVDdXN0b21TdG9yYWJsZS5idWlsZElkKGVjcGlJZCwgbWVzdXJlVWlkKTtcclxubGV0IG1lc3VyZTtcclxubGV0IGFjdGlvbnMgPSBbXTtcclxuY29uc3QgdXBkYXRlQWN0aW9ucyA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgYWN0aW9ucyA9IHlpZWxkIGFjdGlvbkN1c3RvbVN0b3JlLnJldHJpZXZlQXRQYXRoKGAke2VjcGlJZH0vJHttZXN1cmVVaWR9YCk7XHJcbn0pO1xyXG5jb25zdCBmZXRjaCA9ICgpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgbWVzdXJlID0geWllbGQgbWVzdXJlQ3VzdG9tU3RvcmUucmV0cmlldmVCeUlkKG1lc3VyZUlkKTtcclxuICAgIHlpZWxkIHVwZGF0ZUFjdGlvbnMoKTtcclxufSk7XHJcbmZldGNoKCk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPE5hdi8+XHJcbjxtYWluIGNsYXNzPVwiY29udGFpbmVyIG14LWF1dG8gbGc6cHgtMjAgcHgtNFwiIGlkPVwibWVzdXJlLTYuNS41XCI+XHJcbiAgICA8aGVhZGVyIGNsYXNzPVwiZmxleCBteS0xMFwiPlxyXG4gICAgICAgIHsjaWYgbWVzdXJlICE9IG51bGx9XHJcbiAgICAgICAgICAgIDxUaXRsZVxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU9e21lc3VyZS5uYW1lfVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZXM9XCJmbGV4LWdyb3dcIlxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgYXNMaW5rXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw9XCJBam91dGVyIHVuZSBhY3Rpb25cIlxyXG4gICAgICAgICAgICAgICAgICAgIGhyZWY9XCJhY3Rpb25fYWpvdXQuaHRtbD9lcGNpX2lkPXtlY3BpSWR9Jm1lc3VyZV91aWQ9e21lc3VyZS51aWR9XCJcclxuICAgICAgICAgICAgLz5cclxuICAgICAgICB7L2lmfVxyXG4gICAgPC9oZWFkZXI+XHJcbiAgICB7I2VhY2ggYWN0aW9ucyBhcyBhY3Rpb259XHJcbiAgICAgICAgPEFjdGlvblxyXG4gICAgICAgICAgICAgICAgb246ZGVsZXRlPXt1cGRhdGVBY3Rpb25zfVxyXG4gICAgICAgICAgICAgICAgYWN0aW9uPXthY3Rpb259Lz5cclxuICAgIHsvZWFjaH1cclxuPC9tYWluPiIsImV4cG9ydCBjb25zdCBnZXRVcmxQYXJhbWV0ZXIgPSAobmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW10vLCAnXFxcXFsnKS5yZXBsYWNlKC9bXFxdXS8sICdcXFxcXScpXHJcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCdbXFxcXD8mXScgKyBuYW1lICsgJz0oW14mI10qKScpXHJcbiAgY29uc3QgcmVzdWx0cyA9IHJlZ2V4LmV4ZWMobG9jYXRpb24uc2VhcmNoKVxyXG5cclxuICByZXR1cm4gcmVzdWx0cyA9PT0gbnVsbCA/ICcnIDogZGVjb2RlVVJJQ29tcG9uZW50KHJlc3VsdHNbMV0ucmVwbGFjZSgvXFwrL2csICcgJykpXHJcbn0iLCJpbXBvcnQgJy4vc3R5bGVzLmNzcydcclxuaW1wb3J0ICcuL2NvbXBvbmVudHMvbGVnYWN5L21lc3VyZSdcclxuaW1wb3J0ICcuL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvcnNMaXN0J1xyXG5pbXBvcnQgTWVzdXJlQ3VzdG9tUGFnZSBmcm9tICcuL2NvbXBvbmVudHMvbWVzdXJlcy9NZXN1cmVDdXN0b21QYWdlLnN2ZWx0ZSdcclxuXHJcbmNvbnN0IG1lc3VyZUN1c3RvbSA9IG5ldyBNZXN1cmVDdXN0b21QYWdlKHtcclxuICAvLyBAdHMtaWdub3JlXHJcbiAgdGFyZ2V0OiBkb2N1bWVudC5ib2R5LFxyXG59KVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbWVzdXJlQ3VzdG9tXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=