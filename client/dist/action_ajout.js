(()=>{var e={586:(e,t,n)=>{var i=n(589),r=n(708),s=r;s.v1=i,s.v4=r,e.exports=s},726:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var i=n||0,r=t;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},338:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},589:(e,t,n)=>{var i,r,s=n(338),a=n(726),o=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==h){var f=s();null==d&&(d=i=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=r=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=p-o+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||p>o)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=p,c=m,r=h;var v=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;u[l++]=v>>>24&255,u[l++]=v>>>16&255,u[l++]=v>>>8&255,u[l++]=255&v;var $=p/4294967296*1e4&268435455;u[l++]=$>>>8&255,u[l++]=255&$,u[l++]=$>>>24&15|16,u[l++]=$>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var y=0;y<6;++y)u[l+y]=d[y];return t||a(u)}},708:(e,t,n)=>{var i=n(338),r=n(726);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var o=0;o<16;++o)t[s+o]=a[o];return t||r(a)}}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}(()=>{"use strict";const e=e=>null!=e.id&&null!=e.pathname;class t{constructor({epci_id:e,indicateur_id:t,year:n,value:i}){this.epci_id=e,this.indicateur_id=t,this.year=n,this.value=i}get pathname(){return t.pathname}}t.pathname="indicateur_value";class i extends t{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return i.buildId(this.epci_id,this.indicateur_id,this.year)}}class r{constructor({host:e,endpoint:t,serializer:n,deserializer:i}){this.host=e,this.pathname=t,this.serializer=n,this.deserializer=i}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await fetch(`${this.host}/${this.pathname}/`,{method:"POST",mode:"cors",body:JSON.stringify(this.serializer(t))});return this.deserializer(await n.json())}async retrieveAll(){return this.retrieveAtPath("all")}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"});return 404==t.status?null:this.deserializer(await t.json())}async retrieveAtPath(e){const t=await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"GET"}),n=await t.json(),i=[];for(let e=0;e<n.length;e++)i.push(this.deserializer(n[e]));return i}async deleteById(e){return 200==(await fetch(`${this.host}/${this.pathname}/${e}`,{mode:"cors",method:"DELETE"})).status}}const s=()=>{const e=new URLSearchParams(window.location.search).get("epci_id");if(!e)throw new Error("Parameter epci_id is empty.");return e};class a{constructor({action_id:e,epci_id:t,avancement:n}){this.action_id=e,this.epci_id=t,this.avancement=n}get pathname(){return a.pathname}}a.pathname="action_status";class o extends a{static buildId(e,t){return`${e}/${t}`}get id(){return o.buildId(this.epci_id,this.action_id)}}class c{constructor({uid:e,epci_id:t,mesure_id:n,name:i,description:r}){this.uid=e,this.epci_id=t,this.mesure_id=n,this.name=i,this.description=r}get pathname(){return c.pathname}}c.pathname="action_custom";class l extends c{static buildId(e,t,n){return`${e}/${t}/${n}`}get id(){return l.buildId(this.epci_id,this.mesure_id,this.uid)}}const u=()=>{const e=window.location.hostname;if("localhost"===e.substring(0,10))return"http://localhost:8000";if("sandbox.territoiresentransitions.fr"===e)return"https://sandboxterritoires.osc-fr1.scalingo.io";if("staging.territoiresentransitions.fr"===e)return"https://territoiresentransitions.osc-fr1.scalingo.io";throw`no API host for ${e}`};class d{constructor({uid:e,epci_id:t,climat_pratic_thematic_id:n,name:i}){this.uid=e,this.epci_id=t,this.climat_pratic_thematic_id=n,this.name=i}get pathname(){return d.pathname}}d.pathname="mesure_custom";class h extends d{static buildId(e,t){return`${e}/${t}`}get id(){return h.buildId(this.epci_id,this.uid)}}class f{constructor({host:e,endpoint:t,serializer:n,deserializer:i}){this.cache=null,this.retrieving=null,this.host=e,this.pathname=t,this.serializer=n,this.deserializer=i,this.api=new r({host:this.host,endpoint:this.pathname,serializer:this.serializer,deserializer:this.deserializer})}async store(t){if(!e(t))throw new Error(typeof t+" is not storable.");const n=await this.api.store(t);return this.writeInCache(n)}retrieveAll(){return this.getCache()}async retrieveById(e){return this.retrieveByPath(e)}async retrieveByPath(e){const t=await this.getCache();for(let n of t)if(n.id.startsWith(e))return n;return null}async retrieveAtPath(e){const t=await this.getCache(),n=[];for(let i of t)i.id.startsWith(e)&&n.push(i);return n}async deleteById(e){const t=await this.api.deleteById(this.stripId(e)),n=await this.getCache();return this.cache=n.filter((t=>t.id!==e)),t}stripId(e){const t=this.pathname.split("/");let n=e.split("/"),i=!1;for(let e=0;e<t.length;e++)if(t[e]==n[0])i=!0,n=n.slice(1);else if(i)break;return n.join("/")}async writeInCache(e){await this.removeFromCache(e.id);const t=await this.getCache();return t.push(e),this.cache=t,e}async removeFromCache(e){const t=await this.getCache(),n=t.filter((t=>t.id!==e)),i=n.length!=t.length;return this.cache=n,i}async getCache(){return null!==this.cache?this.cache:(null===this.retrieving&&(this.retrieving=this.api.retrieveAll(),this.retrieving.then((e=>{this.cache=e}))),this.retrieving)}}const p=new f({host:u(),endpoint:`v1/${t.pathname}/${s()}`,serializer:e=>e,deserializer:e=>new i(e)}),m=new f({host:u(),endpoint:`v1/${a.pathname}/${s()}`,serializer:e=>e,deserializer:e=>new o(e)}),g=new f({host:u(),endpoint:`v1/${c.pathname}/${s()}`,serializer:e=>e,deserializer:e=>new l(e)}),v=(new f({host:u(),endpoint:`v1/${d.pathname}/${s()}`,serializer:e=>e,deserializer:e=>new h(e)}),s());document.querySelectorAll(".status").forEach((e=>(e=>{let t=e.dataset.actionId||"",n=e.querySelectorAll('input[type="radio"]');((e,t)=>{let n=t=>{const n=t.target.value,i=new o({epci_id:v,action_id:e,avancement:n});m.store(i)};t.forEach((e=>{e.addEventListener("change",n)}))})(t,n),(async(e,t)=>{let n="pas_faite";try{const i=await m.retrieveById(`${v}/${e}`);i&&(n=i.avancement)}catch(e){}finally{const i=`action-${e}_${n}`;t.forEach((e=>{e.id===i&&(e.checked=!0)}))}})(t,n)})(e)));const $=e=>{e.preventDefault()},y=e=>{const t=e.target,{id:n,year:r}=_(t),a=s(),o=new i({epci_id:a,indicateur_id:n,year:r,value:t.value});p.store(o)},w=e=>{"Enter"===e.key&&e.target.blur()},b=async e=>{e.value="",e.addEventListener("blur",y),e.addEventListener("keypress",w)},_=e=>({id:e.dataset.indicatorId,year:+e.dataset.indicatorYear});function x(){}function E(e){return e()}function k(){return Object.create(null)}function z(e){e.forEach(E)}function C(e){return"function"==typeof e}function A(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function I(e){return 0===Object.keys(e).length}function P(e,t){e.appendChild(t)}function S(e,t,n){e.insertBefore(t,n||null)}function L(e){e.parentNode.removeChild(e)}function q(e){return document.createElement(e)}function B(e){return document.createTextNode(e)}function T(){return B(" ")}function N(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function j(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function V(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function O(e,t){e.value=null==t?"":t}function R(e,t,n){e.classList[n?"add":"remove"](t)}let M;function D(e){M=e}document.querySelectorAll('[data-component="indicatorForm"]').forEach((e=>{(async e=>{e.addEventListener("submit",$);const t=e.querySelectorAll("input");for(let e of t)b(e);const{id:n,year:i}=_(t[0]),r=s(),a=await p.retrieveAtPath(`${r}/${n}`);for(let e of t){const{id:t,year:n}=_(e);let i="";for(let e of a)e.year==n&&e.indicateur_id==t&&(i=e.value);e.value=i}})(e)})),new Set,new Set;const F=[],U=[],G=[],H=[],W=Promise.resolve();let J=!1;function Y(e){G.push(e)}let K=!1;const Q=new Set;function X(){if(!K){K=!0;do{for(let e=0;e<F.length;e+=1){const t=F[e];D(t),Z(t.$$)}for(D(null),F.length=0;U.length;)U.pop()();for(let e=0;e<G.length;e+=1){const t=G[e];Q.has(t)||(Q.add(t),t())}G.length=0}while(F.length);for(;H.length;)H.pop()();J=!1,K=!1,Q.clear()}}function Z(e){if(null!==e.fragment){e.update(),z(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Y)}}const ee=new Set;let te;function ne(e,t){e&&e.i&&(ee.delete(e),e.i(t))}function ie(e,t,n){const{fragment:i,on_mount:r,on_destroy:s,after_update:a}=e.$$;i&&i.m(t,n),Y((()=>{const t=r.map(E).filter(C);s?s.push(...t):z(t),e.$$.on_mount=[]})),a.forEach(Y)}function re(e,t){const n=e.$$;null!==n.fragment&&(z(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function se(e,t,n,i,r,s,a=[-1]){const o=M;D(e);const c=e.$$={fragment:null,ctx:null,props:s,update:x,not_equal:r,bound:k(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(o?o.$$.context:[]),callbacks:k(),dirty:a,skip_bound:!1};let l=!1;if(c.ctx=n?n(e,t.props||{},((t,n,...i)=>{const s=i.length?i[0]:n;return c.ctx&&r(c.ctx[t],c.ctx[t]=s)&&(!c.skip_bound&&c.bound[t]&&c.bound[t](s),l&&function(e,t){-1===e.$$.dirty[0]&&(F.push(e),J||(J=!0,W.then(X)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],c.update(),l=!0,z(c.before_update),c.fragment=!!i&&i(c.ctx),t.target){if(t.hydrate){const e=(u=t.target,Array.from(u.childNodes));c.fragment&&c.fragment.l(e),e.forEach(L)}else c.fragment&&c.fragment.c();t.intro&&ne(e.$$.fragment),ie(e,t.target,t.anchor),X()}var u;D(o)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(te=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){re(this,1),this.$destroy=x}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!I(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class ae{$destroy(){re(this,1),this.$destroy=x}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!I(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function oe(e){let t,n,i,r,s;return{c(){t=q("button"),n=B(e[0]),j(t,"class",i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),R(t,"w-full",e[1])},m(i,a){S(i,t,a),P(t,n),r||(s=N(t,"click",e[8]),r=!0)},p(e,r){1&r&&V(n,e[0]),36&r&&i!==(i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&j(t,"class",i),38&r&&R(t,"w-full",e[1])},d(e){e&&L(t),r=!1,s()}}}function ce(e){let t,n,i;return{c(){t=q("a"),n=B(e[0]),j(t,"href",e[4]),j(t,"class",i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:"")),R(t,"w-full",e[1])},m(e,i){S(e,t,i),P(t,n)},p(e,r){1&r&&V(n,e[0]),16&r&&j(t,"href",e[4]),36&r&&i!==(i="\r\n  \t"+e[5]+"\r\n  \t"+(e[2]?` ${e[2]}`:""))&&j(t,"class",i),38&r&&R(t,"w-full",e[1])},d(e){e&&L(t)}}}function le(e){let t;function n(e,t){return e[3]?ce:oe}let i=n(e),r=i(e);return{c(){r.c(),t=B("")},m(e,n){r.m(e,n),S(e,t,n)},p(e,[s]){i===(i=n(e))&&r?r.p(e,s):(r.d(1),r=i(e),r&&(r.c(),r.m(t.parentNode,t)))},i:x,o:x,d(e){r.d(e),e&&L(t)}}}function ue(e,t,n){var i,r;!function(e){e[e.nettle=0]="nettle",e[e.bramble=1]="bramble"}(i||(i={})),function(e){e[e.normal=0]="normal",e[e.small=1]="small"}(r||(r={}));let{label:s=""}=t,{full:a=!1}=t,{classNames:o=""}=t,{colorVariant:c="nettle"}=t,{size:l="normal"}=t,{asLink:u=!1}=t,{href:d=""}=t,h="";return"nettle"==c&&(h+=" border-green-700 border-2 hover:bg-green-100 active:bg-green-600"),"bramble"==c&&(h+=" border-gray-800 border hover:bg-green-100 active:bg-green-600"),"normal"==l&&(h+=" px-6 py-3"),"small"==l&&(h+=" text-base px-3 py-3"),e.$$set=e=>{"label"in e&&n(0,s=e.label),"full"in e&&n(1,a=e.full),"classNames"in e&&n(2,o=e.classNames),"colorVariant"in e&&n(6,c=e.colorVariant),"size"in e&&n(7,l=e.size),"asLink"in e&&n(3,u=e.asLink),"href"in e&&n(4,d=e.href)},[s,a,o,u,d,h,c,l,function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}(e,t)}]}const de=class extends ae{constructor(e){super(),se(this,e,ue,le,A,{label:0,full:1,classNames:2,colorVariant:6,size:7,asLink:3,href:4})}};var he=n(586);function fe(e){let t,n,i,r,s,a,o,c,l,u,d,h,f,p,m,g,v,$;return m=new de({props:{full:!0,label:"Valider",classNames:"md:w-1/3 self-end"}}),m.$on("click",e[2]),{c(){var e;t=q("section"),n=q("h1"),n.textContent="Ajouter une action",i=T(),r=q("div"),s=q("label"),s.textContent="Nom",a=T(),o=q("input"),c=T(),l=q("div"),u=T(),d=q("label"),d.textContent="Description",h=T(),f=q("textarea"),p=T(),(e=m.$$.fragment)&&e.c(),j(n,"class","text-4xl font-semibold pb-20"),j(s,"for","mesure_create_name"),j(o,"id","mesure_create_name"),j(o,"class","border border-gray-300 p-2 my-2 focus:outline-none focus:ring-2 ring-green-100"),j(l,"class","p-5"),j(d,"for","mesure_create_description"),j(f,"id","mesure_create_description"),j(f,"class","border border-gray-300 p-2 my-2 focus:outline-none focus:ring-2 ring-green-100"),j(r,"class","flex flex-col w-full md:w-3/4 pb-10"),j(t,"class","flex flex-col")},m(y,w){S(y,t,w),P(t,n),P(t,i),P(t,r),P(r,s),P(r,a),P(r,o),O(o,e[0]),P(r,c),P(r,l),P(r,u),P(r,d),P(r,h),P(r,f),O(f,e[1]),P(t,p),ie(m,t,null),g=!0,v||($=[N(o,"input",e[3]),N(f,"input",e[4])],v=!0)},p(e,[t]){1&t&&o.value!==e[0]&&O(o,e[0]),2&t&&O(f,e[1])},i(e){g||(ne(m.$$.fragment,e),g=!0)},o(e){(function(e,t,n,i){if(e&&e.o){if(ee.has(e))return;ee.add(e),(void 0).c.push((()=>{ee.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}})(m.$$.fragment,e),g=!1},d(e){e&&L(t),re(m),v=!1,z($)}}}function pe(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}c((i=i.apply(e,t||[])).next())}))};const r=s(),a=(e=>{e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))})("mesure_uid");let o="",c="";return[o,c,()=>i(void 0,void 0,void 0,(function*(){const e=new l({epci_id:r,mesure_id:a,uid:(0,he.v4)(),name:o,description:c});yield g.store(e),window.location.href=`/mesure_personnalisee.html?epci_id=${r}&mesure_uid=${a}`})),function(){o=this.value,n(0,o)},function(){c=this.value,n(1,c)}]}class me{constructor(e,t){this.id=e,this.name=t}}new me("strategie","Stratégie"),new me("urbanisme","Urbanisme et aménagement"),new me("batiments","Bâtiments et patrimoine"),new me("energie","Gestion, production et distribution de l'énergie"),new me("mobilites","Mobilités"),new me("agri_alim","Agriculture et alimentation"),new me("foret_biodiv","Forêts, espaces verts et biodiversité"),new me("conso_resp","Consommation écoresponsable"),new me("dechets","Déchets"),new me("eau","Eau et assainissement"),new me("preca_energie","Précarité énergétique"),new me("dev_eco","Activités économiques"),new me("tourisme","Tourisme"),new me("orga_interne","Organisation interne"),new me("forma_sensib","Formation, sensibilisation, communication"),new me("parten_coop","Partenariat et coopération"),new me("eci","Économie circulaire"),new class extends ae{constructor(e){super(),se(this,e,pe,fe,A,{})}}({target:document.body.querySelector('[data-page="action_create"]')})})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9ub2RlX21vZHVsZXMvdXVpZC9pbmRleC5qcyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9ub2RlX21vZHVsZXMvdXVpZC9saWIvYnl0ZXNUb1V1aWQuanMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vbm9kZV9tb2R1bGVzL3V1aWQvbGliL3JuZy1icm93c2VyLmpzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL25vZGVfbW9kdWxlcy91dWlkL3YxLmpzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL25vZGVfbW9kdWxlcy91dWlkL3Y0LmpzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL3N0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3ZlbmRvcnMvaW5kaWNhdGV1cl92YWx1ZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvc3RvcmFibGVzL0luZGljYXRldXJWYWx1ZVN0b3JhYmxlLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9hcGkvYXBpU3RvcmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9jdXJyZW50RXBjaS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXMudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL2FjdGlvbl9jdXN0b20udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3N0b3JhYmxlcy9BY3Rpb25DdXN0b21TdG9yYWJsZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvYXBpL2N1cnJlbnRBUEkudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2FwaS9oeWJyaWRTdG9yZS50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi9zcmMvY29tcG9uZW50cy9sZWdhY3kvc3RhdHVzUGlja2VyLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL2xlZ2FjeS9tZXN1cmUudHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvckZvcm0udHMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL2NvbXBvbmVudHMvbGVnYWN5L2luZGljYXRvcnNMaXN0LnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL3NoYXJlZC9CdXR0b24uc3ZlbHRlIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9jb21wb25lbnRzL2FjdGlvbnMvQWN0aW9uQ3JlYXRlUGFnZS5zdmVsdGUiLCJ3ZWJwYWNrOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyLy4vc3JjL3V0aWxzL3VybC50cyIsIndlYnBhY2s6Ly90ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnIvLi92ZW5kb3JzL3RoZW1hdGlxdWVzLnRzIiwid2VicGFjazovL3RlcnJpdG9pcmVzZW50cmFuc2l0aW9ucy5mci8uL3NyYy9hY3Rpb25fYWpvdXQudHMiXSwibmFtZXMiOlsidjEiLCJ2NCIsInV1aWQiLCJtb2R1bGUiLCJleHBvcnRzIiwiYnl0ZVRvSGV4IiwiaSIsInRvU3RyaW5nIiwic3Vic3RyIiwiYnVmIiwib2Zmc2V0IiwiYnRoIiwiam9pbiIsImdldFJhbmRvbVZhbHVlcyIsImNyeXB0byIsImJpbmQiLCJ3aW5kb3ciLCJtc0NyeXB0byIsInJuZHM4IiwiVWludDhBcnJheSIsInJuZHMiLCJBcnJheSIsInIiLCJNYXRoIiwicmFuZG9tIiwiX25vZGVJZCIsIl9jbG9ja3NlcSIsInJuZyIsImJ5dGVzVG9VdWlkIiwiX2xhc3RNU2VjcyIsIl9sYXN0TlNlY3MiLCJvcHRpb25zIiwiYiIsIm5vZGUiLCJjbG9ja3NlcSIsInVuZGVmaW5lZCIsInNlZWRCeXRlcyIsIm1zZWNzIiwiRGF0ZSIsImdldFRpbWUiLCJuc2VjcyIsImR0IiwiRXJyb3IiLCJ0bCIsInRtaCIsIm4iLCJpaSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsIl9fd2VicGFja19tb2R1bGVzX18iLCJpc1N0b3JhYmxlIiwic3RvcmFibGUiLCJpZCIsInBhdGhuYW1lIiwiSW5kaWNhdGV1clZhbHVlIiwiZXBjaV9pZCIsImluZGljYXRldXJfaWQiLCJ5ZWFyIiwidmFsdWUiLCJ0aGlzIiwiSW5kaWNhdGV1clZhbHVlU3RvcmFibGUiLCJidWlsZElkIiwiQVBJU3RvcmUiLCJob3N0IiwiZW5kcG9pbnQiLCJzZXJpYWxpemVyIiwiZGVzZXJpYWxpemVyIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsIm1vZGUiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImpzb24iLCJyZXRyaWV2ZUF0UGF0aCIsInJldHJpZXZlQnlQYXRoIiwicGF0aCIsInN0YXR1cyIsImRhdGEiLCJyZXN1bHRzIiwibGVuZ3RoIiwicHVzaCIsImdldEN1cnJlbnRFcGNpSWQiLCJVUkxTZWFyY2hQYXJhbXMiLCJsb2NhdGlvbiIsInNlYXJjaCIsImdldCIsIkFjdGlvblN0YXR1cyIsImFjdGlvbl9pZCIsImF2YW5jZW1lbnQiLCJBY3Rpb25TdGF0dXNTdG9yYWJsZSIsIkFjdGlvbkN1c3RvbSIsInVpZCIsIm1lc3VyZV9pZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsIkFjdGlvbkN1c3RvbVN0b3JhYmxlIiwiZ2V0Q3VycmVudEFQSSIsImhvc3RuYW1lIiwic3Vic3RyaW5nIiwiTWVzdXJlQ3VzdG9tIiwiY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZCIsIk1lc3VyZUN1c3RvbVN0b3JhYmxlIiwiSHlicmlkU3RvcmUiLCJjYWNoZSIsInJldHJpZXZpbmciLCJhcGkiLCJzdG9yZWQiLCJzdG9yZSIsIndyaXRlSW5DYWNoZSIsImdldENhY2hlIiwic3RhcnRzV2l0aCIsImRlbGV0ZWQiLCJkZWxldGVCeUlkIiwic3RyaXBJZCIsImZpbHRlciIsImNhY2hlZCIsInNwbGl0IiwibWF0Y2giLCJzbGljZSIsInJlbW92ZUZyb21DYWNoZSIsImZpbHRlcmVkIiwicmV0cmlldmVBbGwiLCJ0aGVuIiwicmV0cmlldmVkIiwiaW5kaWNhdGV1clZhbHVlU3RvcmUiLCJzZXJpYWxpemVkIiwiYWN0aW9uU3RhdHVzU3RvcmUiLCJhY3Rpb25DdXN0b21TdG9yZSIsImVjcGlJZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbGVtZW50IiwiYWN0aW9uSWQiLCJkYXRhc2V0IiwiaW5wdXRzIiwib25DaGFuZ2UiLCJldmVudCIsImFjdGlvbkF2YW5jZW1lbnRLZXkiLCJ0YXJnZXQiLCJpbnB1dCIsImFkZEV2ZW50TGlzdGVuZXIiLCJhZGRMaXN0ZW5lcnMiLCJhc3luYyIsInJldHJpZXZlQnlJZCIsImUiLCJzZWxlY3RlZElucHV0SWQiLCJjaGVja2VkIiwiY2hlY2tJbnB1dCIsImluaXQiLCJwcmV2ZW50RGVmYXVsdCIsIm9uQmx1ciIsImlucHV0UHJvcGVydGllcyIsImN1cnJlbnRFcGNpSWQiLCJvbktleVByZXNzIiwia2V5IiwiYmx1ciIsImluaXRZZWFybHlJbnB1dCIsImluZGljYXRvcklkIiwiaW5kaWNhdG9yWWVhciIsIm5vb3AiLCJydW4iLCJmbiIsImJsYW5rX29iamVjdCIsIk9iamVjdCIsImNyZWF0ZSIsInJ1bl9hbGwiLCJmbnMiLCJpc19mdW5jdGlvbiIsInRoaW5nIiwic2FmZV9ub3RfZXF1YWwiLCJhIiwiaXNfZW1wdHkiLCJvYmoiLCJrZXlzIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJpbnNlcnQiLCJhbmNob3IiLCJpbnNlcnRCZWZvcmUiLCJkZXRhY2giLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJjcmVhdGVFbGVtZW50IiwiY3JlYXRlVGV4dE5vZGUiLCJzcGFjZSIsImxpc3RlbiIsImhhbmRsZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYXR0ciIsImF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImdldEF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInNldF9kYXRhIiwidGV4dCIsIndob2xlVGV4dCIsInNldF9pbnB1dF92YWx1ZSIsInRvZ2dsZV9jbGFzcyIsInRvZ2dsZSIsImNsYXNzTGlzdCIsImN1cnJlbnRfY29tcG9uZW50Iiwic2V0X2N1cnJlbnRfY29tcG9uZW50IiwiY29tcG9uZW50IiwiZm9ybSIsImVwY2lJZCIsImluZGljYXRldXJWYWx1ZXMiLCJpbmRpY2F0ZXVyVmFsdWUiLCJTZXQiLCJkaXJ0eV9jb21wb25lbnRzIiwiYmluZGluZ19jYWxsYmFja3MiLCJyZW5kZXJfY2FsbGJhY2tzIiwiZmx1c2hfY2FsbGJhY2tzIiwicmVzb2x2ZWRfcHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwidXBkYXRlX3NjaGVkdWxlZCIsImFkZF9yZW5kZXJfY2FsbGJhY2siLCJmbHVzaGluZyIsInNlZW5fY2FsbGJhY2tzIiwiZmx1c2giLCJ1cGRhdGUiLCIkJCIsInBvcCIsImNhbGxiYWNrIiwiaGFzIiwiYWRkIiwiY2xlYXIiLCJmcmFnbWVudCIsImJlZm9yZV91cGRhdGUiLCJkaXJ0eSIsInAiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsIlN2ZWx0ZUVsZW1lbnQiLCJ0cmFuc2l0aW9uX2luIiwiYmxvY2siLCJsb2NhbCIsImRlbGV0ZSIsIm1vdW50X2NvbXBvbmVudCIsIm9uX21vdW50Iiwib25fZGVzdHJveSIsIm0iLCJuZXdfb25fZGVzdHJveSIsIm1hcCIsImRlc3Ryb3lfY29tcG9uZW50IiwiZGV0YWNoaW5nIiwiZCIsImluc3RhbmNlIiwiY3JlYXRlX2ZyYWdtZW50Iiwibm90X2VxdWFsIiwicHJvcHMiLCJwYXJlbnRfY29tcG9uZW50IiwiYm91bmQiLCJjb250ZXh0IiwiTWFwIiwiY2FsbGJhY2tzIiwic2tpcF9ib3VuZCIsInJlYWR5IiwicmV0IiwicmVzdCIsImZpbGwiLCJtYWtlX2RpcnR5IiwiaHlkcmF0ZSIsIm5vZGVzIiwiZnJvbSIsImNoaWxkTm9kZXMiLCJsIiwiYyIsImludHJvIiwiZ2xvYmFsVGhpcyIsImdsb2JhbCIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJhdHRhY2hTaGFkb3ciLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkJHByb3BzIiwiJCRzZXQiLCJTdmVsdGVDb21wb25lbnQiLCJjb2xvclZhcmlhbnRzIiwic2l6ZXMiLCJsYWJlbCIsImZ1bGwiLCJjbGFzc05hbWVzIiwiY29sb3JWYXJpYW50Iiwic2l6ZSIsImFzTGluayIsImhyZWYiLCJidXR0b25DbGFzc05hbWVzIiwibyIsIm91dHJvcyIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwiYXBwbHkiLCJtZXN1cmVVaWQiLCJyZXBsYWNlIiwiUmVnRXhwIiwiZXhlYyIsImRlY29kZVVSSUNvbXBvbmVudCIsImdldFVybFBhcmFtZXRlciIsImFjdGlvbiIsIlRoZW1hdGlxdWUiLCJxdWVyeVNlbGVjdG9yIl0sIm1hcHBpbmdzIjoiMkJBQUEsSUFBSUEsRUFBSyxFQUFRLEtBQ2JDLEVBQUssRUFBUSxLQUViQyxFQUFPRCxFQUNYQyxFQUFLRixHQUFLQSxFQUNWRSxFQUFLRCxHQUFLQSxFQUVWRSxFQUFPQyxRQUFVRixHLFFDRmpCLElBREEsSUFBSUcsRUFBWSxHQUNQQyxFQUFJLEVBQUdBLEVBQUksTUFBT0EsRUFDekJELEVBQVVDLElBQU1BLEVBQUksS0FBT0MsU0FBUyxJQUFJQyxPQUFPLEdBbUJqREwsRUFBT0MsUUFoQlAsU0FBcUJLLEVBQUtDLEdBQ3hCLElBQUlKLEVBQUlJLEdBQVUsRUFDZEMsRUFBTU4sRUFFVixNQUFPLENBQ0xNLEVBQUlGLEVBQUlILE1BQU9LLEVBQUlGLEVBQUlILE1BQ3ZCSyxFQUFJRixFQUFJSCxNQUFPSyxFQUFJRixFQUFJSCxNQUFPLElBQzlCSyxFQUFJRixFQUFJSCxNQUFPSyxFQUFJRixFQUFJSCxNQUFPLElBQzlCSyxFQUFJRixFQUFJSCxNQUFPSyxFQUFJRixFQUFJSCxNQUFPLElBQzlCSyxFQUFJRixFQUFJSCxNQUFPSyxFQUFJRixFQUFJSCxNQUFPLElBQzlCSyxFQUFJRixFQUFJSCxNQUFPSyxFQUFJRixFQUFJSCxNQUN2QkssRUFBSUYsRUFBSUgs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ciB2NCA9IHJlcXVpcmUoJy4vdjQnKTtcblxudmFyIHV1aWQgPSB2NDtcbnV1aWQudjEgPSB2MTtcbnV1aWQudjQgPSB2NDtcblxubW9kdWxlLmV4cG9ydHMgPSB1dWlkO1xuIiwiLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG52YXIgYnl0ZVRvSGV4ID0gW107XG5mb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleFtpXSA9IChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zdWJzdHIoMSk7XG59XG5cbmZ1bmN0aW9uIGJ5dGVzVG9VdWlkKGJ1Ziwgb2Zmc2V0KSB7XG4gIHZhciBpID0gb2Zmc2V0IHx8IDA7XG4gIHZhciBidGggPSBieXRlVG9IZXg7XG4gIC8vIGpvaW4gdXNlZCB0byBmaXggbWVtb3J5IGlzc3VlIGNhdXNlZCBieSBjb25jYXRlbmF0aW9uOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvdjgvaXNzdWVzL2RldGFpbD9pZD0zMTc1I2M0XG4gIHJldHVybiAoW1xuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dXG4gIF0pLmpvaW4oJycpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJ5dGVzVG9VdWlkO1xuIiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gIEluIHRoZVxuLy8gYnJvd3NlciB0aGlzIGlzIGEgbGl0dGxlIGNvbXBsaWNhdGVkIGR1ZSB0byB1bmtub3duIHF1YWxpdHkgb2YgTWF0aC5yYW5kb20oKVxuLy8gYW5kIGluY29uc2lzdGVudCBzdXBwb3J0IGZvciB0aGUgYGNyeXB0b2AgQVBJLiAgV2UgZG8gdGhlIGJlc3Qgd2UgY2FuIHZpYVxuLy8gZmVhdHVyZS1kZXRlY3Rpb25cblxuLy8gZ2V0UmFuZG9tVmFsdWVzIG5lZWRzIHRvIGJlIGludm9rZWQgaW4gYSBjb250ZXh0IHdoZXJlIFwidGhpc1wiIGlzIGEgQ3J5cHRvXG4vLyBpbXBsZW1lbnRhdGlvbi4gQWxzbywgZmluZCB0aGUgY29tcGxldGUgaW1wbGVtZW50YXRpb24gb2YgY3J5cHRvIG9uIElFMTEuXG52YXIgZ2V0UmFuZG9tVmFsdWVzID0gKHR5cGVvZihjcnlwdG8pICE9ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZihtc0NyeXB0bykgIT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5tc0NyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT0gJ2Z1bmN0aW9uJyAmJiBtc0NyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChtc0NyeXB0bykpO1xuXG5pZiAoZ2V0UmFuZG9tVmFsdWVzKSB7XG4gIC8vIFdIQVRXRyBjcnlwdG8gUk5HIC0gaHR0cDovL3dpa2kud2hhdHdnLm9yZy93aWtpL0NyeXB0b1xuICB2YXIgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcblxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHdoYXR3Z1JORygpIHtcbiAgICBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xuICAgIHJldHVybiBybmRzODtcbiAgfTtcbn0gZWxzZSB7XG4gIC8vIE1hdGgucmFuZG9tKCktYmFzZWQgKFJORylcbiAgLy9cbiAgLy8gSWYgYWxsIGVsc2UgZmFpbHMsIHVzZSBNYXRoLnJhbmRvbSgpLiAgSXQncyBmYXN0LCBidXQgaXMgb2YgdW5zcGVjaWZpZWRcbiAgLy8gcXVhbGl0eS5cbiAgdmFyIHJuZHMgPSBuZXcgQXJyYXkoMTYpO1xuXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbWF0aFJORygpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgcjsgaSA8IDE2OyBpKyspIHtcbiAgICAgIGlmICgoaSAmIDB4MDMpID09PSAwKSByID0gTWF0aC5yYW5kb20oKSAqIDB4MTAwMDAwMDAwO1xuICAgICAgcm5kc1tpXSA9IHIgPj4+ICgoaSAmIDB4MDMpIDw8IDMpICYgMHhmZjtcbiAgICB9XG5cbiAgICByZXR1cm4gcm5kcztcbiAgfTtcbn1cbiIsInZhciBybmcgPSByZXF1aXJlKCcuL2xpYi9ybmcnKTtcbnZhciBieXRlc1RvVXVpZCA9IHJlcXVpcmUoJy4vbGliL2J5dGVzVG9VdWlkJyk7XG5cbi8vICoqYHYxKClgIC0gR2VuZXJhdGUgdGltZS1iYXNlZCBVVUlEKipcbi8vXG4vLyBJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vTGlvc0svVVVJRC5qc1xuLy8gYW5kIGh0dHA6Ly9kb2NzLnB5dGhvbi5vcmcvbGlicmFyeS91dWlkLmh0bWxcblxudmFyIF9ub2RlSWQ7XG52YXIgX2Nsb2Nrc2VxO1xuXG4vLyBQcmV2aW91cyB1dWlkIGNyZWF0aW9uIHRpbWVcbnZhciBfbGFzdE1TZWNzID0gMDtcbnZhciBfbGFzdE5TZWNzID0gMDtcblxuLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCBmb3IgQVBJIGRldGFpbHNcbmZ1bmN0aW9uIHYxKG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIHZhciBpID0gYnVmICYmIG9mZnNldCB8fCAwO1xuICB2YXIgYiA9IGJ1ZiB8fCBbXTtcblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdmFyIG5vZGUgPSBvcHRpb25zLm5vZGUgfHwgX25vZGVJZDtcbiAgdmFyIGNsb2Nrc2VxID0gb3B0aW9ucy5jbG9ja3NlcSAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5jbG9ja3NlcSA6IF9jbG9ja3NlcTtcblxuICAvLyBub2RlIGFuZCBjbG9ja3NlcSBuZWVkIHRvIGJlIGluaXRpYWxpemVkIHRvIHJhbmRvbSB2YWx1ZXMgaWYgdGhleSdyZSBub3RcbiAgLy8gc3BlY2lmaWVkLiAgV2UgZG8gdGhpcyBsYXppbHkgdG8gbWluaW1pemUgaXNzdWVzIHJlbGF0ZWQgdG8gaW5zdWZmaWNpZW50XG4gIC8vIHN5c3RlbSBlbnRyb3B5LiAgU2VlICMxODlcbiAgaWYgKG5vZGUgPT0gbnVsbCB8fCBjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgdmFyIHNlZWRCeXRlcyA9IHJuZygpO1xuICAgIGlmIChub2RlID09IG51bGwpIHtcbiAgICAgIC8vIFBlciA0LjUsIGNyZWF0ZSBhbmQgNDgtYml0IG5vZGUgaWQsICg0NyByYW5kb20gYml0cyArIG11bHRpY2FzdCBiaXQgPSAxKVxuICAgICAgbm9kZSA9IF9ub2RlSWQgPSBbXG4gICAgICAgIHNlZWRCeXRlc1swXSB8IDB4MDEsXG4gICAgICAgIHNlZWRCeXRlc1sxXSwgc2VlZEJ5dGVzWzJdLCBzZWVkQnl0ZXNbM10sIHNlZWRCeXRlc1s0XSwgc2VlZEJ5dGVzWzVdXG4gICAgICBdO1xuICAgIH1cbiAgICBpZiAoY2xvY2tzZXEgPT0gbnVsbCkge1xuICAgICAgLy8gUGVyIDQuMi4yLCByYW5kb21pemUgKDE0IGJpdCkgY2xvY2tzZXFcbiAgICAgIGNsb2Nrc2VxID0gX2Nsb2Nrc2VxID0gKHNlZWRCeXRlc1s2XSA8PCA4IHwgc2VlZEJ5dGVzWzddKSAmIDB4M2ZmZjtcbiAgICB9XG4gIH1cblxuICAvLyBVVUlEIHRpbWVzdGFtcHMgYXJlIDEwMCBuYW5vLXNlY29uZCB1bml0cyBzaW5jZSB0aGUgR3JlZ29yaWFuIGVwb2NoLFxuICAvLyAoMTU4Mi0xMC0xNSAwMDowMCkuICBKU051bWJlcnMgYXJlbid0IHByZWNpc2UgZW5vdWdoIGZvciB0aGlzLCBzb1xuICAvLyB0aW1lIGlzIGhhbmRsZWQgaW50ZXJuYWxseSBhcyAnbXNlY3MnIChpbnRlZ2VyIG1pbGxpc2Vjb25kcykgYW5kICduc2VjcydcbiAgLy8gKDEwMC1uYW5vc2Vjb25kcyBvZmZzZXQgZnJvbSBtc2Vjcykgc2luY2UgdW5peCBlcG9jaCwgMTk3MC0wMS0wMSAwMDowMC5cbiAgdmFyIG1zZWNzID0gb3B0aW9ucy5tc2VjcyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5tc2VjcyA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gIC8vIFBlciA0LjIuMS4yLCB1c2UgY291bnQgb2YgdXVpZCdzIGdlbmVyYXRlZCBkdXJpbmcgdGhlIGN1cnJlbnQgY2xvY2tcbiAgLy8gY3ljbGUgdG8gc2ltdWxhdGUgaGlnaGVyIHJlc29sdXRpb24gY2xvY2tcbiAgdmFyIG5zZWNzID0gb3B0aW9ucy5uc2VjcyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5uc2VjcyA6IF9sYXN0TlNlY3MgKyAxO1xuXG4gIC8vIFRpbWUgc2luY2UgbGFzdCB1dWlkIGNyZWF0aW9uIChpbiBtc2VjcylcbiAgdmFyIGR0ID0gKG1zZWNzIC0gX2xhc3RNU2VjcykgKyAobnNlY3MgLSBfbGFzdE5TZWNzKS8xMDAwMDtcblxuICAvLyBQZXIgNC4yLjEuMiwgQnVtcCBjbG9ja3NlcSBvbiBjbG9jayByZWdyZXNzaW9uXG4gIGlmIChkdCA8IDAgJiYgb3B0aW9ucy5jbG9ja3NlcSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY2xvY2tzZXEgPSBjbG9ja3NlcSArIDEgJiAweDNmZmY7XG4gIH1cblxuICAvLyBSZXNldCBuc2VjcyBpZiBjbG9jayByZWdyZXNzZXMgKG5ldyBjbG9ja3NlcSkgb3Igd2UndmUgbW92ZWQgb250byBhIG5ld1xuICAvLyB0aW1lIGludGVydmFsXG4gIGlmICgoZHQgPCAwIHx8IG1zZWNzID4gX2xhc3RNU2VjcykgJiYgb3B0aW9ucy5uc2VjcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbnNlY3MgPSAwO1xuICB9XG5cbiAgLy8gUGVyIDQuMi4xLjIgVGhyb3cgZXJyb3IgaWYgdG9vIG1hbnkgdXVpZHMgYXJlIHJlcXVlc3RlZFxuICBpZiAobnNlY3MgPj0gMTAwMDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3V1aWQudjEoKTogQ2FuXFwndCBjcmVhdGUgbW9yZSB0aGFuIDEwTSB1dWlkcy9zZWMnKTtcbiAgfVxuXG4gIF9sYXN0TVNlY3MgPSBtc2VjcztcbiAgX2xhc3ROU2VjcyA9IG5zZWNzO1xuICBfY2xvY2tzZXEgPSBjbG9ja3NlcTtcblxuICAvLyBQZXIgNC4xLjQgLSBDb252ZXJ0IGZyb20gdW5peCBlcG9jaCB0byBHcmVnb3JpYW4gZXBvY2hcbiAgbXNlY3MgKz0gMTIyMTkyOTI4MDAwMDA7XG5cbiAgLy8gYHRpbWVfbG93YFxuICB2YXIgdGwgPSAoKG1zZWNzICYgMHhmZmZmZmZmKSAqIDEwMDAwICsgbnNlY3MpICUgMHgxMDAwMDAwMDA7XG4gIGJbaSsrXSA9IHRsID4+PiAyNCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRsID4+PiAxNiAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRsID4+PiA4ICYgMHhmZjtcbiAgYltpKytdID0gdGwgJiAweGZmO1xuXG4gIC8vIGB0aW1lX21pZGBcbiAgdmFyIHRtaCA9IChtc2VjcyAvIDB4MTAwMDAwMDAwICogMTAwMDApICYgMHhmZmZmZmZmO1xuICBiW2krK10gPSB0bWggPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bWggJiAweGZmO1xuXG4gIC8vIGB0aW1lX2hpZ2hfYW5kX3ZlcnNpb25gXG4gIGJbaSsrXSA9IHRtaCA+Pj4gMjQgJiAweGYgfCAweDEwOyAvLyBpbmNsdWRlIHZlcnNpb25cbiAgYltpKytdID0gdG1oID4+PiAxNiAmIDB4ZmY7XG5cbiAgLy8gYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgIChQZXIgNC4yLjIgLSBpbmNsdWRlIHZhcmlhbnQpXG4gIGJbaSsrXSA9IGNsb2Nrc2VxID4+PiA4IHwgMHg4MDtcblxuICAvLyBgY2xvY2tfc2VxX2xvd2BcbiAgYltpKytdID0gY2xvY2tzZXEgJiAweGZmO1xuXG4gIC8vIGBub2RlYFxuICBmb3IgKHZhciBuID0gMDsgbiA8IDY7ICsrbikge1xuICAgIGJbaSArIG5dID0gbm9kZVtuXTtcbiAgfVxuXG4gIHJldHVybiBidWYgPyBidWYgOiBieXRlc1RvVXVpZChiKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2MTtcbiIsInZhciBybmcgPSByZXF1aXJlKCcuL2xpYi9ybmcnKTtcbnZhciBieXRlc1RvVXVpZCA9IHJlcXVpcmUoJy4vbGliL2J5dGVzVG9VdWlkJyk7XG5cbmZ1bmN0aW9uIHY0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIHZhciBpID0gYnVmICYmIG9mZnNldCB8fCAwO1xuXG4gIGlmICh0eXBlb2Yob3B0aW9ucykgPT0gJ3N0cmluZycpIHtcbiAgICBidWYgPSBvcHRpb25zID09PSAnYmluYXJ5JyA/IG5ldyBBcnJheSgxNikgOiBudWxsO1xuICAgIG9wdGlvbnMgPSBudWxsO1xuICB9XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gIHZhciBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTtcblxuICAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG4gIHJuZHNbNl0gPSAocm5kc1s2XSAmIDB4MGYpIHwgMHg0MDtcbiAgcm5kc1s4XSA9IChybmRzWzhdICYgMHgzZikgfCAweDgwO1xuXG4gIC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuICBpZiAoYnVmKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwOyBpaSA8IDE2OyArK2lpKSB7XG4gICAgICBidWZbaSArIGlpXSA9IHJuZHNbaWldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBidWYgfHwgYnl0ZXNUb1V1aWQocm5kcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdjQ7XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8qKlxyXG4gKiBEYXRhIHRoYXQgY2FuIGJlIHN0b3JlZCBhdCBwYXRoL2lkLlxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBTdG9yYWJsZSB7XHJcbiAgICBpZDogc3RyaW5nLFxyXG4gICAgcGF0aG5hbWU6IHN0cmluZyxcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0b3JhYmxlIHR5cGUgZ3VhcmQuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgaXNTdG9yYWJsZSA9IChzdG9yYWJsZTogYW55KTogc3RvcmFibGUgaXMgU3RvcmFibGUgPT4ge1xyXG4gICAgcmV0dXJuIChzdG9yYWJsZSBhcyBTdG9yYWJsZSkuaWQgIT0gdW5kZWZpbmVkICYmIChzdG9yYWJsZSBhcyBTdG9yYWJsZSkucGF0aG5hbWUgIT0gdW5kZWZpbmVkXHJcbn1cclxuIiwiZXhwb3J0IGludGVyZmFjZSBJbmRpY2F0ZXVyVmFsdWVJbnRlcmZhY2Uge1xyXG4gICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIGluZGljYXRldXJfaWQ6IHN0cmluZyxcclxuICAgICAgICB5ZWFyOiBudW1iZXIsXHJcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEluZGljYXRldXJWYWx1ZSB7XHJcbiAgICBwdWJsaWMgc3RhdGljIHBhdGhuYW1lOiBzdHJpbmcgPSAnaW5kaWNhdGV1cl92YWx1ZSc7XHJcbiAgICBnZXQgcGF0aG5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gSW5kaWNhdGV1clZhbHVlLnBhdGhuYW1lO1xyXG4gICAgfVxyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgaW5kaWNhdGV1cl9pZDogc3RyaW5nO1xyXG4gICAgeWVhcjogbnVtYmVyO1xyXG4gICAgdmFsdWU6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBJbmRpY2F0ZXVyVmFsdWUgaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIGluZGljYXRldXJfaWQsXHJcbiAgICAgICAgeWVhcixcclxuICAgICAgICB2YWx1ZSxcclxuICAgIH06IHtcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZDogc3RyaW5nLFxyXG4gICAgICAgIHllYXI6IG51bWJlcixcclxuICAgICAgICB2YWx1ZTogc3RyaW5nLFxyXG4gICAgfSkge1xyXG4gICAgICAgIHRoaXMuZXBjaV9pZCA9IGVwY2lfaWQ7XHJcbiAgICAgICAgdGhpcy5pbmRpY2F0ZXVyX2lkID0gaW5kaWNhdGV1cl9pZDtcclxuICAgICAgICB0aGlzLnllYXIgPSB5ZWFyO1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7SW5kaWNhdGV1clZhbHVlfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9pbmRpY2F0ZXVyX3ZhbHVlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSW5kaWNhdGV1clZhbHVlU3RvcmFibGUgZXh0ZW5kcyBJbmRpY2F0ZXVyVmFsdWUge1xyXG4gICAgc3RhdGljIGJ1aWxkSWQoZXBjaV9pZDogc3RyaW5nLCBpbmRpY2F0ZXVyX2lkOiBzdHJpbmcsIHllYXI6IG51bWJlcikgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHtlcGNpX2lkfS8ke2luZGljYXRldXJfaWR9LyR7eWVhcn1gXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEluZGljYXRldXJWYWx1ZVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLmluZGljYXRldXJfaWQsIHRoaXMueWVhcilcclxuICAgIH1cclxufSIsImltcG9ydCB7aXNTdG9yYWJsZX0gZnJvbSBcIi4vc3RvcmFibGVcIjtcclxuXHJcbi8qKlxyXG4gKiBBIFN0b3JlIGZvciBTdG9yYWJsZSBvYmplY3QgdXNpbmcgYSByZW1vdGUgYXBpXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQVBJU3RvcmU8VD4ge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBob3N0LFxyXG4gICAgICAgICAgICBlbmRwb2ludCxcclxuICAgICAgICAgICAgc2VyaWFsaXplcixcclxuICAgICAgICAgICAgZGVzZXJpYWxpemVyLFxyXG4gICAgICAgIH06IHtcclxuICAgICAgICAgICAgaG9zdDogc3RyaW5nLFxyXG4gICAgICAgICAgICBlbmRwb2ludDogc3RyaW5nLFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyOiAoc3RvcmFibGU6IFQpID0+IG9iamVjdCxcclxuICAgICAgICAgICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZDogb2JqZWN0KSA9PiBULFxyXG4gICAgICAgIH0pIHtcclxuICAgICAgICB0aGlzLmhvc3QgPSBob3N0O1xyXG4gICAgICAgIHRoaXMucGF0aG5hbWUgPSBlbmRwb2ludDtcclxuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyO1xyXG4gICAgICAgIHRoaXMuZGVzZXJpYWxpemVyID0gZGVzZXJpYWxpemVyO1xyXG4gICAgfVxyXG5cclxuICAgIGhvc3Q6IHN0cmluZztcclxuICAgIHBhdGhuYW1lOiBzdHJpbmc7XHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGU6IFQpID0+IG9iamVjdDtcclxuICAgIGRlc2VyaWFsaXplcjogKHNlcmlhbGl6ZWQ6IG9iamVjdCkgPT4gVDtcclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9yZSBhIFN0b3JhYmxlIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzdG9yYWJsZSB0aGUgb2JqZWN0IHRvIHNhdmVcclxuICAgICAqL1xyXG4gICAgYXN5bmMgc3RvcmUoc3RvcmFibGU6IFQpOiBQcm9taXNlPFQ+IHtcclxuICAgICAgICBpZiAoIWlzU3RvcmFibGUoc3RvcmFibGUpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJHt0eXBlb2Ygc3RvcmFibGV9IGlzIG5vdCBzdG9yYWJsZS5gKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmhvc3R9LyR7dGhpcy5wYXRobmFtZX0vYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh0aGlzLnNlcmlhbGl6ZXIoc3RvcmFibGUpKVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5kZXNlcmlhbGl6ZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhbGwgc3RvcmFibGUgb2YgdHlwZSBUIGV4aXN0aW5nIGF0IHBhdGhuYW1lLlxyXG4gICAgICogSWYgbm90aGluZyBpcyBmb3VuZCByZXR1cm5zIGFuIGVtcHR5IHJlY29yZC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVBbGwoKTogUHJvbWlzZTxBcnJheTxUPj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJldHJpZXZlQXRQYXRoKCdhbGwnKVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGEgc3RvcmFibGUgd2l0aCBtYXRjaGluZyBwYXRoIGFuZCBwYXRoLlxyXG4gICAgICogVGhyb3cgaWYgbm8gc3RvcmFibGUgaXMgZm91bmQgb3IgcGF0aCBkb2VzIG5vdCBleGlzdC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgU3RvcmFibGUgaWRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmVCeVBhdGgoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJldHJpZXZlQnlQYXRoKHBhdGg6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuaG9zdH0vJHt0aGlzLnBhdGhuYW1lfS8ke3BhdGh9YCwge1xyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gNDA0KSByZXR1cm4gbnVsbDtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZXNlcmlhbGl6ZXIoYXdhaXQgcmVzcG9uc2UuanNvbigpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyByZXRyaWV2ZUF0UGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmhvc3R9LyR7dGhpcy5wYXRobmFtZX0vJHtwYXRofWAsIHtcclxuICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxyXG4gICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0aGlzLmRlc2VyaWFsaXplcihkYXRhW2ldKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIERlbGV0ZSBhIFN0b3JhYmxlIHN0b3JlZCBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqIFJldHVybiB0cnVlIGlmIHNvbWV0aGluZyB3YXMgZGVsZXRlZCwgZmFsc2UgaWYgbm90aGluZyBleGlzdHMgYXQgcGF0aG5hbWUvaWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkIFN0b3JhYmxlIGlkXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGRlbGV0ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5ob3N0fS8ke3RoaXMucGF0aG5hbWV9LyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtb2RlOiAnY29ycycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMgPT0gMjAwO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjb25zdCBnZXRDdXJyZW50RXBjaUlkID0gKCk6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpXHJcbiAgICBjb25zdCBpZCA9IHVybFBhcmFtcy5nZXQoJ2VwY2lfaWQnKVxyXG5cclxuICAgIGlmICghaWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BhcmFtZXRlciBlcGNpX2lkIGlzIGVtcHR5LicpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGlkXHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIEFjdGlvblN0YXR1c0ludGVyZmFjZSB7XHJcbiAgICBhY3Rpb25faWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgYXZhbmNlbWVudDogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aW9uU3RhdHVzIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcGF0aG5hbWU6IHN0cmluZyA9ICdhY3Rpb25fc3RhdHVzJztcclxuICAgIGdldCBwYXRobmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBBY3Rpb25TdGF0dXMucGF0aG5hbWU7XHJcbiAgICB9XHJcbiAgICBhY3Rpb25faWQ6IHN0cmluZztcclxuICAgIGVwY2lfaWQ6IHN0cmluZztcclxuICAgIGF2YW5jZW1lbnQ6IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBBY3Rpb25TdGF0dXMgaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICBhY3Rpb25faWQsXHJcbiAgICAgICAgZXBjaV9pZCxcclxuICAgICAgICBhdmFuY2VtZW50LFxyXG4gICAgfToge1xyXG4gICAgICAgIGFjdGlvbl9pZDogc3RyaW5nLFxyXG4gICAgICAgIGVwY2lfaWQ6IHN0cmluZyxcclxuICAgICAgICBhdmFuY2VtZW50OiBzdHJpbmcsXHJcbiAgICB9KSB7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25faWQgPSBhY3Rpb25faWQ7XHJcbiAgICAgICAgdGhpcy5lcGNpX2lkID0gZXBjaV9pZDtcclxuICAgICAgICB0aGlzLmF2YW5jZW1lbnQgPSBhdmFuY2VtZW50O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtBY3Rpb25TdGF0dXN9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25TdGF0dXNTdG9yYWJsZSBleHRlbmRzIEFjdGlvblN0YXR1cyB7XHJcbiAgICBzdGF0aWMgYnVpbGRJZChlcGNpX2lkOiBzdHJpbmcsIGFjdGlvbl9pZDogc3RyaW5nKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7YWN0aW9uX2lkfWA7XHJcbiAgICB9XHJcbiAgICBnZXQgaWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQWN0aW9uU3RhdHVzU3RvcmFibGUuYnVpbGRJZCh0aGlzLmVwY2lfaWQsIHRoaXMuYWN0aW9uX2lkKVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBBY3Rpb25DdXN0b21JbnRlcmZhY2Uge1xyXG4gICAgdWlkOiBzdHJpbmcsXHJcbiAgICAgICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIG1lc3VyZV9pZDogc3RyaW5nLFxyXG4gICAgICAgIG5hbWU6IHN0cmluZyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWN0aW9uQ3VzdG9tIHtcclxuICAgIHB1YmxpYyBzdGF0aWMgcGF0aG5hbWU6IHN0cmluZyA9ICdhY3Rpb25fY3VzdG9tJztcclxuICAgIGdldCBwYXRobmFtZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBBY3Rpb25DdXN0b20ucGF0aG5hbWU7XHJcbiAgICB9XHJcbiAgICB1aWQ6IHN0cmluZztcclxuICAgIGVwY2lfaWQ6IHN0cmluZztcclxuICAgIG1lc3VyZV9pZDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBBY3Rpb25DdXN0b20gaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHtcclxuICAgICAgICB1aWQsXHJcbiAgICAgICAgZXBjaV9pZCxcclxuICAgICAgICBtZXN1cmVfaWQsXHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgIH06IHtcclxuICAgICAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbWVzdXJlX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgbmFtZTogc3RyaW5nLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgICB9KSB7XHJcbiAgICAgICAgdGhpcy51aWQgPSB1aWQ7XHJcbiAgICAgICAgdGhpcy5lcGNpX2lkID0gZXBjaV9pZDtcclxuICAgICAgICB0aGlzLm1lc3VyZV9pZCA9IG1lc3VyZV9pZDtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcclxuICAgIH1cclxufSIsImltcG9ydCB7QWN0aW9uQ3VzdG9tfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9hY3Rpb25fY3VzdG9tXCI7XHJcblxyXG5leHBvcnQgIGNsYXNzIEFjdGlvbkN1c3RvbVN0b3JhYmxlIGV4dGVuZHMgQWN0aW9uQ3VzdG9tIHtcclxuICAgIHN0YXRpYyBidWlsZElkKGVwY2lfaWQ6IHN0cmluZywgbWVzdXJlX2lkOiBzdHJpbmcsIHVpZDogc3RyaW5nKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGAke2VwY2lfaWR9LyR7bWVzdXJlX2lkfS8ke3VpZH1gXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEFjdGlvbkN1c3RvbVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLm1lc3VyZV9pZCwgdGhpcy51aWQpXHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY29uc3QgZ2V0Q3VycmVudEFQSSA9ICgpOiBzdHJpbmcgPT4ge1xyXG4gICAgY29uc3QgaG9zdG5hbWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWU7XHJcbiAgICBpZiAoaG9zdG5hbWUuc3Vic3RyaW5nKDAsIDEwKSA9PT0gJ2xvY2FsaG9zdCcpIHJldHVybiAnaHR0cDovL2xvY2FsaG9zdDo4MDAwJztcclxuICAgIGlmIChob3N0bmFtZSA9PT0gJ3NhbmRib3gudGVycml0b2lyZXNlbnRyYW5zaXRpb25zLmZyJykgcmV0dXJuICdodHRwczovL3NhbmRib3h0ZXJyaXRvaXJlcy5vc2MtZnIxLnNjYWxpbmdvLmlvJ1xyXG4gICAgaWYgKGhvc3RuYW1lID09PSAnc3RhZ2luZy50ZXJyaXRvaXJlc2VudHJhbnNpdGlvbnMuZnInKSByZXR1cm4gJ2h0dHBzOi8vdGVycml0b2lyZXNlbnRyYW5zaXRpb25zLm9zYy1mcjEuc2NhbGluZ28uaW8nXHJcbiAgICB0aHJvdyBgbm8gQVBJIGhvc3QgZm9yICR7aG9zdG5hbWV9YFxyXG59IiwiZXhwb3J0IGludGVyZmFjZSBNZXN1cmVDdXN0b21JbnRlcmZhY2Uge1xyXG4gICAgdWlkOiBzdHJpbmcsXHJcbiAgICAgICAgZXBjaV9pZDogc3RyaW5nLFxyXG4gICAgICAgIGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQ6IHN0cmluZyxcclxuICAgICAgICBuYW1lOiBzdHJpbmcsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNZXN1cmVDdXN0b20ge1xyXG4gICAgcHVibGljIHN0YXRpYyBwYXRobmFtZTogc3RyaW5nID0gJ21lc3VyZV9jdXN0b20nO1xyXG4gICAgZ2V0IHBhdGhuYW1lKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIE1lc3VyZUN1c3RvbS5wYXRobmFtZTtcclxuICAgIH1cclxuICAgIHVpZDogc3RyaW5nO1xyXG4gICAgZXBjaV9pZDogc3RyaW5nO1xyXG4gICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIE1lc3VyZUN1c3RvbSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3Ioe1xyXG4gICAgICAgIHVpZCxcclxuICAgICAgICBlcGNpX2lkLFxyXG4gICAgICAgIGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQsXHJcbiAgICAgICAgbmFtZSxcclxuICAgIH06IHtcclxuICAgICAgICB1aWQ6IHN0cmluZyxcclxuICAgICAgICBlcGNpX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZDogc3RyaW5nLFxyXG4gICAgICAgIG5hbWU6IHN0cmluZyxcclxuICAgIH0pIHtcclxuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcclxuICAgICAgICB0aGlzLmVwY2lfaWQgPSBlcGNpX2lkO1xyXG4gICAgICAgIHRoaXMuY2xpbWF0X3ByYXRpY190aGVtYXRpY19pZCA9IGNsaW1hdF9wcmF0aWNfdGhlbWF0aWNfaWQ7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7TWVzdXJlQ3VzdG9tfSBmcm9tIFwiLi4vLi4vdmVuZG9ycy9tZXN1cmVfY3VzdG9tXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWVzdXJlQ3VzdG9tU3RvcmFibGUgZXh0ZW5kcyBNZXN1cmVDdXN0b20ge1xyXG4gICAgc3RhdGljIGJ1aWxkSWQoZXBjaV9pZDogc3RyaW5nLCB1aWQ6IHN0cmluZykgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBgJHtlcGNpX2lkfS8ke3VpZH1gO1xyXG4gICAgfVxyXG4gICAgZ2V0IGlkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIE1lc3VyZUN1c3RvbVN0b3JhYmxlLmJ1aWxkSWQodGhpcy5lcGNpX2lkLCB0aGlzLnVpZClcclxuICAgIH1cclxufSIsImltcG9ydCB7aXNTdG9yYWJsZSwgU3RvcmFibGV9IGZyb20gXCIuL3N0b3JhYmxlXCI7XHJcbmltcG9ydCB7SW5kaWNhdGV1clZhbHVlU3RvcmFibGV9IGZyb20gXCIuLi9zdG9yYWJsZXMvSW5kaWNhdGV1clZhbHVlU3RvcmFibGVcIjtcclxuaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWUsIEluZGljYXRldXJWYWx1ZUludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvaW5kaWNhdGV1cl92YWx1ZVwiO1xyXG5pbXBvcnQge0FQSVN0b3JlfSBmcm9tIFwiLi9hcGlTdG9yZVwiO1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuL2N1cnJlbnRFcGNpXCI7XHJcbmltcG9ydCB7QWN0aW9uU3RhdHVzLCBBY3Rpb25TdGF0dXNJbnRlcmZhY2V9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9zdGF0dXNcIjtcclxuaW1wb3J0IHtBY3Rpb25TdGF0dXNTdG9yYWJsZX0gZnJvbSBcIi4uL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZVwiO1xyXG5pbXBvcnQge0FjdGlvbkN1c3RvbVN0b3JhYmxlfSBmcm9tIFwiLi4vc3RvcmFibGVzL0FjdGlvbkN1c3RvbVN0b3JhYmxlXCI7XHJcbmltcG9ydCB7QWN0aW9uQ3VzdG9tLCBBY3Rpb25DdXN0b21JbnRlcmZhY2V9IGZyb20gXCIuLi8uLi92ZW5kb3JzL2FjdGlvbl9jdXN0b21cIjtcclxuaW1wb3J0IHtnZXRDdXJyZW50QVBJfSBmcm9tIFwiLi9jdXJyZW50QVBJXCI7XHJcbmltcG9ydCB7TWVzdXJlQ3VzdG9tU3RvcmFibGV9IGZyb20gXCIuLi9zdG9yYWJsZXMvTWVzdXJlQ3VzdG9tU3RvcmFibGVcIjtcclxuaW1wb3J0IHtNZXN1cmVDdXN0b20sIE1lc3VyZUN1c3RvbUludGVyZmFjZX0gZnJvbSBcIi4uLy4uL3ZlbmRvcnMvbWVzdXJlX2N1c3RvbVwiO1xyXG5cclxuLyoqXHJcbiAqIEEgU3RvcmUgZm9yIFN0b3JhYmxlIG9iamVjdCB1c2luZyBhIHJlbW90ZSBhcGkgYW5kIGEgbG9jYWwgY2FjaGUuXHJcbiAqXHJcbiAqIFRoZSBsb2NhbCBjYWNoZSBpcyBrZXB0IGluIG1lbW9yeSBmb3Igbm93LlxyXG4gKi9cclxuY2xhc3MgSHlicmlkU3RvcmU8VCBleHRlbmRzIFN0b3JhYmxlPiB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGhvc3QsXHJcbiAgICAgICAgICAgIGVuZHBvaW50LFxyXG4gICAgICAgICAgICBzZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXIsXHJcbiAgICAgICAgfToge1xyXG4gICAgICAgICAgICBob3N0OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIGVuZHBvaW50OiBzdHJpbmcsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6ZXI6IChzdG9yYWJsZTogVCkgPT4gb2JqZWN0LFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkOiBvYmplY3QpID0+IFQsXHJcbiAgICAgICAgfSkge1xyXG4gICAgICAgIHRoaXMuaG9zdCA9IGhvc3Q7XHJcbiAgICAgICAgdGhpcy5wYXRobmFtZSA9IGVuZHBvaW50O1xyXG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHNlcmlhbGl6ZXI7XHJcbiAgICAgICAgdGhpcy5kZXNlcmlhbGl6ZXIgPSBkZXNlcmlhbGl6ZXI7XHJcblxyXG4gICAgICAgIHRoaXMuYXBpID0gbmV3IEFQSVN0b3JlPFQ+KHtcclxuICAgICAgICAgICAgaG9zdDogdGhpcy5ob3N0LFxyXG4gICAgICAgICAgICBlbmRwb2ludDogdGhpcy5wYXRobmFtZSxcclxuICAgICAgICAgICAgc2VyaWFsaXplcjogdGhpcy5zZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IHRoaXMuZGVzZXJpYWxpemVyXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgdG9kbyB1c2UgbG9jYWwgc3RvcmUgZm9yIGNhY2hpbmdcclxuICAgICAgICB0aGlzLmxvY2FsID0gbmV3IExvY2FsU3RvcmU8VD4oe1xyXG4gICAgICAgICAgICBwYXRobmFtZTogdGhpcy5wYXRobmFtZSxcclxuICAgICAgICAgICAgc2VyaWFsaXplcjogdGhpcy5zZXJpYWxpemVyLFxyXG4gICAgICAgICAgICBkZXNlcmlhbGl6ZXI6IHRoaXMuZGVzZXJpYWxpemVyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgKi9cclxuICAgIH1cclxuXHJcbiAgICBob3N0OiBzdHJpbmc7XHJcbiAgICBwYXRobmFtZTogc3RyaW5nO1xyXG4gICAgc2VyaWFsaXplcjogKHN0b3JhYmxlOiBUKSA9PiBvYmplY3Q7XHJcbiAgICBkZXNlcmlhbGl6ZXI6IChzZXJpYWxpemVkOiBvYmplY3QpID0+IFQ7XHJcbiAgICBhcGk6IEFQSVN0b3JlPFQ+O1xyXG4gICAgcHJpdmF0ZSBjYWNoZTogVFtdIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgLy8gbG9jYWw6IExvY2FsU3RvcmU8VD47XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RvcmUgYSBTdG9yYWJsZSBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc3RvcmFibGUgdGhlIG9iamVjdCB0byBzYXZlXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHN0b3JlKHN0b3JhYmxlOiBUKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgaWYgKCFpc1N0b3JhYmxlKHN0b3JhYmxlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dHlwZW9mIHN0b3JhYmxlfSBpcyBub3Qgc3RvcmFibGUuYClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHN0b3JlZCA9IGF3YWl0IHRoaXMuYXBpLnN0b3JlKHN0b3JhYmxlKTtcclxuICAgICAgICByZXR1cm4gdGhpcy53cml0ZUluQ2FjaGUoc3RvcmVkKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYWxsIHN0b3JhYmxlIG9mIHR5cGUgVCBleGlzdGluZyBhdCBwYXRobmFtZS5cclxuICAgICAqIElmIG5vdGhpbmcgaXMgZm91bmQgcmV0dXJucyBhbiBlbXB0eSByZWNvcmQuXHJcbiAgICAgKi9cclxuICAgIHJldHJpZXZlQWxsKCk6IFByb21pc2U8QXJyYXk8VD4+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBhIHN0b3JhYmxlIHdpdGggbWF0Y2hpbmcgaWQuXHJcbiAgICAgKiBUaHJvdyBpZiBubyBzdG9yYWJsZSBpcyBmb3VuZCBvciBwYXRoIGRvZXMgbm90IGV4aXN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZCBTdG9yYWJsZSBpZFxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXRyaWV2ZUJ5UGF0aChpZCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYSBzdG9yYWJsZSB3aXRoIG1hdGNoaW5nIHBhdGguXHJcbiAgICAgKiBUaHJvdyBpZiBubyBzdG9yYWJsZSBpcyBmb3VuZCBvciBwYXRoIGRvZXMgbm90IGV4aXN0LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwYXRoIFN0b3JhYmxlIHBhdGhcclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmV0cmlldmVCeVBhdGgocGF0aDogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGZvciAobGV0IHN0b3JhYmxlIG9mIGNhY2hlKSB7XHJcbiAgICAgICAgICAgIGlmIChzdG9yYWJsZS5pZC5zdGFydHNXaXRoKHBhdGgpKSByZXR1cm4gc3RvcmFibGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGFsbCBzdG9yYWJsZSBvZiB0eXBlIFQgZXhpc3RpbmcgYXQgcGF0aCB1bmRlciBwYXRobmFtZS5cclxuICAgICAqIElmIG5vdGhpbmcgaXMgZm91bmQgcmV0dXJucyBhbiBlbXB0eSBsaXN0LlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZXRyaWV2ZUF0UGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBzdG9yYWJsZSBvZiBjYWNoZSkge1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFibGUuaWQuc3RhcnRzV2l0aChwYXRoKSkgcmVzdWx0cy5wdXNoKHN0b3JhYmxlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVsZXRlIGEgU3RvcmFibGUgc3RvcmVkIGF0IHBhdGhuYW1lL2lkLlxyXG4gICAgICogUmV0dXJuIHRydWUgaWYgc29tZXRoaW5nIHdhcyBkZWxldGVkLCBmYWxzZSBpZiBub3RoaW5nIGV4aXN0cyBhdCBwYXRobmFtZS9pZC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWQgU3RvcmFibGUgaWRcclxuICAgICAqL1xyXG4gICAgYXN5bmMgZGVsZXRlQnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgY29uc3QgZGVsZXRlZCA9IGF3YWl0IHRoaXMuYXBpLmRlbGV0ZUJ5SWQodGhpcy5zdHJpcElkKGlkKSk7XHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSBhd2FpdCB0aGlzLmdldENhY2hlKCk7XHJcbiAgICAgICAgdGhpcy5jYWNoZSA9IGNhY2hlLmZpbHRlcihjYWNoZWQgPT4gY2FjaGVkLmlkICE9PSBpZCk7XHJcbiAgICAgICAgcmV0dXJuIGRlbGV0ZWQ7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RyaXAgaWQgcmVtb3ZlcyByZWR1bmRhbnQgcGFydHMgc2hhcmVkIGJ5IHRoZSBpZCBhbmQgdGhlIGVuZHBvaW50LlxyXG4gICAgICpcclxuICAgICAqIEV4OiBpZiB0aGUgZW5kcG9pbnQgcGF0aCBpcyBgdjEvZW5kcG9pbnQvZXBjaV9pZC9gXHJcbiAgICAgKiBhbmQgdGhlIGlkIGlzIGBlcGNpX2lkL3BhcnRfYS9wYXJ0X2JgXHJcbiAgICAgKiB0aGUgcmVzdWx0aW5nIHN0cmlwcGVkIGlkIHdvdWxkIGJlIGBwYXJ0X2EvcGFydF9iYCxcclxuICAgICAqIGEgcGF0aCByZW1vdmVkIGZyb20gdGhlIHJlZHVuZGFudCBwYXJ0IGBlcGNpX2lkYFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIHN0cmlwSWQoaWQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLnBhdGhuYW1lLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgbGV0IHBhdGggPSBpZC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCBtYXRjaCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVuZHBvaW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBwYXJ0ID0gZW5kcG9pbnRbaV07XHJcbiAgICAgICAgICAgIGlmIChwYXJ0ID09IHBhdGhbMF0pIHtcclxuICAgICAgICAgICAgICAgIG1hdGNoID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBhdGguam9pbignLycpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgd3JpdGVJbkNhY2hlKHN0b3JhYmxlOiBUKTogUHJvbWlzZTxUPiB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5yZW1vdmVGcm9tQ2FjaGUoc3RvcmFibGUuaWQpO1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGNhY2hlLnB1c2goc3RvcmFibGUpO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWNoZTtcclxuICAgICAgICByZXR1cm4gc3RvcmFibGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyByZW1vdmVGcm9tQ2FjaGUoaWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gYXdhaXQgdGhpcy5nZXRDYWNoZSgpO1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkID0gY2FjaGUuZmlsdGVyKGNhY2hlZCA9PiBjYWNoZWQuaWQgIT09IGlkKTtcclxuICAgICAgICBjb25zdCBkZWxldGVkID0gZmlsdGVyZWQubGVuZ3RoICE9IGNhY2hlLmxlbmd0aDtcclxuICAgICAgICB0aGlzLmNhY2hlID0gZmlsdGVyZWQ7XHJcbiAgICAgICAgcmV0dXJuIGRlbGV0ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRDYWNoZSgpOiBQcm9taXNlPEFycmF5PFQ+PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FjaGUgIT09IG51bGwpIHJldHVybiB0aGlzLmNhY2hlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yZXRyaWV2aW5nID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmV0cmlldmluZyA9IHRoaXMuYXBpLnJldHJpZXZlQWxsKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJldHJpZXZpbmcudGhlbigocmV0cmlldmVkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlID0gcmV0cmlldmVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmV0cmlldmluZztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJldHJpZXZpbmc6IFByb21pc2U8QXJyYXk8VD4+IHwgbnVsbCA9IG51bGw7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgaW5kaWNhdGV1clZhbHVlU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8SW5kaWNhdGV1clZhbHVlU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtJbmRpY2F0ZXVyVmFsdWUucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEluZGljYXRldXJWYWx1ZVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgSW5kaWNhdGV1clZhbHVlSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgYWN0aW9uU3RhdHVzU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8QWN0aW9uU3RhdHVzU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtBY3Rpb25TdGF0dXMucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEFjdGlvblN0YXR1c1N0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgQWN0aW9uU3RhdHVzSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgYWN0aW9uQ3VzdG9tU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8QWN0aW9uQ3VzdG9tU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtBY3Rpb25DdXN0b20ucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IEFjdGlvbkN1c3RvbVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgQWN0aW9uQ3VzdG9tSW50ZXJmYWNlKSxcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgbWVzdXJlQ3VzdG9tU3RvcmUgPSBuZXcgSHlicmlkU3RvcmU8TWVzdXJlQ3VzdG9tU3RvcmFibGU+KHtcclxuICAgIGhvc3Q6IGdldEN1cnJlbnRBUEkoKSxcclxuICAgIGVuZHBvaW50OiBgdjEvJHtNZXN1cmVDdXN0b20ucGF0aG5hbWV9LyR7Z2V0Q3VycmVudEVwY2lJZCgpfWAsXHJcbiAgICBzZXJpYWxpemVyOiAoc3RvcmFibGUpID0+IHN0b3JhYmxlLFxyXG4gICAgZGVzZXJpYWxpemVyOiAoc2VyaWFsaXplZCkgPT4gbmV3IE1lc3VyZUN1c3RvbVN0b3JhYmxlKHNlcmlhbGl6ZWQgYXMgTWVzdXJlQ3VzdG9tSW50ZXJmYWNlKSxcclxufSk7IiwiaW1wb3J0IHthY3Rpb25TdGF0dXNTdG9yZX0gZnJvbSBcIi4uLy4uL2FwaS9oeWJyaWRTdG9yZVwiO1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuaW1wb3J0IHtBY3Rpb25TdGF0dXNTdG9yYWJsZX0gZnJvbSBcIi4uLy4uL3N0b3JhYmxlcy9BY3Rpb25TdGF0dXNTdG9yYWJsZVwiO1xyXG5cclxuY29uc3QgZWNwaUlkID0gZ2V0Q3VycmVudEVwY2lJZCgpXHJcblxyXG5jb25zdCBhZGRMaXN0ZW5lcnMgPSAoYWN0aW9uSWQ6IHN0cmluZywgaW5wdXRzOiBOb2RlTGlzdE9mPEhUTUxJbnB1dEVsZW1lbnQ+KTogdm9pZCA9PiB7XHJcbiAgICBsZXQgb25DaGFuZ2UgPSAoZXZlbnQ6IEV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuICAgICAgICBjb25zdCBhY3Rpb25BdmFuY2VtZW50S2V5ID0gdGFyZ2V0LnZhbHVlXHJcbiAgICAgICAgY29uc3QgYXZhbmNlbWVudCA9IG5ldyBBY3Rpb25TdGF0dXNTdG9yYWJsZSh7XHJcbiAgICAgICAgICAgIGVwY2lfaWQ6IGVjcGlJZCxcclxuICAgICAgICAgICAgYWN0aW9uX2lkOiBhY3Rpb25JZCxcclxuICAgICAgICAgICAgYXZhbmNlbWVudDogYWN0aW9uQXZhbmNlbWVudEtleVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGFjdGlvblN0YXR1c1N0b3JlLnN0b3JlKGF2YW5jZW1lbnQpXHJcbiAgICB9XHJcblxyXG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KTogdm9pZCA9PiB7XHJcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25DaGFuZ2UpXHJcbiAgICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgdGhlIHZhbHVlIG9mIHRoZSBzdGF0dXMgcGlja2VyIHdpdGggYSBkZWZhdWx0IHZhbHVlIG9yIHRoZSB2YWx1ZSByZXRyaWV2ZWQgZnJvbSBzdG9yZS5cclxuICovXHJcbmNvbnN0IGNoZWNrSW5wdXQgPSBhc3luYyAoYWN0aW9uSWQ6IHN0cmluZywgaW5wdXRzOiBOb2RlTGlzdE9mPEhUTUxJbnB1dEVsZW1lbnQ+KTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcbiAgICBsZXQgYWN0aW9uQXZhbmNlbWVudEtleSA9ICdwYXNfZmFpdGUnO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBhY3Rpb25TdGF0dXNTdG9yZS5yZXRyaWV2ZUJ5SWQoYCR7ZWNwaUlkfS8ke2FjdGlvbklkfWApXHJcbiAgICAgICAgaWYgKHN0YXR1cykgYWN0aW9uQXZhbmNlbWVudEtleSA9IHN0YXR1cy5hdmFuY2VtZW50O1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIC8vICBzaG91bGQgZG8gc29tZXRoaW5nIG1lYW5pbmdmdWwuXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSW5wdXRJZCA9IGBhY3Rpb24tJHthY3Rpb25JZH1fJHthY3Rpb25BdmFuY2VtZW50S2V5fWBcclxuICAgICAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgaWYgKGlucHV0LmlkID09PSBzZWxlY3RlZElucHV0SWQpIGlucHV0LmNoZWNrZWQgPSB0cnVlXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIHRoZSBzdGF0dXMgcGlja2VyIG9mIGFuIGFjdGlvbiB3aXRoIGFsbCBpdHMgZXZlbnQgbGlzdGVuZXJzXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgaW5pdCA9IChlbGVtZW50OiBIVE1MRmllbGRTZXRFbGVtZW50KTogdm9pZCA9PiB7XHJcbiAgICBsZXQgYWN0aW9uSWQgPSBlbGVtZW50LmRhdGFzZXQuYWN0aW9uSWQgfHwgJydcclxuICAgIGxldCBpbnB1dHMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTElucHV0RWxlbWVudD4oJ2lucHV0W3R5cGU9XCJyYWRpb1wiXScpXHJcblxyXG4gICAgYWRkTGlzdGVuZXJzKGFjdGlvbklkLCBpbnB1dHMpXHJcbiAgICBjaGVja0lucHV0KGFjdGlvbklkLCBpbnB1dHMpXHJcbn0iLCJpbXBvcnQgeyBpbml0IH0gZnJvbSAnLi9zdGF0dXNQaWNrZXInXHJcblxyXG5sZXQgc3RhdHVzUGlja2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTEZpZWxkU2V0RWxlbWVudD4oJy5zdGF0dXMnKVxyXG5cclxuc3RhdHVzUGlja2Vycy5mb3JFYWNoKChlbGVtZW50KTogdm9pZCA9PiBpbml0KGVsZW1lbnQpKVxyXG5cclxuXHJcbiIsImltcG9ydCB7aW5kaWNhdGV1clZhbHVlU3RvcmV9IGZyb20gXCIuLi8uLi9hcGkvaHlicmlkU3RvcmVcIjtcclxuaW1wb3J0IHtJbmRpY2F0ZXVyVmFsdWVTdG9yYWJsZX0gZnJvbSAnLi4vLi4vc3RvcmFibGVzL0luZGljYXRldXJWYWx1ZVN0b3JhYmxlJ1xyXG5pbXBvcnQge2dldEN1cnJlbnRFcGNpSWR9IGZyb20gXCIuLi8uLi9hcGkvY3VycmVudEVwY2lcIjtcclxuXHJcbi8qKlxyXG4gKiBQcmV2ZW50IGRlZmF1bHQgZm9ybSBiZWhhdmlvci5cclxuICovXHJcbmNvbnN0IHByZXZlbnREZWZhdWx0ID0gKGV2ZW50OiBFdmVudCk6IHZvaWQgPT4ge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG59XHJcblxyXG4vKipcclxuICogU2F2ZSB2YWx1ZSBmb3IgYSBzaW5nbGUgeWVhcmx5IGlucHV0IG9uIGJsdXIuXHJcbiAqL1xyXG5jb25zdCBvbkJsdXIgPSAoZXZlbnQ6IEZvY3VzRXZlbnQpOiB2b2lkID0+IHtcclxuICAgIGNvbnN0IGlucHV0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBjb25zdCB7aWQsIHllYXJ9ID0gaW5wdXRQcm9wZXJ0aWVzKGlucHV0KVxyXG4gICAgY29uc3QgY3VycmVudEVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKVxyXG4gICAgY29uc3QgdmFsdWUgPSBuZXcgSW5kaWNhdGV1clZhbHVlU3RvcmFibGUoe1xyXG4gICAgICAgIGVwY2lfaWQ6IGN1cnJlbnRFcGNpSWQsXHJcbiAgICAgICAgaW5kaWNhdGV1cl9pZDogaWQsXHJcbiAgICAgICAgeWVhcjogeWVhcixcclxuICAgICAgICB2YWx1ZTogaW5wdXQudmFsdWVcclxuICAgIH0pXHJcblxyXG4gICAgaW5kaWNhdGV1clZhbHVlU3RvcmUuc3RvcmUodmFsdWUpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDYWxsIGJsdXIgb24gZW50ZXIuXHJcbiAqL1xyXG5jb25zdCBvbktleVByZXNzID0gKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogdm9pZCA9PiB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIGlucHV0LmJsdXIoKVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBhIHNpbmdsZSB5ZWFybHkgaW5wdXQgd2l0aCBhIHJldHJpZXZlZCB2YWx1ZSBvciBhbiBlbXB0eSB2YWx1ZSBpZiBub25lIGZvdW5kLlxyXG4gKi9cclxuY29uc3QgaW5pdFllYXJseUlucHV0ID0gYXN5bmMgKGlucHV0OiBIVE1MSW5wdXRFbGVtZW50KTogUHJvbWlzZTx2b2lkPiA9PiB7XHJcblxyXG4gICAgaW5wdXQudmFsdWUgPSAgJydcclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvbkJsdXIpXHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIG9uS2V5UHJlc3MpXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHRyYWN0IGluZGljYXRldXIgaWQgYW5kIHllYXIgZnJvbSBpbnB1dC5cclxuICovXHJcbmNvbnN0IGlucHV0UHJvcGVydGllcyA9IChpbnB1dDogSFRNTElucHV0RWxlbWVudCk6IHsgaWQ6IHN0cmluZywgeWVhcjogbnVtYmVyIH0gPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogaW5wdXQuZGF0YXNldC5pbmRpY2F0b3JJZCEsXHJcbiAgICAgICAgeWVhcjogK2lucHV0LmRhdGFzZXQuaW5kaWNhdG9yWWVhciEsXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGVhY2ggeWVhcmx5IGlucHV0IGxpbmtlZCB0byBhbiBpbmRpY2F0b3Igd2l0aCBhbGwgaXRzIGV2ZW50IGxpc3RlbmVycy5cclxuICovXHJcbmV4cG9ydCBjb25zdCBpbml0ID0gYXN5bmMgIChmb3JtOiBIVE1MRm9ybUVsZW1lbnQpOiBQcm9taXNlPHZvaWQ+ID0+IHtcclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgcHJldmVudERlZmF1bHQpXHJcbiAgICBjb25zdCBpbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JylcclxuICAgIGZvciAobGV0IGlucHV0IG9mIGlucHV0cykge1xyXG4gICAgICAgIGluaXRZZWFybHlJbnB1dChpbnB1dClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7aWQsIHllYXJ9ID0gaW5wdXRQcm9wZXJ0aWVzKGlucHV0c1swXSlcclxuICAgIGNvbnN0IGVwY2lJZCA9IGdldEN1cnJlbnRFcGNpSWQoKVxyXG5cclxuICAgIGNvbnN0IGluZGljYXRldXJWYWx1ZXMgPSBhd2FpdCBpbmRpY2F0ZXVyVmFsdWVTdG9yZS5yZXRyaWV2ZUF0UGF0aChcclxuICAgICAgICBgJHtlcGNpSWR9LyR7aWR9YFxyXG4gICAgKVxyXG5cclxuICAgIGZvciAobGV0IGlucHV0IG9mIGlucHV0cykge1xyXG4gICAgICAgIGNvbnN0IHtpZCwgeWVhcn0gPSBpbnB1dFByb3BlcnRpZXMoaW5wdXQpXHJcbiAgICAgICAgbGV0IHZhbHVlID0gJydcclxuICAgICAgICBmb3IgKGxldCBpbmRpY2F0ZXVyVmFsdWUgb2YgaW5kaWNhdGV1clZhbHVlcykge1xyXG4gICAgICAgICAgICBpZiAoaW5kaWNhdGV1clZhbHVlLnllYXIgPT0geWVhciAmJiBpbmRpY2F0ZXVyVmFsdWUuaW5kaWNhdGV1cl9pZCA9PSBpZClcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gaW5kaWNhdGV1clZhbHVlLnZhbHVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG4iLCJmdW5jdGlvbiBub29wKCkgeyB9XG5jb25zdCBpZGVudGl0eSA9IHggPT4geDtcbmZ1bmN0aW9uIGFzc2lnbih0YXIsIHNyYykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IGsgaW4gc3JjKVxuICAgICAgICB0YXJba10gPSBzcmNba107XG4gICAgcmV0dXJuIHRhcjtcbn1cbmZ1bmN0aW9uIGlzX3Byb21pc2UodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIGFkZF9sb2NhdGlvbihlbGVtZW50LCBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIpIHtcbiAgICBlbGVtZW50Ll9fc3ZlbHRlX21ldGEgPSB7XG4gICAgICAgIGxvYzogeyBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIgfVxuICAgIH07XG59XG5mdW5jdGlvbiBydW4oZm4pIHtcbiAgICByZXR1cm4gZm4oKTtcbn1cbmZ1bmN0aW9uIGJsYW5rX29iamVjdCgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcbn1cbmZ1bmN0aW9uIHJ1bl9hbGwoZm5zKSB7XG4gICAgZm5zLmZvckVhY2gocnVuKTtcbn1cbmZ1bmN0aW9uIGlzX2Z1bmN0aW9uKHRoaW5nKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGluZyA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIHNhZmVfbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYiB8fCAoKGEgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnKSB8fCB0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5mdW5jdGlvbiBub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiO1xufVxuZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfc3RvcmUoc3RvcmUsIG5hbWUpIHtcbiAgICBpZiAoc3RvcmUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RvcmUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmFtZX0nIGlzIG5vdCBhIHN0b3JlIHdpdGggYSAnc3Vic2NyaWJlJyBtZXRob2RgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmUsIC4uLmNhbGxiYWNrcykge1xuICAgIGlmIChzdG9yZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBjb25zdCB1bnN1YiA9IHN0b3JlLnN1YnNjcmliZSguLi5jYWxsYmFja3MpO1xuICAgIHJldHVybiB1bnN1Yi51bnN1YnNjcmliZSA/ICgpID0+IHVuc3ViLnVuc3Vic2NyaWJlKCkgOiB1bnN1Yjtcbn1cbmZ1bmN0aW9uIGdldF9zdG9yZV92YWx1ZShzdG9yZSkge1xuICAgIGxldCB2YWx1ZTtcbiAgICBzdWJzY3JpYmUoc3RvcmUsIF8gPT4gdmFsdWUgPSBfKSgpO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGNvbXBvbmVudF9zdWJzY3JpYmUoY29tcG9uZW50LCBzdG9yZSwgY2FsbGJhY2spIHtcbiAgICBjb21wb25lbnQuJCQub25fZGVzdHJveS5wdXNoKHN1YnNjcmliZShzdG9yZSwgY2FsbGJhY2spKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zbG90KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICBjb25zdCBzbG90X2N0eCA9IGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbik7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uWzBdKHNsb3RfY3R4KTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblsxXSAmJiBmblxuICAgICAgICA/IGFzc2lnbigkJHNjb3BlLmN0eC5zbGljZSgpLCBkZWZpbml0aW9uWzFdKGZuKGN0eCkpKVxuICAgICAgICA6ICQkc2NvcGUuY3R4O1xufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY2hhbmdlcyhkZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvblsyXSAmJiBmbikge1xuICAgICAgICBjb25zdCBsZXRzID0gZGVmaW5pdGlvblsyXShmbihkaXJ0eSkpO1xuICAgICAgICBpZiAoJCRzY29wZS5kaXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxldHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGgubWF4KCQkc2NvcGUuZGlydHkubGVuZ3RoLCBsZXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkW2ldID0gJCRzY29wZS5kaXJ0eVtpXSB8IGxldHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkJHNjb3BlLmRpcnR5IHwgbGV0cztcbiAgICB9XG4gICAgcmV0dXJuICQkc2NvcGUuZGlydHk7XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdChzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3Rfc3ByZWFkKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3Rfc3ByZWFkX2NoYW5nZXNfZm4sIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBjb25zdCBzbG90X2NoYW5nZXMgPSBnZXRfc2xvdF9zcHJlYWRfY2hhbmdlc19mbihkaXJ0eSkgfCBnZXRfc2xvdF9jaGFuZ2VzKHNsb3RfZGVmaW5pdGlvbiwgJCRzY29wZSwgZGlydHksIGdldF9zbG90X2NoYW5nZXNfZm4pO1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZXhjbHVkZV9pbnRlcm5hbF9wcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3VsdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Jlc3RfcHJvcHMocHJvcHMsIGtleXMpIHtcbiAgICBjb25zdCByZXN0ID0ge307XG4gICAga2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoIWtleXMuaGFzKGspICYmIGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3Rba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfc2xvdHMoc2xvdHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgbGV0IHJhbiA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICBpZiAocmFuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICBmbi5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuICAgIH07XG59XG5mdW5jdGlvbiBudWxsX3RvX2VtcHR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X3N0b3JlX3ZhbHVlKHN0b3JlLCByZXQsIHZhbHVlID0gcmV0KSB7XG4gICAgc3RvcmUuc2V0KHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufVxuY29uc3QgaGFzX3Byb3AgPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbmZ1bmN0aW9uIGFjdGlvbl9kZXN0cm95ZXIoYWN0aW9uX3Jlc3VsdCkge1xuICAgIHJldHVybiBhY3Rpb25fcmVzdWx0ICYmIGlzX2Z1bmN0aW9uKGFjdGlvbl9yZXN1bHQuZGVzdHJveSkgPyBhY3Rpb25fcmVzdWx0LmRlc3Ryb3kgOiBub29wO1xufVxuXG5jb25zdCBpc19jbGllbnQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbmxldCBub3cgPSBpc19jbGllbnRcbiAgICA/ICgpID0+IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxuICAgIDogKCkgPT4gRGF0ZS5ub3coKTtcbmxldCByYWYgPSBpc19jbGllbnQgPyBjYiA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2IpIDogbm9vcDtcbi8vIHVzZWQgaW50ZXJuYWxseSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gc2V0X25vdyhmbikge1xuICAgIG5vdyA9IGZuO1xufVxuZnVuY3Rpb24gc2V0X3JhZihmbikge1xuICAgIHJhZiA9IGZuO1xufVxuXG5jb25zdCB0YXNrcyA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHJ1bl90YXNrcyhub3cpIHtcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBpZiAoIXRhc2suYyhub3cpKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgICAgICB0YXNrLmYoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0YXNrcy5zaXplICE9PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbn1cbi8qKlxuICogRm9yIHRlc3RpbmcgcHVycG9zZXMgb25seSFcbiAqL1xuZnVuY3Rpb24gY2xlYXJfbG9vcHMoKSB7XG4gICAgdGFza3MuY2xlYXIoKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXNrIHRoYXQgcnVucyBvbiBlYWNoIHJhZiBmcmFtZVxuICogdW50aWwgaXQgcmV0dXJucyBhIGZhbHN5IHZhbHVlIG9yIGlzIGFib3J0ZWRcbiAqL1xuZnVuY3Rpb24gbG9vcChjYWxsYmFjaykge1xuICAgIGxldCB0YXNrO1xuICAgIGlmICh0YXNrcy5zaXplID09PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBuZXcgUHJvbWlzZShmdWxmaWxsID0+IHtcbiAgICAgICAgICAgIHRhc2tzLmFkZCh0YXNrID0geyBjOiBjYWxsYmFjaywgZjogZnVsZmlsbCB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0KCkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gYXBwZW5kKHRhcmdldCwgbm9kZSkge1xuICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIHRhcmdldC5pbnNlcnRCZWZvcmUobm9kZSwgYW5jaG9yIHx8IG51bGwpO1xufVxuZnVuY3Rpb24gZGV0YWNoKG5vZGUpIHtcbiAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2VhY2goaXRlcmF0aW9ucywgZGV0YWNoaW5nKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpdGVyYXRpb25zW2ldKVxuICAgICAgICAgICAgaXRlcmF0aW9uc1tpXS5kKGRldGFjaGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBlbGVtZW50X2lzKG5hbWUsIGlzKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSwgeyBpcyB9KTtcbn1cbmZ1bmN0aW9uIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMob2JqLCBleGNsdWRlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgICBpZiAoaGFzX3Byb3Aob2JqLCBrKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgJiYgZXhjbHVkZS5pbmRleE9mKGspID09PSAtMSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGFyZ2V0W2tdID0gb2JqW2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBzdmdfZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBuYW1lKTtcbn1cbmZ1bmN0aW9uIHRleHQoZGF0YSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhKTtcbn1cbmZ1bmN0aW9uIHNwYWNlKCkge1xuICAgIHJldHVybiB0ZXh0KCcgJyk7XG59XG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgICByZXR1cm4gdGV4dCgnJyk7XG59XG5mdW5jdGlvbiBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJldmVudF9kZWZhdWx0KGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc3RvcF9wcm9wYWdhdGlvbihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZWxmKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoaXMpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgZWxzZSBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSAhPT0gdmFsdWUpXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0X2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBkZXNjcmlwdG9ycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG5vZGUuX19wcm90b19fKTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2tleV0gPT0gbnVsbCkge1xuICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdfX3ZhbHVlJykge1xuICAgICAgICAgICAgbm9kZS52YWx1ZSA9IG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yc1trZXldICYmIGRlc2NyaXB0b3JzW2tleV0uc2V0KSB7XG4gICAgICAgICAgICBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdmdfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YShub2RlLCBwcm9wLCB2YWx1ZSkge1xuICAgIGlmIChwcm9wIGluIG5vZGUpIHtcbiAgICAgICAgbm9kZVtwcm9wXSA9IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXR0cihub2RlLCBwcm9wLCB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24geGxpbmtfYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUoZ3JvdXAsIF9fdmFsdWUsIGNoZWNrZWQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChncm91cFtpXS5jaGVja2VkKVxuICAgICAgICAgICAgdmFsdWUuYWRkKGdyb3VwW2ldLl9fdmFsdWUpO1xuICAgIH1cbiAgICBpZiAoIWNoZWNrZWQpIHtcbiAgICAgICAgdmFsdWUuZGVsZXRlKF9fdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbSh2YWx1ZSk7XG59XG5mdW5jdGlvbiB0b19udW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6ICt2YWx1ZTtcbn1cbmZ1bmN0aW9uIHRpbWVfcmFuZ2VzX3RvX2FycmF5KHJhbmdlcykge1xuICAgIGNvbnN0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYXJyYXkucHVzaCh7IHN0YXJ0OiByYW5nZXMuc3RhcnQoaSksIGVuZDogcmFuZ2VzLmVuZChpKSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gY2hpbGRyZW4oZWxlbWVudCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2Rlcyk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBzdmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgICAgIGxldCBqID0gMDtcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgICAgICAgICAgd2hpbGUgKGogPCBub2RlLmF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzW2orK107XG4gICAgICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUucHVzaChhdHRyaWJ1dGUubmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCByZW1vdmUubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShyZW1vdmVba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5vZGVzLnNwbGljZShpLCAxKVswXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3ZnID8gc3ZnX2VsZW1lbnQobmFtZSkgOiBlbGVtZW50KG5hbWUpO1xufVxuZnVuY3Rpb24gY2xhaW1fdGV4dChub2RlcywgZGF0YSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMykge1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gJycgKyBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIG5vZGVzLnNwbGljZShpLCAxKVswXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGV4dChkYXRhKTtcbn1cbmZ1bmN0aW9uIGNsYWltX3NwYWNlKG5vZGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX3RleHQobm9kZXMsICcgJyk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YSh0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC53aG9sZVRleHQgIT09IGRhdGEpXG4gICAgICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgaW5wdXQudmFsdWUgPSB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF90eXBlKGlucHV0LCB0eXBlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaW5wdXQudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3R5bGUobm9kZSwga2V5LCB2YWx1ZSwgaW1wb3J0YW50KSB7XG4gICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb24oc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIGlmIChvcHRpb24uX192YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9ucyhzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gfnZhbHVlLmluZGV4T2Yob3B0aW9uLl9fdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF92YWx1ZShzZWxlY3QpIHtcbiAgICBjb25zdCBzZWxlY3RlZF9vcHRpb24gPSBzZWxlY3QucXVlcnlTZWxlY3RvcignOmNoZWNrZWQnKSB8fCBzZWxlY3Qub3B0aW9uc1swXTtcbiAgICByZXR1cm4gc2VsZWN0ZWRfb3B0aW9uICYmIHNlbGVjdGVkX29wdGlvbi5fX3ZhbHVlO1xufVxuZnVuY3Rpb24gc2VsZWN0X211bHRpcGxlX3ZhbHVlKHNlbGVjdCkge1xuICAgIHJldHVybiBbXS5tYXAuY2FsbChzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnOmNoZWNrZWQnKSwgb3B0aW9uID0+IG9wdGlvbi5fX3ZhbHVlKTtcbn1cbi8vIHVuZm9ydHVuYXRlbHkgdGhpcyBjYW4ndCBiZSBhIGNvbnN0YW50IGFzIHRoYXQgd291bGRuJ3QgYmUgdHJlZS1zaGFrZWFibGVcbi8vIHNvIHdlIGNhY2hlIHRoZSByZXN1bHQgaW5zdGVhZFxubGV0IGNyb3Nzb3JpZ2luO1xuZnVuY3Rpb24gaXNfY3Jvc3NvcmlnaW4oKSB7XG4gICAgaWYgKGNyb3Nzb3JpZ2luID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY3Jvc3NvcmlnaW4gPSBmYWxzZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgdm9pZCB3aW5kb3cucGFyZW50LmRvY3VtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY3Jvc3NvcmlnaW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcm9zc29yaWdpbjtcbn1cbmZ1bmN0aW9uIGFkZF9yZXNpemVfbGlzdGVuZXIobm9kZSwgZm4pIHtcbiAgICBjb25zdCBjb21wdXRlZF9zdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKGNvbXB1dGVkX3N0eWxlLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICB9XG4gICAgY29uc3QgaWZyYW1lID0gZWxlbWVudCgnaWZyYW1lJyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnZGlzcGxheTogYmxvY2s7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAwOyBsZWZ0OiAwOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyAnICtcbiAgICAgICAgJ292ZXJmbG93OiBoaWRkZW47IGJvcmRlcjogMDsgb3BhY2l0eTogMDsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHotaW5kZXg6IC0xOycpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICBpZnJhbWUudGFiSW5kZXggPSAtMTtcbiAgICBjb25zdCBjcm9zc29yaWdpbiA9IGlzX2Nyb3Nzb3JpZ2luKCk7XG4gICAgbGV0IHVuc3Vic2NyaWJlO1xuICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICBpZnJhbWUuc3JjID0gXCJkYXRhOnRleHQvaHRtbCw8c2NyaXB0Pm9ucmVzaXplPWZ1bmN0aW9uKCl7cGFyZW50LnBvc3RNZXNzYWdlKDAsJyonKX08L3NjcmlwdD5cIjtcbiAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4od2luZG93LCAnbWVzc2FnZScsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gaWZyYW1lLmNvbnRlbnRXaW5kb3cpXG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZnJhbWUuc3JjID0gJ2Fib3V0OmJsYW5rJztcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKGlmcmFtZS5jb250ZW50V2luZG93LCAncmVzaXplJywgZm4pO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBhcHBlbmQobm9kZSwgaWZyYW1lKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodW5zdWJzY3JpYmUgJiYgaWZyYW1lLmNvbnRlbnRXaW5kb3cpIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZGV0YWNoKGlmcmFtZSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZV9jbGFzcyhlbGVtZW50LCBuYW1lLCB0b2dnbGUpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdFt0b2dnbGUgPyAnYWRkJyA6ICdyZW1vdmUnXShuYW1lKTtcbn1cbmZ1bmN0aW9uIGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwpIHtcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgZmFsc2UsIGZhbHNlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGFuY2hvciA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5hID0gYW5jaG9yO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgIH1cbiAgICBtKGh0bWwsIHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBpZiAoIXRoaXMuZSkge1xuICAgICAgICAgICAgdGhpcy5lID0gZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy50ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaShhbmNob3IpO1xuICAgIH1cbiAgICBoKGh0bWwpIHtcbiAgICAgICAgdGhpcy5lLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHRoaXMubiA9IEFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpO1xuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHAoaHRtbCkge1xuICAgICAgICB0aGlzLmQoKTtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB0aGlzLmkodGhpcy5hKTtcbiAgICB9XG4gICAgZCgpIHtcbiAgICAgICAgdGhpcy5uLmZvckVhY2goZGV0YWNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhdHRyaWJ1dGVfdG9fb2JqZWN0KGF0dHJpYnV0ZXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHJlc3VsdFthdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzKGVsZW1lbnQpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBlbGVtZW50LmNoaWxkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICByZXN1bHRbbm9kZS5zbG90IHx8ICdkZWZhdWx0J10gPSB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmNvbnN0IGFjdGl2ZV9kb2NzID0gbmV3IFNldCgpO1xubGV0IGFjdGl2ZSA9IDA7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vZGFya3NreWFwcC9zdHJpbmctaGFzaC9ibG9iL21hc3Rlci9pbmRleC5qc1xuZnVuY3Rpb24gaGFzaChzdHIpIHtcbiAgICBsZXQgaGFzaCA9IDUzODE7XG4gICAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBoYXNoID4+PiAwO1xufVxuZnVuY3Rpb24gY3JlYXRlX3J1bGUobm9kZSwgYSwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNlLCBmbiwgdWlkID0gMCkge1xuICAgIGNvbnN0IHN0ZXAgPSAxNi42NjYgLyBkdXJhdGlvbjtcbiAgICBsZXQga2V5ZnJhbWVzID0gJ3tcXG4nO1xuICAgIGZvciAobGV0IHAgPSAwOyBwIDw9IDE7IHAgKz0gc3RlcCkge1xuICAgICAgICBjb25zdCB0ID0gYSArIChiIC0gYSkgKiBlYXNlKHApO1xuICAgICAgICBrZXlmcmFtZXMgKz0gcCAqIDEwMCArIGAleyR7Zm4odCwgMSAtIHQpfX1cXG5gO1xuICAgIH1cbiAgICBjb25zdCBydWxlID0ga2V5ZnJhbWVzICsgYDEwMCUgeyR7Zm4oYiwgMSAtIGIpfX1cXG59YDtcbiAgICBjb25zdCBuYW1lID0gYF9fc3ZlbHRlXyR7aGFzaChydWxlKX1fJHt1aWR9YDtcbiAgICBjb25zdCBkb2MgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgYWN0aXZlX2RvY3MuYWRkKGRvYyk7XG4gICAgY29uc3Qgc3R5bGVzaGVldCA9IGRvYy5fX3N2ZWx0ZV9zdHlsZXNoZWV0IHx8IChkb2MuX19zdmVsdGVfc3R5bGVzaGVldCA9IGRvYy5oZWFkLmFwcGVuZENoaWxkKGVsZW1lbnQoJ3N0eWxlJykpLnNoZWV0KTtcbiAgICBjb25zdCBjdXJyZW50X3J1bGVzID0gZG9jLl9fc3ZlbHRlX3J1bGVzIHx8IChkb2MuX19zdmVsdGVfcnVsZXMgPSB7fSk7XG4gICAgaWYgKCFjdXJyZW50X3J1bGVzW25hbWVdKSB7XG4gICAgICAgIGN1cnJlbnRfcnVsZXNbbmFtZV0gPSB0cnVlO1xuICAgICAgICBzdHlsZXNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtuYW1lfSAke3J1bGV9YCwgc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH1cbiAgICBjb25zdCBhbmltYXRpb24gPSBub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJztcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IGAke2FuaW1hdGlvbiA/IGAke2FuaW1hdGlvbn0sIGAgOiAnJ30ke25hbWV9ICR7ZHVyYXRpb259bXMgbGluZWFyICR7ZGVsYXl9bXMgMSBib3RoYDtcbiAgICBhY3RpdmUgKz0gMTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpIHtcbiAgICBjb25zdCBwcmV2aW91cyA9IChub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJykuc3BsaXQoJywgJyk7XG4gICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmZpbHRlcihuYW1lXG4gICAgICAgID8gYW5pbSA9PiBhbmltLmluZGV4T2YobmFtZSkgPCAwIC8vIHJlbW92ZSBzcGVjaWZpYyBhbmltYXRpb25cbiAgICAgICAgOiBhbmltID0+IGFuaW0uaW5kZXhPZignX19zdmVsdGUnKSA9PT0gLTEgLy8gcmVtb3ZlIGFsbCBTdmVsdGUgYW5pbWF0aW9uc1xuICAgICk7XG4gICAgY29uc3QgZGVsZXRlZCA9IHByZXZpb3VzLmxlbmd0aCAtIG5leHQubGVuZ3RoO1xuICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gbmV4dC5qb2luKCcsICcpO1xuICAgICAgICBhY3RpdmUgLT0gZGVsZXRlZDtcbiAgICAgICAgaWYgKCFhY3RpdmUpXG4gICAgICAgICAgICBjbGVhcl9ydWxlcygpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsZWFyX3J1bGVzKCkge1xuICAgIHJhZigoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGFjdGl2ZV9kb2NzLmZvckVhY2goZG9jID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlc2hlZXQgPSBkb2MuX19zdmVsdGVfc3R5bGVzaGVldDtcbiAgICAgICAgICAgIGxldCBpID0gc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKVxuICAgICAgICAgICAgICAgIHN0eWxlc2hlZXQuZGVsZXRlUnVsZShpKTtcbiAgICAgICAgICAgIGRvYy5fX3N2ZWx0ZV9ydWxlcyA9IHt9O1xuICAgICAgICB9KTtcbiAgICAgICAgYWN0aXZlX2RvY3MuY2xlYXIoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbicpO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwpID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuZnVuY3Rpb24gaGFzQ29udGV4dChrZXkpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5oYXMoa2V5KTtcbn1cbi8vIFRPRE8gZmlndXJlIG91dCBpZiB3ZSBzdGlsbCB3YW50IHRvIHN1cHBvcnRcbi8vIHNob3J0aGFuZCBldmVudHMsIG9yIGlmIHdlIHdhbnQgdG8gaW1wbGVtZW50XG4vLyBhIHJlYWwgYnViYmxpbmcgbWVjaGFuaXNtXG5mdW5jdGlvbiBidWJibGUoY29tcG9uZW50LCBldmVudCkge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbZXZlbnQudHlwZV07XG4gICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IGZuKGV2ZW50KSk7XG4gICAgfVxufVxuXG5jb25zdCBkaXJ0eV9jb21wb25lbnRzID0gW107XG5jb25zdCBpbnRyb3MgPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG5jb25zdCBiaW5kaW5nX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVuZGVyX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgZmx1c2hfY2FsbGJhY2tzID0gW107XG5jb25zdCByZXNvbHZlZF9wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5sZXQgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2NoZWR1bGVfdXBkYXRlKCkge1xuICAgIGlmICghdXBkYXRlX3NjaGVkdWxlZCkge1xuICAgICAgICB1cGRhdGVfc2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZWRfcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0aWNrKCkge1xuICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgIHJldHVybiByZXNvbHZlZF9wcm9taXNlO1xufVxuZnVuY3Rpb24gYWRkX3JlbmRlcl9jYWxsYmFjayhmbikge1xuICAgIHJlbmRlcl9jYWxsYmFja3MucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZGRfZmx1c2hfY2FsbGJhY2soZm4pIHtcbiAgICBmbHVzaF9jYWxsYmFja3MucHVzaChmbik7XG59XG5sZXQgZmx1c2hpbmcgPSBmYWxzZTtcbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgaWYgKGZsdXNoaW5nKVxuICAgICAgICByZXR1cm47XG4gICAgZmx1c2hpbmcgPSB0cnVlO1xuICAgIGRvIHtcbiAgICAgICAgLy8gZmlyc3QsIGNhbGwgYmVmb3JlVXBkYXRlIGZ1bmN0aW9uc1xuICAgICAgICAvLyBhbmQgdXBkYXRlIGNvbXBvbmVudHNcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBkaXJ0eV9jb21wb25lbnRzW2ldO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoY29tcG9uZW50LiQkKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgd2hpbGUgKGJpbmRpbmdfY2FsbGJhY2tzLmxlbmd0aClcbiAgICAgICAgICAgIGJpbmRpbmdfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgIC8vIHRoZW4sIG9uY2UgY29tcG9uZW50cyBhcmUgdXBkYXRlZCwgY2FsbFxuICAgICAgICAvLyBhZnRlclVwZGF0ZSBmdW5jdGlvbnMuIFRoaXMgbWF5IGNhdXNlXG4gICAgICAgIC8vIHN1YnNlcXVlbnQgdXBkYXRlcy4uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gcmVuZGVyX2NhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgIGlmICghc2Vlbl9jYWxsYmFja3MuaGFzKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICAgIC8vIC4uLnNvIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgbG9vcHNcbiAgICAgICAgICAgICAgICBzZWVuX2NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgIH0gd2hpbGUgKGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKTtcbiAgICB3aGlsZSAoZmx1c2hfY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICBmbHVzaF9jYWxsYmFja3MucG9wKCkoKTtcbiAgICB9XG4gICAgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIGZsdXNoaW5nID0gZmFsc2U7XG4gICAgc2Vlbl9jYWxsYmFja3MuY2xlYXIoKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZSgkJCkge1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAkJC51cGRhdGUoKTtcbiAgICAgICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAgICAgY29uc3QgZGlydHkgPSAkJC5kaXJ0eTtcbiAgICAgICAgJCQuZGlydHkgPSBbLTFdO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5wKCQkLmN0eCwgZGlydHkpO1xuICAgICAgICAkJC5hZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbiAgICB9XG59XG5cbmxldCBwcm9taXNlO1xuZnVuY3Rpb24gd2FpdCgpIHtcbiAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKG5vZGUsIGRpcmVjdGlvbiwga2luZCkge1xuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQoYCR7ZGlyZWN0aW9uID8gJ2ludHJvJyA6ICdvdXRybyd9JHtraW5kfWApKTtcbn1cbmNvbnN0IG91dHJvaW5nID0gbmV3IFNldCgpO1xubGV0IG91dHJvcztcbmZ1bmN0aW9uIGdyb3VwX291dHJvcygpIHtcbiAgICBvdXRyb3MgPSB7XG4gICAgICAgIHI6IDAsXG4gICAgICAgIGM6IFtdLFxuICAgICAgICBwOiBvdXRyb3MgLy8gcGFyZW50IGdyb3VwXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNoZWNrX291dHJvcygpIHtcbiAgICBpZiAoIW91dHJvcy5yKSB7XG4gICAgICAgIHJ1bl9hbGwob3V0cm9zLmMpO1xuICAgIH1cbiAgICBvdXRyb3MgPSBvdXRyb3MucDtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25faW4oYmxvY2ssIGxvY2FsKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLmkpIHtcbiAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suaShsb2NhbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9vdXQoYmxvY2ssIGxvY2FsLCBkZXRhY2gsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLm8pIHtcbiAgICAgICAgaWYgKG91dHJvaW5nLmhhcyhibG9jaykpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG91dHJvaW5nLmFkZChibG9jayk7XG4gICAgICAgIG91dHJvcy5jLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChkZXRhY2gpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmQoMSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJsb2NrLm8obG9jYWwpO1xuICAgIH1cbn1cbmNvbnN0IG51bGxfdHJhbnNpdGlvbiA9IHsgZHVyYXRpb246IDAgfTtcbmZ1bmN0aW9uIGNyZWF0ZV9pbl90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdWlkID0gMDtcbiAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzLCB1aWQrKyk7XG4gICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgaWYgKHRhc2spXG4gICAgICAgICAgICB0YXNrLmFib3J0KCk7XG4gICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIHRydWUsICdzdGFydCcpKTtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCB0cnVlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoc3RhcnRlZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlKTtcbiAgICAgICAgICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgd2FpdCgpLnRoZW4oZ28pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW52YWxpZGF0ZSgpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBjb25zdCBncm91cCA9IG91dHJvcztcbiAgICBncm91cC5yICs9IDE7XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDEsIDAsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdzdGFydCcpKTtcbiAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghLS1ncm91cC5yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmVzdWx0IGluIGBlbmQoKWAgYmVpbmcgY2FsbGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc28gd2UgZG9uJ3QgbmVlZCB0byBjbGVhbiB1cCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKGdyb3VwLmMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEgLSB0LCB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChpc19mdW5jdGlvbihjb25maWcpKSB7XG4gICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgZ28oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBnbygpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBlbmQocmVzZXQpIHtcbiAgICAgICAgICAgIGlmIChyZXNldCAmJiBjb25maWcudGljaykge1xuICAgICAgICAgICAgICAgIGNvbmZpZy50aWNrKDEsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zLCBpbnRybykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCB0ID0gaW50cm8gPyAwIDogMTtcbiAgICBsZXQgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWUgPSBudWxsO1xuICAgIGZ1bmN0aW9uIGNsZWFyX2FuaW1hdGlvbigpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbml0KHByb2dyYW0sIGR1cmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGQgPSBwcm9ncmFtLmIgLSB0O1xuICAgICAgICBkdXJhdGlvbiAqPSBNYXRoLmFicyhkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGE6IHQsXG4gICAgICAgICAgICBiOiBwcm9ncmFtLmIsXG4gICAgICAgICAgICBkLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzdGFydDogcHJvZ3JhbS5zdGFydCxcbiAgICAgICAgICAgIGVuZDogcHJvZ3JhbS5zdGFydCArIGR1cmF0aW9uLFxuICAgICAgICAgICAgZ3JvdXA6IHByb2dyYW0uZ3JvdXBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oYikge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG5vdygpICsgZGVsYXksXG4gICAgICAgICAgICBiXG4gICAgICAgIH07XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIHByb2dyYW0uZ3JvdXAgPSBvdXRyb3M7XG4gICAgICAgICAgICBvdXRyb3MuciArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbnRybywgYW5kIHRoZXJlJ3MgYSBkZWxheSwgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgLy8gYW4gaW5pdGlhbCB0aWNrIGFuZC9vciBhcHBseSBDU1MgYW5pbWF0aW9uIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiKVxuICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHByb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgYiwgJ3N0YXJ0JykpO1xuICAgICAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nX3Byb2dyYW0gJiYgbm93ID4gcGVuZGluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocGVuZGluZ19wcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnc3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIHJ1bm5pbmdfcHJvZ3JhbS5iLCBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24sIDAsIGVhc2luZywgY29uZmlnLmNzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5lbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCA9IHJ1bm5pbmdfcHJvZ3JhbS5iLCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbS5iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludHJvIOKAlCB3ZSBjYW4gdGlkeSB1cCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG91dHJvIOKAlCBuZWVkcyB0byBiZSBjb29yZGluYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIS0tcnVubmluZ19wcm9ncmFtLmdyb3VwLnIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKHJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBydW5uaW5nX3Byb2dyYW0uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcnVubmluZ19wcm9ncmFtLmEgKyBydW5uaW5nX3Byb2dyYW0uZCAqIGVhc2luZyhwIC8gcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhIShydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJ1bihiKSB7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3Byb21pc2UocHJvbWlzZSwgaW5mbykge1xuICAgIGNvbnN0IHRva2VuID0gaW5mby50b2tlbiA9IHt9O1xuICAgIGZ1bmN0aW9uIHVwZGF0ZSh0eXBlLCBpbmRleCwga2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoaW5mby50b2tlbiAhPT0gdG9rZW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSB2YWx1ZTtcbiAgICAgICAgbGV0IGNoaWxkX2N0eCA9IGluZm8uY3R4O1xuICAgICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNoaWxkX2N0eCA9IGNoaWxkX2N0eC5zbGljZSgpO1xuICAgICAgICAgICAgY2hpbGRfY3R4W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgJiYgKGluZm8uY3VycmVudCA9IHR5cGUpKGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBuZWVkc19mbHVzaCA9IGZhbHNlO1xuICAgICAgICBpZiAoaW5mby5ibG9jaykge1xuICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IGluZGV4ICYmIGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzW2ldID09PSBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrc1tpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja19vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9jay5kKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgICAgICBibG9jay5tKGluZm8ubW91bnQoKSwgaW5mby5hbmNob3IpO1xuICAgICAgICAgICAgbmVlZHNfZmx1c2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uYmxvY2sgPSBibG9jaztcbiAgICAgICAgaWYgKGluZm8uYmxvY2tzKVxuICAgICAgICAgICAgaW5mby5ibG9ja3NbaW5kZXhdID0gYmxvY2s7XG4gICAgICAgIGlmIChuZWVkc19mbHVzaCkge1xuICAgICAgICAgICAgZmx1c2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNfcHJvbWlzZShwcm9taXNlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50X2NvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgICAgICBwcm9taXNlLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLmNhdGNoLCAyLCBpbmZvLmVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgICAgICBpZiAoIWluZm8uaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGlmIHdlIHByZXZpb3VzbHkgaGFkIGEgdGhlbi9jYXRjaCBibG9jaywgZGVzdHJveSBpdFxuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnBlbmRpbmcsIDApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8udGhlbikge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLnJlc29sdmVkID0gcHJvbWlzZTtcbiAgICB9XG59XG5cbmNvbnN0IGdsb2JhbHMgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/IHdpbmRvd1xuICAgIDogdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnXG4gICAgICAgID8gZ2xvYmFsVGhpc1xuICAgICAgICA6IGdsb2JhbCk7XG5cbmZ1bmN0aW9uIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmQoMSk7XG4gICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xufVxuZnVuY3Rpb24gb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIGRlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCk7XG59XG5mdW5jdGlvbiB1cGRhdGVfa2V5ZWRfZWFjaChvbGRfYmxvY2tzLCBkaXJ0eSwgZ2V0X2tleSwgZHluYW1pYywgY3R4LCBsaXN0LCBsb29rdXAsIG5vZGUsIGRlc3Ryb3ksIGNyZWF0ZV9lYWNoX2Jsb2NrLCBuZXh0LCBnZXRfY29udGV4dCkge1xuICAgIGxldCBvID0gb2xkX2Jsb2Nrcy5sZW5ndGg7XG4gICAgbGV0IG4gPSBsaXN0Lmxlbmd0aDtcbiAgICBsZXQgaSA9IG87XG4gICAgY29uc3Qgb2xkX2luZGV4ZXMgPSB7fTtcbiAgICB3aGlsZSAoaS0tKVxuICAgICAgICBvbGRfaW5kZXhlc1tvbGRfYmxvY2tzW2ldLmtleV0gPSBpO1xuICAgIGNvbnN0IG5ld19ibG9ja3MgPSBbXTtcbiAgICBjb25zdCBuZXdfbG9va3VwID0gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGRlbHRhcyA9IG5ldyBNYXAoKTtcbiAgICBpID0gbjtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkX2N0eCA9IGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSk7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoY2hpbGRfY3R4KTtcbiAgICAgICAgbGV0IGJsb2NrID0gbG9va3VwLmdldChrZXkpO1xuICAgICAgICBpZiAoIWJsb2NrKSB7XG4gICAgICAgICAgICBibG9jayA9IGNyZWF0ZV9lYWNoX2Jsb2NrKGtleSwgY2hpbGRfY3R4KTtcbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkeW5hbWljKSB7XG4gICAgICAgICAgICBibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xuICAgICAgICB9XG4gICAgICAgIG5ld19sb29rdXAuc2V0KGtleSwgbmV3X2Jsb2Nrc1tpXSA9IGJsb2NrKTtcbiAgICAgICAgaWYgKGtleSBpbiBvbGRfaW5kZXhlcylcbiAgICAgICAgICAgIGRlbHRhcy5zZXQoa2V5LCBNYXRoLmFicyhpIC0gb2xkX2luZGV4ZXNba2V5XSkpO1xuICAgIH1cbiAgICBjb25zdCB3aWxsX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgY29uc3QgZGlkX21vdmUgPSBuZXcgU2V0KCk7XG4gICAgZnVuY3Rpb24gaW5zZXJ0KGJsb2NrKSB7XG4gICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICBibG9jay5tKG5vZGUsIG5leHQpO1xuICAgICAgICBsb29rdXAuc2V0KGJsb2NrLmtleSwgYmxvY2spO1xuICAgICAgICBuZXh0ID0gYmxvY2suZmlyc3Q7XG4gICAgICAgIG4tLTtcbiAgICB9XG4gICAgd2hpbGUgKG8gJiYgbikge1xuICAgICAgICBjb25zdCBuZXdfYmxvY2sgPSBuZXdfYmxvY2tzW24gLSAxXTtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvIC0gMV07XG4gICAgICAgIGNvbnN0IG5ld19rZXkgPSBuZXdfYmxvY2sua2V5O1xuICAgICAgICBjb25zdCBvbGRfa2V5ID0gb2xkX2Jsb2NrLmtleTtcbiAgICAgICAgaWYgKG5ld19ibG9jayA9PT0gb2xkX2Jsb2NrKSB7XG4gICAgICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICBuZXh0ID0gbmV3X2Jsb2NrLmZpcnN0O1xuICAgICAgICAgICAgby0tO1xuICAgICAgICAgICAgbi0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBibG9ja1xuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWxvb2t1cC5oYXMobmV3X2tleSkgfHwgd2lsbF9tb3ZlLmhhcyhuZXdfa2V5KSkge1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGlkX21vdmUuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVsdGFzLmdldChuZXdfa2V5KSA+IGRlbHRhcy5nZXQob2xkX2tleSkpIHtcbiAgICAgICAgICAgIGRpZF9tb3ZlLmFkZChuZXdfa2V5KTtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgd2lsbF9tb3ZlLmFkZChvbGRfa2V5KTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAoby0tKSB7XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3Nbb107XG4gICAgICAgIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2Jsb2NrLmtleSkpXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICB9XG4gICAgd2hpbGUgKG4pXG4gICAgICAgIGluc2VydChuZXdfYmxvY2tzW24gLSAxXSk7XG4gICAgcmV0dXJuIG5ld19ibG9ja3M7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2tleXMoY3R4LCBsaXN0LCBnZXRfY29udGV4dCwgZ2V0X2tleSkge1xuICAgIGNvbnN0IGtleXMgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGdldF9rZXkoZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKSk7XG4gICAgICAgIGlmIChrZXlzLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBoYXZlIGR1cGxpY2F0ZSBrZXlzIGluIGEga2V5ZWQgZWFjaCcpO1xuICAgICAgICB9XG4gICAgICAgIGtleXMuYWRkKGtleSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRfc3ByZWFkX3VwZGF0ZShsZXZlbHMsIHVwZGF0ZXMpIHtcbiAgICBjb25zdCB1cGRhdGUgPSB7fTtcbiAgICBjb25zdCB0b19udWxsX291dCA9IHt9O1xuICAgIGNvbnN0IGFjY291bnRlZF9mb3IgPSB7ICQkc2NvcGU6IDEgfTtcbiAgICBsZXQgaSA9IGxldmVscy5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBvID0gbGV2ZWxzW2ldO1xuICAgICAgICBjb25zdCBuID0gdXBkYXRlc1tpXTtcbiAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBpZiAoIShrZXkgaW4gbikpXG4gICAgICAgICAgICAgICAgICAgIHRvX251bGxfb3V0W2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbikge1xuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudGVkX2ZvcltrZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gbltrZXldO1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldmVsc1tpXSA9IG47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0b19udWxsX291dCkge1xuICAgICAgICBpZiAoIShrZXkgaW4gdXBkYXRlKSlcbiAgICAgICAgICAgIHVwZGF0ZVtrZXldID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlO1xufVxuZnVuY3Rpb24gZ2V0X3NwcmVhZF9vYmplY3Qoc3ByZWFkX3Byb3BzKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBzcHJlYWRfcHJvcHMgPT09ICdvYmplY3QnICYmIHNwcmVhZF9wcm9wcyAhPT0gbnVsbCA/IHNwcmVhZF9wcm9wcyA6IHt9O1xufVxuXG4vLyBzb3VyY2U6IGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2luZGljZXMuaHRtbFxuY29uc3QgYm9vbGVhbl9hdHRyaWJ1dGVzID0gbmV3IFNldChbXG4gICAgJ2FsbG93ZnVsbHNjcmVlbicsXG4gICAgJ2FsbG93cGF5bWVudHJlcXVlc3QnLFxuICAgICdhc3luYycsXG4gICAgJ2F1dG9mb2N1cycsXG4gICAgJ2F1dG9wbGF5JyxcbiAgICAnY2hlY2tlZCcsXG4gICAgJ2NvbnRyb2xzJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RlZmVyJyxcbiAgICAnZGlzYWJsZWQnLFxuICAgICdmb3Jtbm92YWxpZGF0ZScsXG4gICAgJ2hpZGRlbicsXG4gICAgJ2lzbWFwJyxcbiAgICAnbG9vcCcsXG4gICAgJ211bHRpcGxlJyxcbiAgICAnbXV0ZWQnLFxuICAgICdub21vZHVsZScsXG4gICAgJ25vdmFsaWRhdGUnLFxuICAgICdvcGVuJyxcbiAgICAncGxheXNpbmxpbmUnLFxuICAgICdyZWFkb25seScsXG4gICAgJ3JlcXVpcmVkJyxcbiAgICAncmV2ZXJzZWQnLFxuICAgICdzZWxlY3RlZCdcbl0pO1xuXG5jb25zdCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciA9IC9bXFxzJ1wiPi89XFx1e0ZERDB9LVxcdXtGREVGfVxcdXtGRkZFfVxcdXtGRkZGfVxcdXsxRkZGRX1cXHV7MUZGRkZ9XFx1ezJGRkZFfVxcdXsyRkZGRn1cXHV7M0ZGRkV9XFx1ezNGRkZGfVxcdXs0RkZGRX1cXHV7NEZGRkZ9XFx1ezVGRkZFfVxcdXs1RkZGRn1cXHV7NkZGRkV9XFx1ezZGRkZGfVxcdXs3RkZGRX1cXHV7N0ZGRkZ9XFx1ezhGRkZFfVxcdXs4RkZGRn1cXHV7OUZGRkV9XFx1ezlGRkZGfVxcdXtBRkZGRX1cXHV7QUZGRkZ9XFx1e0JGRkZFfVxcdXtCRkZGRn1cXHV7Q0ZGRkV9XFx1e0NGRkZGfVxcdXtERkZGRX1cXHV7REZGRkZ9XFx1e0VGRkZFfVxcdXtFRkZGRn1cXHV7RkZGRkV9XFx1e0ZGRkZGfVxcdXsxMEZGRkV9XFx1ezEwRkZGRn1dL3U7XG4vLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNhdHRyaWJ1dGVzLTJcbi8vIGh0dHBzOi8vaW5mcmEuc3BlYy53aGF0d2cub3JnLyNub25jaGFyYWN0ZXJcbmZ1bmN0aW9uIHNwcmVhZChhcmdzLCBjbGFzc2VzX3RvX2FkZCkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCAuLi5hcmdzKTtcbiAgICBpZiAoY2xhc3Nlc190b19hZGQpIHtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMuY2xhc3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyArPSAnICcgKyBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgc3RyID0gJyc7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgaWYgKGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLnRlc3QobmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKVxuICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke1N0cmluZyh2YWx1ZSkucmVwbGFjZSgvXCIvZywgJyYjMzQ7JykucmVwbGFjZSgvJy9nLCAnJiMzOTsnKX1cImA7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgZXNjYXBlZCA9IHtcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0Oydcbn07XG5mdW5jdGlvbiBlc2NhcGUoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZSgvW1wiJyY8Pl0vZywgbWF0Y2ggPT4gZXNjYXBlZFttYXRjaF0pO1xufVxuZnVuY3Rpb24gZWFjaChpdGVtcywgZm4pIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBzdHIgKz0gZm4oaXRlbXNbaV0sIGkpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgbWlzc2luZ19jb21wb25lbnQgPSB7XG4gICAgJCRyZW5kZXI6ICgpID0+ICcnXG59O1xuZnVuY3Rpb24gdmFsaWRhdGVfY29tcG9uZW50KGNvbXBvbmVudCwgbmFtZSkge1xuICAgIGlmICghY29tcG9uZW50IHx8ICFjb21wb25lbnQuJCRyZW5kZXIpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50JylcbiAgICAgICAgICAgIG5hbWUgKz0gJyB0aGlzPXsuLi59JztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8JHtuYW1lfT4gaXMgbm90IGEgdmFsaWQgU1NSIGNvbXBvbmVudC4gWW91IG1heSBuZWVkIHRvIHJldmlldyB5b3VyIGJ1aWxkIGNvbmZpZyB0byBlbnN1cmUgdGhhdCBkZXBlbmRlbmNpZXMgYXJlIGNvbXBpbGVkLCByYXRoZXIgdGhhbiBpbXBvcnRlZCBhcyBwcmUtY29tcGlsZWQgbW9kdWxlc2ApO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZGVidWcoZmlsZSwgbGluZSwgY29sdW1uLCB2YWx1ZXMpIHtcbiAgICBjb25zb2xlLmxvZyhge0BkZWJ1Z30gJHtmaWxlID8gZmlsZSArICcgJyA6ICcnfSgke2xpbmV9OiR7Y29sdW1ufSlgKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2codmFsdWVzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuICcnO1xufVxubGV0IG9uX2Rlc3Ryb3k7XG5mdW5jdGlvbiBjcmVhdGVfc3NyX2NvbXBvbmVudChmbikge1xuICAgIGZ1bmN0aW9uICQkcmVuZGVyKHJlc3VsdCwgcHJvcHMsIGJpbmRpbmdzLCBzbG90cykge1xuICAgICAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgICAgIGNvbnN0ICQkID0ge1xuICAgICAgICAgICAgb25fZGVzdHJveSxcbiAgICAgICAgICAgIGNvbnRleHQ6IG5ldyBNYXAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSxcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgYmUgaW1tZWRpYXRlbHkgZGlzY2FyZGVkXG4gICAgICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudCh7ICQkIH0pO1xuICAgICAgICBjb25zdCBodG1sID0gZm4ocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVuZGVyOiAocHJvcHMgPSB7fSwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gICAgICAgICAgICBvbl9kZXN0cm95ID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7IHRpdGxlOiAnJywgaGVhZDogJycsIGNzczogbmV3IFNldCgpIH07XG4gICAgICAgICAgICBjb25zdCBodG1sID0gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywge30sIG9wdGlvbnMpO1xuICAgICAgICAgICAgcnVuX2FsbChvbl9kZXN0cm95KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgICAgICBjc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogQXJyYXkuZnJvbShyZXN1bHQuY3NzKS5tYXAoY3NzID0+IGNzcy5jb2RlKS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBudWxsIC8vIFRPRE9cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhlYWQ6IHJlc3VsdC50aXRsZSArIHJlc3VsdC5oZWFkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAkJHJlbmRlclxuICAgIH07XG59XG5mdW5jdGlvbiBhZGRfYXR0cmlidXRlKG5hbWUsIHZhbHVlLCBib29sZWFuKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGJvb2xlYW4gJiYgIXZhbHVlKSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIHJldHVybiBgICR7bmFtZX0ke3ZhbHVlID09PSB0cnVlID8gJycgOiBgPSR7dHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IEpTT04uc3RyaW5naWZ5KGVzY2FwZSh2YWx1ZSkpIDogYFwiJHt2YWx1ZX1cImB9YH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiAnJztcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LnB1c2goLi4ubmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRWRnZSBjYXNlIC0gY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW1tZWRpYXRlbHksXG4gICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgfVxuICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICB9KTtcbiAgICBhZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfY29tcG9uZW50KGNvbXBvbmVudCwgZGV0YWNoaW5nKSB7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQ7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJ1bl9hbGwoJCQub25fZGVzdHJveSk7XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmQoZGV0YWNoaW5nKTtcbiAgICAgICAgLy8gVE9ETyBudWxsIG91dCBvdGhlciByZWZzLCBpbmNsdWRpbmcgY29tcG9uZW50LiQkIChidXQgbmVlZCB0b1xuICAgICAgICAvLyBwcmVzZXJ2ZSBmaW5hbCBzdGF0ZT8pXG4gICAgICAgICQkLm9uX2Rlc3Ryb3kgPSAkJC5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgICQkLmN0eCA9IFtdO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKSB7XG4gICAgaWYgKGNvbXBvbmVudC4kJC5kaXJ0eVswXSA9PT0gLTEpIHtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgICAgICBjb21wb25lbnQuJCQuZGlydHkuZmlsbCgwKTtcbiAgICB9XG4gICAgY29tcG9uZW50LiQkLmRpcnR5WyhpIC8gMzEpIHwgMF0gfD0gKDEgPDwgKGkgJSAzMSkpO1xufVxuZnVuY3Rpb24gaW5pdChjb21wb25lbnQsIG9wdGlvbnMsIGluc3RhbmNlLCBjcmVhdGVfZnJhZ21lbnQsIG5vdF9lcXVhbCwgcHJvcHMsIGRpcnR5ID0gWy0xXSkge1xuICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJCA9IHtcbiAgICAgICAgZnJhZ21lbnQ6IG51bGwsXG4gICAgICAgIGN0eDogbnVsbCxcbiAgICAgICAgLy8gc3RhdGVcbiAgICAgICAgcHJvcHMsXG4gICAgICAgIHVwZGF0ZTogbm9vcCxcbiAgICAgICAgbm90X2VxdWFsLFxuICAgICAgICBib3VuZDogYmxhbmtfb2JqZWN0KCksXG4gICAgICAgIC8vIGxpZmVjeWNsZVxuICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgIG9uX2Rlc3Ryb3k6IFtdLFxuICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgY29udGV4dDogbmV3IE1hcChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pLFxuICAgICAgICAvLyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgZGlydHksXG4gICAgICAgIHNraXBfYm91bmQ6IGZhbHNlXG4gICAgfTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgb3B0aW9ucy5wcm9wcyB8fCB7fSwgKGksIHJldCwgLi4ucmVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXN0Lmxlbmd0aCA/IHJlc3RbMF0gOiByZXQ7XG4gICAgICAgICAgICBpZiAoJCQuY3R4ICYmIG5vdF9lcXVhbCgkJC5jdHhbaV0sICQkLmN0eFtpXSA9IHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICghJCQuc2tpcF9ib3VuZCAmJiAkJC5ib3VuZFtpXSlcbiAgICAgICAgICAgICAgICAgICAgJCQuYm91bmRbaV0odmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkeSlcbiAgICAgICAgICAgICAgICAgICAgbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXTtcbiAgICAkJC51cGRhdGUoKTtcbiAgICByZWFkeSA9IHRydWU7XG4gICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAvLyBgZmFsc2VgIGFzIGEgc3BlY2lhbCBjYXNlIG9mIG5vIERPTSBjb21wb25lbnRcbiAgICAkJC5mcmFnbWVudCA9IGNyZWF0ZV9mcmFnbWVudCA/IGNyZWF0ZV9mcmFnbWVudCgkJC5jdHgpIDogZmFsc2U7XG4gICAgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmh5ZHJhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gY2hpbGRyZW4ob3B0aW9ucy50YXJnZXQpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50Lmwobm9kZXMpO1xuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChkZXRhY2gpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5pbnRybylcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oY29tcG9uZW50LiQkLmZyYWdtZW50KTtcbiAgICAgICAgbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucy50YXJnZXQsIG9wdGlvbnMuYW5jaG9yKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLiQkLnNsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy4kJC5zbG90dGVkW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhhdHRyLCBfb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzW2F0dHJdID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgJGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy8gVE9ETyBzaG91bGQgdGhpcyBkZWxlZ2F0ZSB0byBhZGRFdmVudExpc3RlbmVyP1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzLiBVc2VkIHdoZW4gZGV2PWZhbHNlLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnQge1xuICAgICRkZXN0cm95KCkge1xuICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgfVxuICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAkc2V0KCQkcHJvcHMpIHtcbiAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy4kJHNldCgkJHByb3BzKTtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkaXNwYXRjaF9kZXYodHlwZSwgZGV0YWlsKSB7XG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQodHlwZSwgT2JqZWN0LmFzc2lnbih7IHZlcnNpb246ICczLjMyLjMnIH0sIGRldGFpbCkpKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmQodGFyZ2V0LCBub2RlKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9kZXYodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlLCBhbmNob3IgfSk7XG4gICAgaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwZXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXNzaWduLCBhdHRyLCBhdHRyX2RldiwgYXR0cmlidXRlX3RvX29iamVjdCwgYmVmb3JlVXBkYXRlLCBiaW5kLCBiaW5kaW5nX2NhbGxiYWNrcywgYmxhbmtfb2JqZWN0LCBidWJibGUsIGNoZWNrX291dHJvcywgY2hpbGRyZW4sIGNsYWltX2NvbXBvbmVudCwgY2xhaW1fZWxlbWVudCwgY2xhaW1fc3BhY2UsIGNsYWltX3RleHQsIGNsZWFyX2xvb3BzLCBjb21wb25lbnRfc3Vic2NyaWJlLCBjb21wdXRlX3Jlc3RfcHJvcHMsIGNvbXB1dGVfc2xvdHMsIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciwgY3JlYXRlX2FuaW1hdGlvbiwgY3JlYXRlX2JpZGlyZWN0aW9uYWxfdHJhbnNpdGlvbiwgY3JlYXRlX2NvbXBvbmVudCwgY3JlYXRlX2luX3RyYW5zaXRpb24sIGNyZWF0ZV9vdXRfdHJhbnNpdGlvbiwgY3JlYXRlX3Nsb3QsIGNyZWF0ZV9zc3JfY29tcG9uZW50LCBjdXJyZW50X2NvbXBvbmVudCwgY3VzdG9tX2V2ZW50LCBkYXRhc2V0X2RldiwgZGVidWcsIGRlc3Ryb3lfYmxvY2ssIGRlc3Ryb3lfY29tcG9uZW50LCBkZXN0cm95X2VhY2gsIGRldGFjaCwgZGV0YWNoX2FmdGVyX2RldiwgZGV0YWNoX2JlZm9yZV9kZXYsIGRldGFjaF9iZXR3ZWVuX2RldiwgZGV0YWNoX2RldiwgZGlydHlfY29tcG9uZW50cywgZGlzcGF0Y2hfZGV2LCBlYWNoLCBlbGVtZW50LCBlbGVtZW50X2lzLCBlbXB0eSwgZXNjYXBlLCBlc2NhcGVkLCBleGNsdWRlX2ludGVybmFsX3Byb3BzLCBmaXhfYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIGZpeF9wb3NpdGlvbiwgZmx1c2gsIGdldENvbnRleHQsIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlLCBnZXRfY3VycmVudF9jb21wb25lbnQsIGdldF9jdXN0b21fZWxlbWVudHNfc2xvdHMsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHQsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW50cm9zLCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciwgaXNfY2xpZW50LCBpc19jcm9zc29yaWdpbiwgaXNfZW1wdHksIGlzX2Z1bmN0aW9uLCBpc19wcm9taXNlLCBsaXN0ZW4sIGxpc3Rlbl9kZXYsIGxvb3AsIGxvb3BfZ3VhcmQsIG1pc3NpbmdfY29tcG9uZW50LCBtb3VudF9jb21wb25lbnQsIG5vb3AsIG5vdF9lcXVhbCwgbm93LCBudWxsX3RvX2VtcHR5LCBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzLCBvbkRlc3Ryb3ksIG9uTW91bnQsIG9uY2UsIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBwcmV2ZW50X2RlZmF1bHQsIHByb3BfZGV2LCBxdWVyeV9zZWxlY3Rvcl9hbGwsIHJhZiwgcnVuLCBydW5fYWxsLCBzYWZlX25vdF9lcXVhbCwgc2NoZWR1bGVfdXBkYXRlLCBzZWxlY3RfbXVsdGlwbGVfdmFsdWUsIHNlbGVjdF9vcHRpb24sIHNlbGVjdF9vcHRpb25zLCBzZWxlY3RfdmFsdWUsIHNlbGYsIHNldENvbnRleHQsIHNldF9hdHRyaWJ1dGVzLCBzZXRfY3VycmVudF9jb21wb25lbnQsIHNldF9jdXN0b21fZWxlbWVudF9kYXRhLCBzZXRfZGF0YSwgc2V0X2RhdGFfZGV2LCBzZXRfaW5wdXRfdHlwZSwgc2V0X2lucHV0X3ZhbHVlLCBzZXRfbm93LCBzZXRfcmFmLCBzZXRfc3RvcmVfdmFsdWUsIHNldF9zdHlsZSwgc2V0X3N2Z19hdHRyaWJ1dGVzLCBzcGFjZSwgc3ByZWFkLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X3NwcmVhZCwgdmFsaWRhdGVfY29tcG9uZW50LCB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50LCB2YWxpZGF0ZV9lYWNoX2tleXMsIHZhbGlkYXRlX3Nsb3RzLCB2YWxpZGF0ZV9zdG9yZSwgeGxpbmtfYXR0ciB9O1xuIiwiaW1wb3J0IHsgaW5pdCB9IGZyb20gJy4vaW5kaWNhdG9yRm9ybSdcclxuXHJcbmNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MRm9ybUVsZW1lbnQ+KCdbZGF0YS1jb21wb25lbnQ9XCJpbmRpY2F0b3JGb3JtXCJdJylcclxuXHJcbmZvcm1zLmZvckVhY2goKGZvcm0pOiB2b2lkID0+IHtcclxuICAgIGluaXQoZm9ybSk7XHJcbn0pXHJcbiIsIjxzY3JpcHQgbGFuZz1cInR5cGVzY3JpcHRcIj52YXIgY29sb3JWYXJpYW50cztcclxuKGZ1bmN0aW9uIChjb2xvclZhcmlhbnRzKSB7XHJcbiAgICBjb2xvclZhcmlhbnRzW2NvbG9yVmFyaWFudHNbXCJuZXR0bGVcIl0gPSAwXSA9IFwibmV0dGxlXCI7XHJcbiAgICBjb2xvclZhcmlhbnRzW2NvbG9yVmFyaWFudHNbXCJicmFtYmxlXCJdID0gMV0gPSBcImJyYW1ibGVcIjtcclxufSkoY29sb3JWYXJpYW50cyB8fCAoY29sb3JWYXJpYW50cyA9IHt9KSk7XHJcbnZhciBzaXplcztcclxuKGZ1bmN0aW9uIChzaXplcykge1xyXG4gICAgc2l6ZXNbc2l6ZXNbXCJub3JtYWxcIl0gPSAwXSA9IFwibm9ybWFsXCI7XHJcbiAgICBzaXplc1tzaXplc1tcInNtYWxsXCJdID0gMV0gPSBcInNtYWxsXCI7XHJcbn0pKHNpemVzIHx8IChzaXplcyA9IHt9KSk7XHJcbmV4cG9ydCBsZXQgbGFiZWwgPSAnJztcclxuZXhwb3J0IGxldCBmdWxsID0gZmFsc2U7XHJcbmV4cG9ydCBsZXQgY2xhc3NOYW1lcyA9ICcnO1xyXG5leHBvcnQgbGV0IGNvbG9yVmFyaWFudCA9ICduZXR0bGUnO1xyXG5leHBvcnQgbGV0IHNpemUgPSAnbm9ybWFsJztcclxuZXhwb3J0IGxldCBhc0xpbmsgPSBmYWxzZTtcclxuZXhwb3J0IGxldCBocmVmID0gJyc7XHJcbmxldCBidXR0b25DbGFzc05hbWVzID0gJyc7XHJcbi8qKlxyXG4gKiBDb2xvciB2YXJpYW50c1xyXG4gKi9cclxuaWYgKGNvbG9yVmFyaWFudCA9PSAnbmV0dGxlJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPVxyXG4gICAgICAgICcgYm9yZGVyLWdyZWVuLTcwMCBib3JkZXItMiBob3ZlcjpiZy1ncmVlbi0xMDAgYWN0aXZlOmJnLWdyZWVuLTYwMCc7XHJcbn1cclxuaWYgKGNvbG9yVmFyaWFudCA9PSAnYnJhbWJsZScpIHtcclxuICAgIGJ1dHRvbkNsYXNzTmFtZXMgKz1cclxuICAgICAgICAnIGJvcmRlci1ncmF5LTgwMCBib3JkZXIgaG92ZXI6YmctZ3JlZW4tMTAwIGFjdGl2ZTpiZy1ncmVlbi02MDAnO1xyXG59XHJcbi8qKlxyXG4gKiBTaXplIHZhcmlhbnRzXHJcbiAqL1xyXG5pZiAoc2l6ZSA9PSAnbm9ybWFsJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPSAnIHB4LTYgcHktMyc7XHJcbn1cclxuaWYgKHNpemUgPT0gJ3NtYWxsJykge1xyXG4gICAgYnV0dG9uQ2xhc3NOYW1lcyArPSAnIHRleHQtYmFzZSBweC0zIHB5LTMnO1xyXG59XHJcbjwvc2NyaXB0PlxyXG5cclxueyNpZiBhc0xpbmt9XHJcbiAgICA8YVxyXG4gICAgICAgICAgICBjbGFzczp3LWZ1bGw9e2Z1bGx9XHJcbiAgICAgICAgICAgIGhyZWY9XCJ7IGhyZWYgfVwiXHJcbiAgICAgICAgICAgIGNsYXNzPVwiXHJcbiAgXHR7YnV0dG9uQ2xhc3NOYW1lc31cclxuICBcdHtjbGFzc05hbWVzID8gYCAke2NsYXNzTmFtZXN9YCA6ICcnfVwiXHJcbiAgICA+XHJcbiAgICAgICAge2xhYmVsfVxyXG4gICAgPC9hPlxyXG57OmVsc2UgfVxyXG4gICAgPGJ1dHRvblxyXG4gICAgICAgICAgICBvbjpjbGlja1xyXG4gICAgICAgICAgICBjbGFzczp3LWZ1bGw9e2Z1bGx9XHJcbiAgICAgICAgICAgIGNsYXNzPVwiXHJcbiAgXHR7YnV0dG9uQ2xhc3NOYW1lc31cclxuICBcdHtjbGFzc05hbWVzID8gYCAke2NsYXNzTmFtZXN9YCA6ICcnfVwiXHJcbiAgICA+XHJcbiAgICAgICAge2xhYmVsfVxyXG4gICAgPC9idXR0b24+XHJcblxyXG57L2lmfSIsIjxzY3JpcHQgbGFuZz1cInR5cGVzY3JpcHRcIj52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbmltcG9ydCBCdXR0b24gZnJvbSAnLi4vc2hhcmVkL0J1dHRvbic7XHJcbmltcG9ydCB7IGdldFVybFBhcmFtZXRlciB9IGZyb20gXCIuLi8uLi91dGlscy91cmxcIjtcclxuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xyXG5pbXBvcnQgeyBnZXRDdXJyZW50RXBjaUlkIH0gZnJvbSBcIi4uLy4uL2FwaS9jdXJyZW50RXBjaVwiO1xyXG5pbXBvcnQgeyBBY3Rpb25DdXN0b21TdG9yYWJsZSB9IGZyb20gXCIuLi8uLi9zdG9yYWJsZXMvQWN0aW9uQ3VzdG9tU3RvcmFibGVcIjtcclxuaW1wb3J0IHsgYWN0aW9uQ3VzdG9tU3RvcmUgfSBmcm9tIFwiLi4vLi4vYXBpL2h5YnJpZFN0b3JlXCI7XHJcbmNvbnN0IGVjcGlJZCA9IGdldEN1cnJlbnRFcGNpSWQoKTtcclxuY29uc3QgbWVzdXJlVWlkID0gZ2V0VXJsUGFyYW1ldGVyKCdtZXN1cmVfdWlkJyk7XHJcbmxldCBuYW1lID0gJyc7XHJcbmxldCBkZXNjcmlwdGlvbiA9ICcnO1xyXG5jb25zdCBoYW5kbGVTYXZlID0gKCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgQWN0aW9uQ3VzdG9tU3RvcmFibGUoe1xyXG4gICAgICAgIGVwY2lfaWQ6IGVjcGlJZCxcclxuICAgICAgICBtZXN1cmVfaWQ6IG1lc3VyZVVpZCxcclxuICAgICAgICB1aWQ6IHV1aWQoKSxcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgIH0pO1xyXG4gICAgeWllbGQgYWN0aW9uQ3VzdG9tU3RvcmUuc3RvcmUoYWN0aW9uKTtcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYC9tZXN1cmVfcGVyc29ubmFsaXNlZS5odG1sP2VwY2lfaWQ9JHtlY3BpSWR9Jm1lc3VyZV91aWQ9JHttZXN1cmVVaWR9YDtcclxufSk7XHJcbjwvc2NyaXB0PlxyXG5cclxuPHNlY3Rpb24gY2xhc3M9XCJmbGV4IGZsZXgtY29sXCI+XHJcbiAgICA8aDEgY2xhc3M9XCJ0ZXh0LTR4bCBmb250LXNlbWlib2xkIHBiLTIwXCI+QWpvdXRlciB1bmUgYWN0aW9uPC9oMT5cclxuICAgIDxkaXYgY2xhc3M9XCJmbGV4IGZsZXgtY29sIHctZnVsbCBtZDp3LTMvNCBwYi0xMFwiPlxyXG4gICAgICAgIDxsYWJlbCBmb3I9XCJtZXN1cmVfY3JlYXRlX25hbWVcIj5Ob208L2xhYmVsPlxyXG4gICAgICAgIDxpbnB1dCBpZD1cIm1lc3VyZV9jcmVhdGVfbmFtZVwiXHJcbiAgICAgICAgICAgICAgIGJpbmQ6dmFsdWU9e25hbWV9XHJcbiAgICAgICAgICAgICAgIGNsYXNzPVwiYm9yZGVyIGJvcmRlci1ncmF5LTMwMCBwLTIgbXktMiBmb2N1czpvdXRsaW5lLW5vbmUgZm9jdXM6cmluZy0yIHJpbmctZ3JlZW4tMTAwXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInAtNVwiPjwvZGl2PlxyXG4gICAgICAgIDxsYWJlbCBmb3I9XCJtZXN1cmVfY3JlYXRlX2Rlc2NyaXB0aW9uXCI+RGVzY3JpcHRpb248L2xhYmVsPlxyXG4gICAgICAgIDx0ZXh0YXJlYSBpZD1cIm1lc3VyZV9jcmVhdGVfZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgICAgICBiaW5kOnZhbHVlPXtkZXNjcmlwdGlvbn1cclxuICAgICAgICAgICAgICAgY2xhc3M9XCJib3JkZXIgYm9yZGVyLWdyYXktMzAwIHAtMiBteS0yIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpyaW5nLTIgcmluZy1ncmVlbi0xMDBcIiAvPlxyXG4gICAgPC9kaXY+XHJcblxyXG4gICAgPEJ1dHRvblxyXG4gICAgICAgICAgICBmdWxsXHJcbiAgICAgICAgICAgIGxhYmVsPVwiVmFsaWRlclwiXHJcbiAgICAgICAgICAgIG9uOmNsaWNrPXtoYW5kbGVTYXZlfVxyXG4gICAgICAgICAgICBjbGFzc05hbWVzPVwibWQ6dy0xLzMgc2VsZi1lbmRcIlxyXG4gICAgLz5cclxuPC9zZWN0aW9uPlxyXG4iLCJleHBvcnQgY29uc3QgZ2V0VXJsUGFyYW1ldGVyID0gKG5hbWU6IHN0cmluZykgPT4ge1xyXG4gIG5hbWUgPSBuYW1lLnJlcGxhY2UoL1tcXFtdLywgJ1xcXFxbJykucmVwbGFjZSgvW1xcXV0vLCAnXFxcXF0nKVxyXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgnW1xcXFw/Jl0nICsgbmFtZSArICc9KFteJiNdKiknKVxyXG4gIGNvbnN0IHJlc3VsdHMgPSByZWdleC5leGVjKGxvY2F0aW9uLnNlYXJjaClcclxuXHJcbiAgcmV0dXJuIHJlc3VsdHMgPT09IG51bGwgPyAnJyA6IGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzFdLnJlcGxhY2UoL1xcKy9nLCAnICcpKVxyXG59IiwiZXhwb3J0IGNsYXNzIFRoZW1hdGlxdWUge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuaWQgPSBpZDtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdGhlbWF0aXF1ZXMgPSB7XHJcblxyXG4gICAgXCJzdHJhdGVnaWVcIjogbmV3IFRoZW1hdGlxdWUoXCJzdHJhdGVnaWVcIiwgXCJTdHJhdMOpZ2llXCIpLFxyXG5cclxuICAgIFwidXJiYW5pc21lXCI6IG5ldyBUaGVtYXRpcXVlKFwidXJiYW5pc21lXCIsIFwiVXJiYW5pc21lIGV0IGFtw6luYWdlbWVudFwiKSxcclxuXHJcbiAgICBcImJhdGltZW50c1wiOiBuZXcgVGhlbWF0aXF1ZShcImJhdGltZW50c1wiLCBcIkLDonRpbWVudHMgZXQgcGF0cmltb2luZVwiKSxcclxuXHJcbiAgICBcImVuZXJnaWVcIjogbmV3IFRoZW1hdGlxdWUoXCJlbmVyZ2llXCIsIFwiR2VzdGlvbiwgcHJvZHVjdGlvbiBldCBkaXN0cmlidXRpb24gZGUgbCfDqW5lcmdpZVwiKSxcclxuXHJcbiAgICBcIm1vYmlsaXRlc1wiOiBuZXcgVGhlbWF0aXF1ZShcIm1vYmlsaXRlc1wiLCBcIk1vYmlsaXTDqXNcIiksXHJcblxyXG4gICAgXCJhZ3JpX2FsaW1cIjogbmV3IFRoZW1hdGlxdWUoXCJhZ3JpX2FsaW1cIiwgXCJBZ3JpY3VsdHVyZSBldCBhbGltZW50YXRpb25cIiksXHJcblxyXG4gICAgXCJmb3JldF9iaW9kaXZcIjogbmV3IFRoZW1hdGlxdWUoXCJmb3JldF9iaW9kaXZcIiwgXCJGb3LDqnRzLCBlc3BhY2VzIHZlcnRzIGV0IGJpb2RpdmVyc2l0w6lcIiksXHJcblxyXG4gICAgXCJjb25zb19yZXNwXCI6IG5ldyBUaGVtYXRpcXVlKFwiY29uc29fcmVzcFwiLCBcIkNvbnNvbW1hdGlvbiDDqWNvcmVzcG9uc2FibGVcIiksXHJcblxyXG4gICAgXCJkZWNoZXRzXCI6IG5ldyBUaGVtYXRpcXVlKFwiZGVjaGV0c1wiLCBcIkTDqWNoZXRzXCIpLFxyXG5cclxuICAgIFwiZWF1XCI6IG5ldyBUaGVtYXRpcXVlKFwiZWF1XCIsIFwiRWF1IGV0IGFzc2Fpbmlzc2VtZW50XCIpLFxyXG5cclxuICAgIFwicHJlY2FfZW5lcmdpZVwiOiBuZXcgVGhlbWF0aXF1ZShcInByZWNhX2VuZXJnaWVcIiwgXCJQcsOpY2FyaXTDqSDDqW5lcmfDqXRpcXVlXCIpLFxyXG5cclxuICAgIFwiZGV2X2Vjb1wiOiBuZXcgVGhlbWF0aXF1ZShcImRldl9lY29cIiwgXCJBY3Rpdml0w6lzIMOpY29ub21pcXVlc1wiKSxcclxuXHJcbiAgICBcInRvdXJpc21lXCI6IG5ldyBUaGVtYXRpcXVlKFwidG91cmlzbWVcIiwgXCJUb3VyaXNtZVwiKSxcclxuXHJcbiAgICBcIm9yZ2FfaW50ZXJuZVwiOiBuZXcgVGhlbWF0aXF1ZShcIm9yZ2FfaW50ZXJuZVwiLCBcIk9yZ2FuaXNhdGlvbiBpbnRlcm5lXCIpLFxyXG5cclxuICAgIFwiZm9ybWFfc2Vuc2liXCI6IG5ldyBUaGVtYXRpcXVlKFwiZm9ybWFfc2Vuc2liXCIsIFwiRm9ybWF0aW9uLCBzZW5zaWJpbGlzYXRpb24sIGNvbW11bmljYXRpb25cIiksXHJcblxyXG4gICAgXCJwYXJ0ZW5fY29vcFwiOiBuZXcgVGhlbWF0aXF1ZShcInBhcnRlbl9jb29wXCIsIFwiUGFydGVuYXJpYXQgZXQgY29vcMOpcmF0aW9uXCIpLFxyXG5cclxuICAgIFwiZWNpXCI6IG5ldyBUaGVtYXRpcXVlKFwiZWNpXCIsIFwiw4ljb25vbWllIGNpcmN1bGFpcmVcIiksXHJcblxyXG59IiwiaW1wb3J0ICcuL3N0eWxlcy5jc3MnXHJcbmltcG9ydCAnLi9jb21wb25lbnRzL2xlZ2FjeS9tZXN1cmUnXHJcbmltcG9ydCAnLi9jb21wb25lbnRzL2xlZ2FjeS9pbmRpY2F0b3JzTGlzdCdcclxuaW1wb3J0IEFjdGlvbkNyZWF0ZVBhZ2UgZnJvbSAnLi9jb21wb25lbnRzL2FjdGlvbnMvQWN0aW9uQ3JlYXRlUGFnZS5zdmVsdGUnXHJcbmltcG9ydCB7dGhlbWF0aXF1ZXN9IGZyb20gXCIuLi92ZW5kb3JzL3RoZW1hdGlxdWVzXCI7XHJcblxyXG5uZXcgQWN0aW9uQ3JlYXRlUGFnZSh7XHJcbiAgLy8gQHRzLWlnbm9yZVxyXG4gIHRhcmdldDogZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCdbZGF0YS1wYWdlPVwiYWN0aW9uX2NyZWF0ZVwiXScpLFxyXG59KVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==